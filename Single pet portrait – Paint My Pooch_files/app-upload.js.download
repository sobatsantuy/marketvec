!function(){function e(e){return e&&e.__esModule?e.default:e}
/*!
 * FilePondPluginImageValidateSize 1.0.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var t;function n(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){a(e,t,n[t])}))}return e}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||l(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e){return e&&e.constructor===Symbol?"symbol":typeof e}t=function(){"use strict";var e,t,n,i;Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return r;r++}return-1}}),Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1,i=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),n)},function(e){var n=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,a=arguments.length>1?arguments[1]:void 0;if(void 0!==a){if(!t(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var s,l=i(r.length),u=t(n)?Object(new n(l)):new Array(l),c=0;c<l;)s=r[c],u[c]=a?void 0===o?a(s,c):a.call(o,s,c):s,c+=1;return u.length=l,u})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var r,o,a=0|t,s=Math.max(a>=0?a:i-Math.abs(a),0);s<i;){if((r=n[s])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.some||(Array.prototype.some=function(e){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof e)throw new TypeError;for(var t=Object(this),n=t.length>>>0,i=arguments.length>=2?arguments[1]:void 0,r=0;r<n;r++)if(r in t&&e.call(i,t[r],r,t))return!0;return!1}),Array.prototype.every||(Array.prototype.every=function(e,t){var n,i;if(null==this)throw new TypeError("this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e)throw new TypeError;for(arguments.length>1&&(n=t),i=0;i<o;){var a;if(i in r){a=r[i];var s=e.call(n,a,i,r);if(!s)return!1}i++}return!0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0}),function(){if("undefined"==typeof window||"function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}()},"function"==typeof define&&define.amd?define(t):t();var f=function(){"use strict";function e(){i(this,e)}return o(e,null,[{key:"extend",value:function(){for(var t={},n=function(n){for(var i in n)n.hasOwnProperty(i)&&("[object Object]"===Object.prototype.toString.call(n[i])?t[i]=e.extend(t[i],n[i]):void 0!==n[i]&&(t[i]=n[i]))},i=0;i<arguments.length;i++){var r=arguments[i];n(r)}return t}},{key:"isElement",value:function(e){return"object"==typeof e&&void 0!==e.nodeType}},{key:"isNodeList",value:function(t){var n=Object.prototype.toString.call(t),i="object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(n)&&"number"==typeof t.length&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0);return!i&&Array.isArray(t)&&t.length>0?e.isElement(t[0]):i}},{key:"isInPage",value:function(e){return e!==document.body&&document.body.contains(e)}},{key:"matches",value:function(e,t){return Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),e.matches(t)}},{key:"findParent",value:function(e,t){if("function"==typeof e.closest)return e.closest(t)||null;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});e;){if(e.matches(t))return e;e=e.parentElement}return null}},{key:"readCookie",value:function(e){e+="=";for(var t=document.cookie.split(/;\s*/),n=t.length-1;n>=0;n--)if(!t[n].indexOf(e))return t[n].replace(e,"")}},{key:"writeCookie",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",r=new Date;r.setDate(r.getDate()+n);var o=null==n?"":"; expires="+r.toUTCString();document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+o+(i?"; path="+i:"")+";"}},{key:"removeCookie",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";document.cookie=e+"=; Path="+t+"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},{key:"addStyleElement",value:function(e,t){t&&"head"!=t||(t=document.head||document.getElementsByTagName("head")[0]);var n=document.createElement("style");return n.appendChild(document.createTextNode(e)),t.appendChild(n),n}},{key:"objectKeys",value:function(e){if(!Object.keys){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}return Object.keys(e)}},{key:"debounced",value:function(e,t){var n;return function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];n&&clearTimeout(n),n=setTimeout((function(){t.apply(void 0,c(r)),n=null}),e)}}}]),e}(),p=f,h=function(){"use strict";function e(t,n){i(this,e);if(!this.supports())throw"This browser is not supported";return this.settings=p.extend({method:"GET",username:null,password:null,data:{},queryParams:{},headers:{"Content-type":"application/x-www-form-urlencoded"},responseType:"text",timeout:null,withCredentials:!1,onProgress:null},n||{}),this.xhr(t)}return o(e,[{key:"supports",value:function(){return"XMLHttpRequest"in window&&"JSON"in window&&"Promise"in window}},{key:"parse",value:function(e){var t;if("text"!==this.settings.responseType&&""!==this.settings.responseType){var n=e.response;if("json"===this.settings.responseType&&"string"==typeof n)try{n=JSON.parse(n)}catch(e){}return{data:n,xhr:e}}try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return{data:t,xhr:e}}},{key:"param",value:function(e){if("string"==typeof e||"[object FormData]"===Object.prototype.toString.call(e)||"[object File]"===Object.prototype.toString.call(e)||"[object Blob]"===Object.prototype.toString.call(e))return e;if(/application\/json/i.test(this.settings.headers["Content-type"])||"[object Array]"===Object.prototype.toString.call(e))return JSON.stringify(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}},{key:"addQueryParams",value:function(e){if(this.settings.queryParams){var t=[];for(var n in this.settings.queryParams)this.settings.queryParams.hasOwnProperty(n)&&t.push(n+"="+this.settings.queryParams[n]);if(t.length>0){var i=t.join("&");return-1===e.indexOf("?")?e+"?"+i:e+"&"+i}}return e}},{key:"xhr",value:function(e){var t=this,n=new XMLHttpRequest,i=new Promise((function(i,r){var o=t;for(var a in n.onreadystatechange=function(){if(4===n.readyState){var e=o.parse(n);n.status>=200&&n.status<300?i(e):r(e)}},e=t.addQueryParams(e),n.open(t.settings.method,e,!0,t.settings.username,t.settings.password),n.responseType=t.settings.responseType,t.settings.headers)t.settings.headers.hasOwnProperty(a)&&n.setRequestHeader(a,t.settings.headers[a]);t.settings.timeout&&(n.timeout=t.settings.timeout,n.ontimeout=function(e){r({status:408,statusText:"Request timeout"})}),t.settings.withCredentials&&(n.withCredentials=!0),t.settings.onProgress&&(n.upload.onprogress=t.settings.onProgress),n.send(t.param(t.settings.data))}));return i.cancel=function(){n.abort()},i}}]),e}(),g=function(){"use strict";function e(t){i(this,e);var n={api:"",path:"/api/upload",queryParams:{},storage:!1,storageKey:e.storageKey,serverDelete:!1};this.settings=p.extend(n,t||{}),this.findToken()}return o(e,[{key:"findToken",value:function(){var e=p.readCookie("token");e&&(this.settings.queryParams.token=e)}},{key:"fromNative",value:function(e){return{name:e.name?e.name:"",size:e.size,mimeType:e.type,meta:{},_file:e}}},{key:"saveFile",value:function(e){var t=this;return this.settings.queryParams.token||this.findToken(),new h(this.settings.api+this.settings.path,{method:"POST",responseType:"json",headers:{"Content-type":"application/json"},data:e,queryParams:this.settings.queryParams}).then((function(e){if(!t.settings.queryParams.token&&e.data.token){var n=e.data.token;p.writeCookie("token",n,10,"/"),t.settings.queryParams.token=n}return t.settings.storage&&t._storeFile(e.data),e.data})).catch((function(e){throw e}))}},{key:"removeFile",value:function(e){return this.settings.storage&&this._files&&(this._files=this._files.filter((function(t){return!(t.uuid===e.uuid||t.parent===e.uuid)})),this._storeFiles()),this.settings.serverDelete?new h(this.settings.api+this.settings.path+"/"+e.uuid,{method:"DELETE",responseType:"json",queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e})):Promise.resolve()}},{key:"fetchFiles",value:function(){var e=this;return this.settings.storage?new Promise((function(t,n){e._files||e._parseFiles(),t(e._files)})):new h(this.settings.api+this.settings.path,{method:"GET",responseType:"json",queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e}))}},{key:"restoreFiles",value:function(e){return new h(this.settings.api+this.settings.path+"/restore",{method:"POST",responseType:"json",headers:{"Content-type":"application/json"},data:e,queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e}))}},{key:"sendTemplate",value:function(e,t){return new h(this.settings.api+this.settings.path+"/"+e+"/send",{method:"POST",responseType:"json",headers:{"Content-type":"application/json"},data:t,queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e}))}},{key:"tagOrder",value:function(e,t){return new h(this.settings.api+this.settings.path+"/"+e+"/tag",{method:"POST",responseType:"json",headers:{"Content-type":"application/json"},data:t,queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e}))}},{key:"inAppFailed",value:function(e,t){return new h(this.settings.api+this.settings.path+"/inapp"+(e?"?reload=1":t?"?empty=1":""),{method:"POST",responseType:"text",headers:{"Content-type":"application/json"},queryParams:this.settings.queryParams}).then((function(e){return e.data})).catch((function(e){throw e}))}},{key:"_storeFile",value:function(e){this._files||this._parseFiles();var t=JSON.parse(JSON.stringify(e));this._files.push(t),this._storeFiles()}},{key:"_storeFiles",value:function(){window.localStorage&&localStorage.setItem(this.settings.storageKey,JSON.stringify(this._files))}},{key:"_parseFiles",value:function(){if(window.localStorage){var e=localStorage.getItem(this.settings.storageKey);if(e){if(this._files=JSON.parse(e),this.settings.queryParams.token){var t=this,n=this._files.length;this._files=this._files.filter((function(e){return e.token===t.settings.queryParams.token})),n!==this._files.length&&this._storeFiles()}}else this._files=[]}return this._files}}]),e}();g.storageKey="cl_files";var m,E,v=g,_={};m=void 0,E=function(){"use strict";var e=function(){},t="undefined",n=("undefined"==typeof window?"undefined":d(window))!==t&&d(window.navigator)!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(i){return"debug"===i&&(i="log"),("undefined"==typeof console?"undefined":d(console))!==t&&("trace"===i&&n?o:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):e)}function s(t,n){for(var r=0;r<i.length;r++){var o=i[r];this[o]=r<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function l(e,n,i){return function(){("undefined"==typeof console?"undefined":d(console))!==t&&(s.call(this,n,i),this[e].apply(this,arguments))}}function u(e,t,n){return a(e)||l.apply(this,arguments)}function c(e,n,r){var o,a=this,l="loglevel";function c(){var e;if(("undefined"==typeof window?"undefined":d(window))!==t){try{e=window.localStorage[l]}catch(e){}if((void 0===e?"undefined":d(e))===t)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(l)+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}e&&(l+=":"+e),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=r||u,a.getLevel=function(){return o},a.setLevel=function(n,r){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&function(e){var n=(i[e]||"silent").toUpperCase();if(("undefined"==typeof window?"undefined":d(window))!==t){try{return void(window.localStorage[l]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+n+";"}catch(e){}}}(n),s.call(a,n,e),("undefined"==typeof console?"undefined":d(console))===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){c()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var f=c();null==f&&(f=null==n?"WARN":n),a.setLevel(f,!1)}var f=new c,p={};f.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new c(e,f.getLevel(),f.methodFactory)),t};var h=("undefined"==typeof window?"undefined":d(window))!==t?window.log:void 0;return f.noConflict=function(){return("undefined"==typeof window?"undefined":d(window))!==t&&window.log===f&&(window.log=h),f},f.getLoggers=function(){return p},f},"function"==typeof define&&define.amd?define(E):_?_=E():m.log=E();var I=function(){"use strict";function e(){i(this,e)}return o(e,null,[{key:"get",value:function(t,n){var i=e.translations[t]||t;if(n)for(var r in n)n.hasOwnProperty(r)&&(i=i.replace(new RegExp("{"+r+"}","g"),n[r]));return i}},{key:"translate",value:function(t,n){if(t&&"string"==typeof t){if("#"===t.charAt(0))return e.get(t.substr(1).trim(),n);if(-1!==t.indexOf("#{")){for(var i=t;-1!==i.indexOf("#{");){var r=i.indexOf("#{"),o=i.indexOf("}"),a=i.substring(r+2,o),s=e.get(a,n);i=i.replace("#{"+a+"}",s)}return i}}return t}},{key:"fetch",value:function(t){var n=e.api.replace("{locale}",t),i=new h(n,{method:"GET"});return e.ready=i.then((function(t){return _.debug("[translate] "+n+" response",t.data),e.update(t.data),e.translations})).catch((function(t){return _.error("[translate] "+n+" error",t),e.translations})),e.ready}},{key:"update",value:function(t){e.translations=p.extend(e.translations,t),e.updated()}},{key:"updated",value:function(){var t=new CustomEvent(e.event,{detail:{},cancelable:!0,bubbles:!0});window.dispatchEvent(t)}},{key:"onUpdated",value:function(t){window.addEventListener(e.event,t)}}]),e}();I.locale=window.Shopify&&window.Shopify.locale?window.Shopify.locale:document.documentElement.lang,I.translations={},I.ready=Promise.resolve(!0),I.event="cloudlift.translate",I.api="";var y,T,w=I,A={},O={};function R(){throw new Error("setTimeout has not been defined")}function S(){throw new Error("clearTimeout has not been defined")}function b(e){if(y===setTimeout)return setTimeout(e,0);if((y===R||!y)&&setTimeout)return y=setTimeout,setTimeout(e,0);try{return y(e,0)}catch(t){try{return y.call(null,e,0)}catch(t){return y.call(this,e,0)}}}!function(){try{y="function"==typeof setTimeout?setTimeout:R}catch(e){y=R}try{T="function"==typeof clearTimeout?clearTimeout:S}catch(e){T=S}}();var M,C=[],P=!1,L=-1;function D(){P&&M&&(P=!1,M.length?C=M.concat(C):L=-1,C.length&&x())}function x(){if(!P){var e=b(D);P=!0;for(var t=C.length;t;){for(M=C,C=[];++L<t;)M&&M[L].run();L=-1,t=C.length}M=null,P=!1,function(e){if(T===clearTimeout)return clearTimeout(e);if((T===S||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(e);try{T(e)}catch(t){try{return T.call(null,e)}catch(t){return T.call(this,e)}}}(e)}}function G(e,t){this.fun=e,this.array=t}function N(){}O.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];C.push(new G(e,t)),1!==C.length||P||b(x)},G.prototype.run=function(){this.fun.apply(null,this.array)},O.title="browser",O.browser=!0,O.env={},O.argv=[],O.version="",O.versions={},O.on=N,O.addListener=N,O.once=N,O.off=N,O.removeListener=N,O.removeAllListeners=N,O.emit=N,O.prependListener=N,O.prependOnceListener=N,O.listeners=function(e){return[]},O.binding=function(e){throw new Error("process.binding is not supported")},O.cwd=function(){return"/"},O.chdir=function(e){throw new Error("process.chdir is not supported")},O.umask=function(){return 0},
/*!
 * FilePond 4.30.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */function(e,t){"object"==typeof A?t(A):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).FilePond={})}(void 0,(function(e){"use strict";var t=function(e){return e instanceof HTMLElement},n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=Object.assign({},e),r=[],o=[],a=function(){return Object.assign({},i)},s=function(){var e=[].concat(r);return r.length=0,e},l=function(){var e=[].concat(o);o.length=0,e.forEach((function(e){var t=e.type,n=e.data;u(t,n)}))},u=function(e,t,n){!n||document.hidden?(p[e]&&p[e](t),r.push({type:e,data:t})):o.push({type:e,data:t})},c=function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return f[e]?(t=f)[e].apply(t,i):null},d={getState:a,processActionQueue:s,processDispatchQueue:l,dispatch:u,query:c},f={};t.forEach((function(e){f=Object.assign({},e(i),{},f)}));var p={};return n.forEach((function(e){p=Object.assign({},e(u,c,i),{},p)})),d},i=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])},r=function(e){var t={};return i(e,(function(n){!function(e,t,n){"function"!=typeof n?Object.defineProperty(e,t,Object.assign({},n)):e[t]=n}(t,n,e[n])})),t},o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===n)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,n)},a="http://www.w3.org/2000/svg",s=["svg","path"],l=function(e){return s.includes(e)},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"==typeof t&&(n=t,t=null);var r=l(e)?document.createElementNS(a,e):document.createElement(e);return t&&(l(e)?o(r,"class",t):r.className=t),i(n,(function(e,t){o(r,e,t)})),r},c=function(e){return function(t,n){void 0!==n&&e.children[n]?e.insertBefore(t,e.children[n]):e.appendChild(t)}},f=function(e,t){return function(e,n){return void 0!==n?t.splice(n,0,e):t.push(e),e}},p=function(e,t){return function(n){return t.splice(t.indexOf(n),1),n.element.parentNode&&e.removeChild(n.element),n}},h="undefined"!=typeof window&&void 0!==window.document,g=function(){return h},m="children"in(g()?u("svg"):{})?function(e){return e.children.length}:function(e){return e.childNodes.length},E=function(e,t,n,i){var r=n[0]||e.left,o=n[1]||e.top,a=r+e.width,s=o+e.height*(i[1]||1),l={element:Object.assign({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:r,top:o,right:a,bottom:s}};return t.filter((function(e){return!e.isRectIgnored()})).map((function(e){return e.rect})).forEach((function(e){v(l.inner,Object.assign({},e.inner)),v(l.outer,Object.assign({},e.outer))})),_(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,_(l.outer),l},v=function(e,t){t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},_=function(e){e.width=e.right-e.left,e.height=e.bottom-e.top},I=function(e){return"number"==typeof e},y=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return Math.abs(e-t)<i&&Math.abs(n)<i},T=function(e){return e<.5?2*e*e:(4-2*e)*e-1},w={spring:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiffness,n=void 0===t?.5:t,i=e.damping,o=void 0===i?.75:i,a=e.mass,s=void 0===a?10:a,l=null,u=null,c=0,d=!1,f=function(e,t){if(!d){if(!I(l)||!I(u))return d=!0,void(c=0);y(u+=c+=-(u-l)*n/s,l,c*=o)||t?(u=l,c=0,d=!0,h.onupdate(u),h.oncomplete(u)):h.onupdate(u)}},p=function(e){if(I(e)&&!I(u)&&(u=e),null===l&&(l=e,u=e),u===(l=e)||void 0===l)return d=!0,c=0,h.onupdate(u),void h.oncomplete(u);d=!1},h=r({interpolate:f,target:{set:p,get:function(){return l}},resting:{get:function(){return d}},onupdate:function(e){},oncomplete:function(e){}});return h},tween:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.duration,o=void 0===i?500:i,a=n.easing,s=void 0===a?T:a,l=n.delay,u=void 0===l?0:l,c=null,d=!0,f=!1,p=null,h=function(n,i){d||null===p||(null===c&&(c=n),n-c<u||((e=n-c-u)>=o||i?(e=1,t=f?0:1,g.onupdate(t*p),g.oncomplete(t*p),d=!0):(t=e/o,g.onupdate((e>=0?s(f?1-t:t):0)*p))))},g=r({interpolate:h,target:{get:function(){return f?0:p},set:function(e){if(null===p)return p=e,g.onupdate(e),void g.oncomplete(e);e<p?(p=1,f=!0):(f=!1,p=e),d=!1,c=null}},resting:{get:function(){return d}},onupdate:function(e){},oncomplete:function(e){}});return g}},A=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(t=Array.isArray(t)?t:[t]).forEach((function(t){e.forEach((function(e){var r=e,o=function(){return n[e]},a=function(t){return n[e]=t};"object"==typeof e&&(r=e.key,o=e.getter||o,a=e.setter||a),t[r]&&!i||(t[r]={get:o,set:a})}))}))},O=function(e){return null!=e},R={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},S=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var n in t)if(t[n]!==e[n])return!0;return!1},b=function(e,t){var n=t.opacity,i=t.perspective,r=t.translateX,o=t.translateY,a=t.scaleX,s=t.scaleY,l=t.rotateX,u=t.rotateY,c=t.rotateZ,d=t.originX,f=t.originY,p=t.width,h=t.height,g="",m="";(O(d)||O(f))&&(m+="transform-origin: "+(d||0)+"px "+(f||0)+"px;"),O(i)&&(g+="perspective("+i+"px) "),(O(r)||O(o))&&(g+="translate3d("+(r||0)+"px, "+(o||0)+"px, 0) "),(O(a)||O(s))&&(g+="scale3d("+(O(a)?a:1)+", "+(O(s)?s:1)+", 1) "),O(c)&&(g+="rotateZ("+c+"rad) "),O(l)&&(g+="rotateX("+l+"rad) "),O(u)&&(g+="rotateY("+u+"rad) "),g.length&&(m+="transform:"+g+";"),O(n)&&(m+="opacity:"+n+";",0===n&&(m+="visibility:hidden;"),n<1&&(m+="pointer-events:none;")),O(h)&&(m+="height:"+h+"px;"),O(p)&&(m+="width:"+p+"px;");var E=e.elementCurrentStyle||"";m.length===E.length&&m===E||(e.style.cssText=m,e.elementCurrentStyle=m)},M={styles:function(e){var t=e.mixinConfig,n=e.viewProps,i=e.viewInternalAPI,r=e.viewExternalAPI,o=e.view,a=Object.assign({},n),s={};A(t,[i,r],n);var l=function(){return o.rect?E(o.rect,o.childViews,[n.translateX||0,n.translateY||0],[n.scaleX||0,n.scaleY||0]):null};return i.rect={get:l},r.rect={get:l},t.forEach((function(e){n[e]=void 0===a[e]?R[e]:a[e]})),{write:function(){if(S(s,n))return b(o.element,n),Object.assign(s,Object.assign({},n)),!0},destroy:function(){}}},listeners:function(e){e.mixinConfig,e.viewProps,e.viewInternalAPI;var t,n=e.viewExternalAPI,i=(e.viewState,e.view),r=[],o=(t=i.element,function(e,n){t.addEventListener(e,n)}),a=function(e){return function(t,n){e.removeEventListener(t,n)}}(i.element);return n.on=function(e,t){r.push({type:e,fn:t}),o(e,t)},n.off=function(e,t){r.splice(r.findIndex((function(n){return n.type===e&&n.fn===t})),1),a(e,t)},{write:function(){return!0},destroy:function(){r.forEach((function(e){a(e.type,e.fn)}))}}},animations:function(e){var t=e.mixinConfig,n=e.viewProps,r=e.viewInternalAPI,o=e.viewExternalAPI,a=Object.assign({},n),s=[];return i(t,(function(e,t){var i=function(e,t,n){var i=e[t]&&"object"==typeof e[t][n]?e[t][n]:e[t]||e,r="string"==typeof i?i:i.type,o="object"==typeof i?Object.assign({},i):{};return w[r]?w[r](o):null}(t);i&&(i.onupdate=function(t){n[e]=t},i.target=a[e],A([{key:e,setter:function(e){i.target!==e&&(i.target=e)},getter:function(){return n[e]}}],[r,o],n,!0),s.push(i))})),{write:function(e){var t=document.hidden,n=!0;return s.forEach((function(i){i.resting||(n=!1),i.interpolate(e,t)})),n},destroy:function(){}}},apis:function(e){var t=e.mixinConfig,n=e.viewProps,i=e.viewExternalAPI;A(t,i,n)}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.layoutCalculated||(e.paddingTop=parseInt(n.paddingTop,10)||0,e.marginTop=parseInt(n.marginTop,10)||0,e.marginRight=parseInt(n.marginRight,10)||0,e.marginBottom=parseInt(n.marginBottom,10)||0,e.marginLeft=parseInt(n.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=null===t.offsetParent,e},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tag,n=void 0===t?"div":t,i=e.name,o=void 0===i?null:i,a=e.attributes,s=void 0===a?{}:a,l=e.read,d=void 0===l?function(){}:l,h=e.write,g=void 0===h?function(){}:h,v=e.create,_=void 0===v?function(){}:v,I=e.destroy,y=void 0===I?function(){}:I,T=e.filterFrameActionsForChild,w=void 0===T?function(e,t){return t}:T,A=e.didCreateView,O=void 0===A?function(){}:A,R=e.didWriteView,S=void 0===R?function(){}:R,b=e.ignoreRect,P=void 0!==b&&b,L=e.ignoreRectUpdate,D=void 0!==L&&L,x=e.mixins,G=void 0===x?[]:x;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=u(n,"filepond--"+o,s),a=window.getComputedStyle(i,null),l=C(),h=null,v=!1,I=[],T=[],A={},R={},b=[g],L=[d],x=[y],N=function(){return i},F=function(){return I.concat()},k=function(){return A},V=function(e){return function(t,n){return t(e,n)}},U=function(){return h||(h=E(l,I,[0,0],[1,1]))},B=function(){return a},q=function(){h=null,I.forEach((function(e){return e._read()})),!(D&&l.width&&l.height)&&C(l,i,a);var e={root:Z,props:t,rect:l};L.forEach((function(t){return t(e)}))},z=function(e,n,i){var r=0===n.length;return b.forEach((function(o){!1===o({props:t,root:Z,actions:n,timestamp:e,shouldOptimize:i})&&(r=!1)})),T.forEach((function(t){!1===t.write(e)&&(r=!1)})),I.filter((function(e){return!!e.element.parentNode})).forEach((function(t){t._write(e,w(t,n),i)||(r=!1)})),I.forEach((function(t,o){t.element.parentNode||(Z.appendChild(t.element,o),t._read(),t._write(e,w(t,n),i),r=!1)})),v=r,S({props:t,root:Z,actions:n,timestamp:e}),r},j=function(){T.forEach((function(e){return e.destroy()})),x.forEach((function(e){e({root:Z,props:t})})),I.forEach((function(e){return e._destroy()}))},W={element:{get:N},style:{get:B},childViews:{get:F}},H=Object.assign({},W,{rect:{get:U},ref:{get:k},is:function(e){return o===e},appendChild:c(i),createChildView:V(e),linkView:function(e){return I.push(e),e},unlinkView:function(e){I.splice(I.indexOf(e),1)},appendChildView:f(0,I),removeChildView:p(i,I),registerWriter:function(e){return b.push(e)},registerReader:function(e){return L.push(e)},registerDestroyer:function(e){return x.push(e)},invalidateLayout:function(){return i.layoutCalculated=!1},dispatch:e.dispatch,query:e.query}),Y={element:{get:N},childViews:{get:F},rect:{get:U},resting:{get:function(){return v}},isRectIgnored:function(){return P},_read:q,_write:z,_destroy:j},X=Object.assign({},W,{rect:{get:function(){return l}}});Object.keys(G).sort((function(e,t){return"styles"===e?1:"styles"===t?-1:0})).forEach((function(e){var n=M[e]({mixinConfig:G[e],viewProps:t,viewState:R,viewInternalAPI:H,viewExternalAPI:Y,view:r(X)});n&&T.push(n)}));var Z=r(H);_({root:Z,props:t});var Q=m(i);return I.forEach((function(e,t){Z.appendChild(e.element,Q+t)})),O(Z),r(Y)}},L=function(e,t){return function(n){var i=n.root,r=n.props,o=n.actions,a=void 0===o?[]:o,s=n.timestamp,l=n.shouldOptimize;a.filter((function(t){return e[t.type]})).forEach((function(t){return e[t.type]({root:i,props:r,action:t.data,timestamp:s,shouldOptimize:l})})),t&&t({root:i,props:r,actions:a,timestamp:s,shouldOptimize:l})}},D=function(e,t){return t.parentNode.insertBefore(e,t)},x=function(e,t){return t.parentNode.insertBefore(e,t.nextSibling)},G=function(e){return Array.isArray(e)},N=function(e){return null==e},F=function(e){return e.trim()},k=function(e){return""+e},V=function(e){return"boolean"==typeof e},U=function(e){return V(e)?e:"true"===e},B=function(e){return"string"==typeof e},q=function(e){return I(e)?e:B(e)?k(e).replace(/[a-z]+/gi,""):0},z=function(e){return parseInt(q(e),10)},j=function(e){return parseFloat(q(e))},W=function(e){return I(e)&&isFinite(e)&&Math.floor(e)===e},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(W(e))return e;var n=k(e).trim();return/MB$/i.test(n)?(n=n.replace(/MB$i/,"").trim(),z(n)*t*t):/KB/i.test(n)?(n=n.replace(/KB$i/,"").trim(),z(n)*t):z(n)},Y=function(e){return"function"==typeof e},X={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},Z=function(e,t,n,i,r){if(null===t)return null;if("function"==typeof t)return t;var o={url:"GET"===n||"PATCH"===n?"?"+e+"=":"",method:n,headers:r,withCredentials:!1,timeout:i,onload:null,ondata:null,onerror:null};if(B(t))return o.url=t,o;if(Object.assign(o,t),B(o.headers)){var a=o.headers.split(/:(.+)/);o.headers={header:a[0],value:a[1]}}return o.withCredentials=U(o.withCredentials),o},Q=function(e){return"object"==typeof e&&null!==e},K=function(e){return G(e)?"array":function(e){return null===e}(e)?"null":W(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":function(e){return Q(e)&&B(e.url)&&Q(e.process)&&Q(e.revert)&&Q(e.restore)&&Q(e.fetch)}(e)?"api":void 0===e?"undefined":d(e)},J={array:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return N(e)?[]:G(e)?e:k(e).split(t).map(F).filter((function(e){return e.length}))},boolean:U,int:function(e){return"bytes"===K(e)?H(e):z(e)},number:j,float:j,bytes:H,string:function(e){return Y(e)?e:k(e)},function:function(e){return function(e){for(var t=self,n=e.split("."),i=null;i=n.shift();)if(!(t=t[i]))return null;return t}(e)},serverapi:function(e){return(n={}).url=B(t=e)?t:t.url||"",n.timeout=t.timeout?parseInt(t.timeout,10):0,n.headers=t.headers?t.headers:{},i(X,(function(e){n[e]=Z(e,t[e],X[e],n.timeout,n.headers)})),n.process=t.process||B(t)||t.url?n.process:null,n.remove=t.remove||null,delete n.headers,n;var t,n},object:function(e){try{return JSON.parse(e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'))}catch(e){return null}}},$=function(e,t,n){if(e===t)return e;var i,r=K(e);if(r!==n){var o=(i=e,J[n](i));if(r=K(o),null===o)throw'Trying to assign value with incorrect type to "'+option+'", allowed type: "'+n+'"';e=o}return e},ee=function(e){var t={};return i(e,(function(n){var i,r,o,a=e[n];t[n]=(i=a[0],r=a[1],o=i,{enumerable:!0,get:function(){return o},set:function(e){o=$(e,i,r)}})})),r(t)},te=function(e){return{items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:ee(e)}},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join(t)},ie=function(e,t){var n={};return i(t,(function(t){n[t]={get:function(){return e.getState().options[t]},set:function(n){e.dispatch("SET_"+ne(t,"_").toUpperCase(),{value:n})}}})),n},re=function(e){return function(t,n,r){var o={};return i(e,(function(e){var n=ne(e,"_").toUpperCase();o["SET_"+n]=function(i){try{r.options[e]=i.value}catch(e){}t("DID_SET_"+n,{value:r.options[e]})}})),o}},oe=function(e){return function(t){var n={};return i(e,(function(e){n["GET_"+ne(e,"_").toUpperCase()]=function(n){return t.options[e]}})),n}},ae=1,se=2,le=3,ue=4,ce=5,de=function(){return Math.random().toString(36).substr(2,9)};function fe(e){this.wrapped=e}function pe(e){var t,n;function i(t,n){try{var o=e[t](n),a=o.value,s=a instanceof fe;Promise.resolve(s?a.wrapped:a).then((function(e){s?i("next",e):r(o.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}function he(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}"function"==typeof Symbol&&Symbol.asyncIterator&&(pe.prototype[Symbol.asyncIterator]=function(){return this}),pe.prototype.next=function(e){return this._invoke("next",e)},pe.prototype.throw=function(e){return this._invoke("throw",e)},pe.prototype.return=function(e){return this._invoke("return",e)};function ge(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||me(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function me(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var Ee,ve,_e=function(e,t){return e.splice(t,1)},Ie=function(){var e=[],t=function(t,n){_e(e,e.findIndex((function(e){return e.event===t&&(e.cb===n||!n)})))},n=function(t,n,i){e.filter((function(e){return e.event===t})).map((function(e){return e.cb})).forEach((function(e){return function(e,t){t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)}((function(){return e.apply(void 0,ge(n))}),i)}))};return{fireSync:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];n(e,i,!0)},fire:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];n(e,i,!1)},on:function(t,n){e.push({event:t,cb:n})},onOnce:function(n,i){e.push({event:n,cb:function(){t(n,i),i.apply(void 0,arguments)}})},off:t}},ye=function(e,t,n){Object.getOwnPropertyNames(e).filter((function(e){return!n.includes(e)})).forEach((function(n){return Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))},Te=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],we=function(e){var t={};return ye(e,t,Te),t},Ae=function(e){e.forEach((function(t,n){t.released&&_e(e,n)}))},Oe={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},Re={INPUT:1,LIMBO:2,LOCAL:3},Se=function(e){return/[^0-9]+/.exec(e)},be=function(){return Se(1.1.toLocaleString())[0]},Me={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},Ce=[],Pe=function(e,t,n){return new Promise((function(i,r){var o=Ce.filter((function(t){return t.key===e})).map((function(e){return e.cb}));if(0!==o.length){var a=o.shift();o.reduce((function(e,t){return e.then((function(e){return t(e,n)}))}),a(t,n)).then((function(e){return i(e)})).catch((function(e){return r(e)}))}else i(t)}))},Le=function(e,t,n){return Ce.filter((function(t){return t.key===e})).map((function(e){return e.cb(t,n)}))},De=function(e,t){return Ce.push({key:e,cb:t})},xe=function(){return Object.assign({},Ge)},Ge={id:[null,Me.STRING],name:["filepond",Me.STRING],disabled:[!1,Me.BOOLEAN],className:[null,Me.STRING],required:[!1,Me.BOOLEAN],captureMethod:[null,Me.STRING],allowSyncAcceptAttribute:[!0,Me.BOOLEAN],allowDrop:[!0,Me.BOOLEAN],allowBrowse:[!0,Me.BOOLEAN],allowPaste:[!0,Me.BOOLEAN],allowMultiple:[!1,Me.BOOLEAN],allowReplace:[!0,Me.BOOLEAN],allowRevert:[!0,Me.BOOLEAN],allowRemove:[!0,Me.BOOLEAN],allowProcess:[!0,Me.BOOLEAN],allowReorder:[!1,Me.BOOLEAN],allowDirectoriesOnly:[!1,Me.BOOLEAN],storeAsFile:[!1,Me.BOOLEAN],forceRevert:[!1,Me.BOOLEAN],maxFiles:[null,Me.INT],checkValidity:[!1,Me.BOOLEAN],itemInsertLocationFreedom:[!0,Me.BOOLEAN],itemInsertLocation:["before",Me.STRING],itemInsertInterval:[75,Me.INT],dropOnPage:[!1,Me.BOOLEAN],dropOnElement:[!0,Me.BOOLEAN],dropValidation:[!1,Me.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],Me.ARRAY],instantUpload:[!0,Me.BOOLEAN],maxParallelUploads:[2,Me.INT],allowMinimumUploadDuration:[!0,Me.BOOLEAN],chunkUploads:[!1,Me.BOOLEAN],chunkForce:[!1,Me.BOOLEAN],chunkSize:[5e6,Me.INT],chunkRetryDelays:[[500,1e3,3e3],Me.ARRAY],server:[null,Me.SERVER_API],fileSizeBase:[1e3,Me.INT],labelFileSizeBytes:["bytes",Me.STRING],labelFileSizeKilobytes:["KB",Me.STRING],labelFileSizeMegabytes:["MB",Me.STRING],labelFileSizeGigabytes:["GB",Me.STRING],labelDecimalSeparator:[be(),Me.STRING],labelThousandsSeparator:[(Ee=be(),ve=1e3.toLocaleString(),ve!==1e3.toString()?Se(ve)[0]:"."===Ee?",":"."),Me.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',Me.STRING],labelInvalidField:["Field contains invalid files",Me.STRING],labelFileWaitingForSize:["Waiting for size",Me.STRING],labelFileSizeNotAvailable:["Size not available",Me.STRING],labelFileCountSingular:["file in list",Me.STRING],labelFileCountPlural:["files in list",Me.STRING],labelFileLoading:["Loading",Me.STRING],labelFileAdded:["Added",Me.STRING],labelFileLoadError:["Error during load",Me.STRING],labelFileRemoved:["Removed",Me.STRING],labelFileRemoveError:["Error during remove",Me.STRING],labelFileProcessing:["Uploading",Me.STRING],labelFileProcessingComplete:["Upload complete",Me.STRING],labelFileProcessingAborted:["Upload cancelled",Me.STRING],labelFileProcessingError:["Error during upload",Me.STRING],labelFileProcessingRevertError:["Error during revert",Me.STRING],labelTapToCancel:["tap to cancel",Me.STRING],labelTapToRetry:["tap to retry",Me.STRING],labelTapToUndo:["tap to undo",Me.STRING],labelButtonRemoveItem:["Remove",Me.STRING],labelButtonAbortItemLoad:["Abort",Me.STRING],labelButtonRetryItemLoad:["Retry",Me.STRING],labelButtonAbortItemProcessing:["Cancel",Me.STRING],labelButtonUndoItemProcessing:["Undo",Me.STRING],labelButtonRetryItemProcessing:["Retry",Me.STRING],labelButtonProcessItem:["Upload",Me.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',Me.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',Me.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',Me.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',Me.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',Me.STRING],oninit:[null,Me.FUNCTION],onwarning:[null,Me.FUNCTION],onerror:[null,Me.FUNCTION],onactivatefile:[null,Me.FUNCTION],oninitfile:[null,Me.FUNCTION],onaddfilestart:[null,Me.FUNCTION],onaddfileprogress:[null,Me.FUNCTION],onaddfile:[null,Me.FUNCTION],onprocessfilestart:[null,Me.FUNCTION],onprocessfileprogress:[null,Me.FUNCTION],onprocessfileabort:[null,Me.FUNCTION],onprocessfilerevert:[null,Me.FUNCTION],onprocessfile:[null,Me.FUNCTION],onprocessfiles:[null,Me.FUNCTION],onremovefile:[null,Me.FUNCTION],onpreparefile:[null,Me.FUNCTION],onupdatefiles:[null,Me.FUNCTION],onreorderfiles:[null,Me.FUNCTION],beforeDropFile:[null,Me.FUNCTION],beforeAddFile:[null,Me.FUNCTION],beforeRemoveFile:[null,Me.FUNCTION],beforePrepareFile:[null,Me.FUNCTION],stylePanelLayout:[null,Me.STRING],stylePanelAspectRatio:[null,Me.STRING],styleItemPanelAspectRatio:[null,Me.STRING],styleButtonRemoveItemPosition:["left",Me.STRING],styleButtonProcessItemPosition:["right",Me.STRING],styleLoadIndicatorPosition:["right",Me.STRING],styleProgressIndicatorPosition:["right",Me.STRING],styleButtonRemoveItemAlign:[!1,Me.BOOLEAN],files:[[],Me.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],Me.ARRAY]},Ne=function(e,t){return N(t)?e[0]||null:W(t)?e[t]||null:("object"==typeof t&&(t=t.id),e.find((function(e){return e.id===t}))||null)},Fe=function(e){if(N(e))return e;if(/:/.test(e)){var t=e.split(":");return t[1]/t[0]}return parseFloat(e)},ke=function(e){return e.filter((function(e){return!e.archived}))},Ve={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4},Ue=null,Be=[Oe.LOAD_ERROR,Oe.PROCESSING_ERROR,Oe.PROCESSING_REVERT_ERROR],qe=[Oe.LOADING,Oe.PROCESSING,Oe.PROCESSING_QUEUED,Oe.INIT],ze=[Oe.PROCESSING_COMPLETE],je=function(e){return Be.includes(e.status)},We=function(e){return qe.includes(e.status)},He=function(e){return ze.includes(e.status)},Ye=function(e){return Q(e.options.server)&&(Q(e.options.server.process)||Y(e.options.server.process))},Xe=function(e){return{GET_STATUS:function(){var t=ke(e.items),n=Ve.EMPTY,i=Ve.ERROR,r=Ve.BUSY,o=Ve.IDLE,a=Ve.READY;return 0===t.length?n:t.some(je)?i:t.some(We)?r:t.some(He)?a:o},GET_ITEM:function(t){return Ne(e.items,t)},GET_ACTIVE_ITEM:function(t){return Ne(ke(e.items),t)},GET_ACTIVE_ITEMS:function(){return ke(e.items)},GET_ITEMS:function(){return e.items},GET_ITEM_NAME:function(t){var n=Ne(e.items,t);return n?n.filename:null},GET_ITEM_SIZE:function(t){var n=Ne(e.items,t);return n?n.fileSize:null},GET_STYLES:function(){return Object.keys(e.options).filter((function(e){return/^style/.test(e)})).map((function(t){return{name:t,value:e.options[t]}}))},GET_PANEL_ASPECT_RATIO:function(){return/circle/.test(e.options.stylePanelLayout)?1:Fe(e.options.stylePanelAspectRatio)},GET_ITEM_PANEL_ASPECT_RATIO:function(){return e.options.styleItemPanelAspectRatio},GET_ITEMS_BY_STATUS:function(t){return ke(e.items).filter((function(e){return e.status===t}))},GET_TOTAL_ITEMS:function(){return ke(e.items).length},SHOULD_UPDATE_FILE_INPUT:function(){return e.options.storeAsFile&&function(){if(null===Ue)try{var e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));var t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,Ue=1===t.files.length}catch(e){Ue=!1}return Ue}()&&!Ye(e)},IS_ASYNC:function(){return Ye(e)},GET_FILE_SIZE_LABELS:function(e){return{labelBytes:e("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:e("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:e("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:e("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0}}}},Ze=function(e,t,n){return Math.max(Math.min(n,e),t)},Qe=function(e){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e)},Ke=function(e){return e.split("/").pop().split("?").shift()},Je=function(e){return e.split(".").pop()},$e=function(e){if("string"!=typeof e)return"";var t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?"jpeg"===t?"jpg":t:""},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t+e).slice(-t.length)},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return e.getFullYear()+"-"+et(e.getMonth()+1,"00")+"-"+et(e.getDate(),"00")+"_"+et(e.getHours(),"00")+"-"+et(e.getMinutes(),"00")+"-"+et(e.getSeconds(),"00")},nt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r="string"==typeof n?e.slice(0,e.size,n):e.slice(0,e.size,e.type);return r.lastModifiedDate=new Date,e._relativePath&&(r._relativePath=e._relativePath),B(t)||(t=tt()),t&&null===i&&Je(t)?r.name=t:(i=i||$e(r.type),r.name=t+(i?"."+i:"")),r},it=function(e,t){var n=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(n){var i=new n;return i.append(e),i.getBlob(t)}return new Blob([e],{type:t})},rt=function(e){return(/^data:(.+);/.exec(e)||[])[1]||null},ot=function(e){var t=rt(e),n=function(e){return atob(function(e){return e.split(",")[1].replace(/\s/g,"")}(e))}(e);return function(e,t){for(var n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return it(n,t)}(n,t)},at=function(e){if(!/^content-disposition:/i.test(e))return null;var t=e.split(/filename=|filename\*=.+''/).splice(1).map((function(e){return e.trim().replace(/^["']|[;"']{0,2}$/g,"")})).filter((function(e){return e.length}));return t.length?decodeURI(t[t.length-1]):null},st=function(e){if(/content-length:/i.test(e)){var t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},lt=function(e){return/x-content-transfer-id:/i.test(e)&&(e.split(":")[1]||"").trim()||null},ut=function(e){var t={source:null,name:null,size:null},n=e.split("\n"),i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value,u=at(l);if(u)t.name=u;else{var c=st(l);if(c)t.size=c;else{var d=lt(l);d&&(t.source=d)}}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return t},ct=function(e){var t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},n=function(n){e?(t.timestamp=Date.now(),t.request=e(n,(function(e){t.duration=Date.now()-t.timestamp,t.complete=!0,e instanceof Blob&&(e=nt(e,e.name||Ke(n))),i.fire("load",e instanceof Blob?e:e?e.body:null)}),(function(e){i.fire("error","string"==typeof e?{type:"error",code:0,body:e}:e)}),(function(e,n,r){r&&(t.size=r),t.duration=Date.now()-t.timestamp,e?(t.progress=n/r,i.fire("progress",t.progress)):t.progress=null}),(function(){i.fire("abort")}),(function(e){var n=ut("string"==typeof e?e:e.headers);i.fire("meta",{size:t.size||n.size,filename:n.name,source:n.source})}))):i.fire("error",{type:"error",body:"Can't load URL",code:400})},i=Object.assign({},Ie(),{setSource:function(e){return t.source=e},getProgress:function(){return t.progress},abort:function(){t.request&&t.request.abort&&t.request.abort()},load:function(){var e,r,o=t.source;i.fire("init",o),o instanceof File?i.fire("load",o):o instanceof Blob?i.fire("load",nt(o,o.name)):Qe(o)?i.fire("load",nt(ot(o),e,null,r)):n(o)}});return i},dt=function(e){return/GET|HEAD/.test(e)},ft=function(e,t,n){var i={onheaders:function(){},onprogress:function(){},onload:function(){},ontimeout:function(){},onerror:function(){},onabort:function(){},abort:function(){r=!0,a.abort()}},r=!1,o=!1;n=Object.assign({method:"POST",headers:{},withCredentials:!1},n),t=encodeURI(t),dt(n.method)&&e&&(t=""+t+encodeURIComponent("string"==typeof e?e:JSON.stringify(e)));var a=new XMLHttpRequest;return(dt(n.method)?a:a.upload).onprogress=function(e){r||i.onprogress(e.lengthComputable,e.loaded,e.total)},a.onreadystatechange=function(){a.readyState<2||4===a.readyState&&0===a.status||o||(o=!0,i.onheaders(a))},a.onload=function(){a.status>=200&&a.status<300?i.onload(a):i.onerror(a)},a.onerror=function(){return i.onerror(a)},a.onabort=function(){r=!0,i.onabort()},a.ontimeout=function(){return i.ontimeout(a)},a.open(n.method,t,!0),W(n.timeout)&&(a.timeout=n.timeout),Object.keys(n.headers).forEach((function(e){var t=unescape(encodeURIComponent(n.headers[e]));a.setRequestHeader(e,t)})),n.responseType&&(a.responseType=n.responseType),n.withCredentials&&(a.withCredentials=!0),a.send(e),i},pt=function(e,t,n,i){return{type:e,code:t,body:n,headers:i}},ht=function(e){return function(t){e(pt("error",0,"Timeout",t.getAllResponseHeaders()))}},gt=function(e){return/\?/.test(e)},mt=function(){for(var e="",t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){e+=gt(e)&&gt(t)?t.replace(/\?/,"&"):t})),e},Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("function"==typeof t)return t;if(!t||!B(t.url))return null;var n=t.onload||function(e){return e},i=t.onerror||function(e){return null};return function(r,o,a,s,l,u){var c=ft(r,mt(e,t.url),Object.assign({},t,{responseType:"blob"}));return c.onload=function(e){var i=e.getAllResponseHeaders(),a=ut(i).name||Ke(r);o(pt("load",e.status,"HEAD"===t.method?null:nt(n(e.response),a),i))},c.onerror=function(e){a(pt("error",e.status,i(e.response)||e.statusText,e.getAllResponseHeaders()))},c.onheaders=function(e){u(pt("headers",e.status,null,e.getAllResponseHeaders()))},c.ontimeout=ht(a),c.onprogress=s,c.onabort=l,c}},vt=0,_t=1,It=2,yt=3,Tt=4,wt=function(e,t,n,i,r,o,a,s,l,u,c){for(var d=[],f=c.chunkTransferId,p=c.chunkServer,h=c.chunkSize,g=c.chunkRetryDelays,m={serverId:f,aborted:!1},E=t.ondata||function(e){return e},v=t.onload||function(e,t){return"HEAD"===t?e.getResponseHeader("Upload-Offset"):e.response},_=t.onerror||function(e){return null},I=Math.floor(i.size/h),y=0;y<=I;y++){var T=y*h,w=i.slice(T,T+h,"application/offset+octet-stream");d[y]={index:y,size:w.size,offset:T,data:w,file:i,progress:0,retries:ge(g),status:vt,error:null,request:null,timeout:null}}var A,O,R,S,b=function(e){return e.status===vt||e.status===yt},M=function(t){if(!m.aborted)if(t=t||d.find(b)){t.status=It,t.progress=null;var n=p.ondata||function(e){return e},r=p.onerror||function(e){return null},s=mt(e,p.url,m.serverId),u="function"==typeof p.headers?p.headers(t):Object.assign({},p.headers,{"Content-Type":"application/offset+octet-stream","Upload-Offset":t.offset,"Upload-Length":i.size,"Upload-Name":i.name}),c=t.request=ft(n(t.data),s,Object.assign({},p,{headers:u}));c.onload=function(){t.status=_t,t.request=null,L()},c.onprogress=function(e,n,i){t.progress=e?n:null,P()},c.onerror=function(e){t.status=yt,t.request=null,t.error=r(e.response)||e.statusText,C(t)||a(pt("error",e.status,r(e.response)||e.statusText,e.getAllResponseHeaders()))},c.ontimeout=function(e){t.status=yt,t.request=null,C(t)||ht(a)(e)},c.onabort=function(){t.status=vt,t.request=null,l()}}else d.every((function(e){return e.status===_t}))&&o(m.serverId)},C=function(e){return 0!==e.retries.length&&(e.status=Tt,clearTimeout(e.timeout),e.timeout=setTimeout((function(){M(e)}),e.retries.shift()),!0)},P=function(){var e=d.reduce((function(e,t){return null===e||null===t.progress?null:e+t.progress}),0);if(null===e)return s(!1,0,0);var t=d.reduce((function(e,t){return e+t.size}),0);s(!0,e,t)},L=function(){d.filter((function(e){return e.status===It})).length>=1||M()};return m.serverId?(A=function(e){m.aborted||(d.filter((function(t){return t.offset<e})).forEach((function(e){e.status=_t,e.progress=e.size})),L())},O=mt(e,p.url,m.serverId),R={headers:"function"==typeof t.headers?t.headers(m.serverId):Object.assign({},t.headers),method:"HEAD"},(S=ft(null,O,R)).onload=function(e){return A(v(e,R.method))},S.onerror=function(e){return a(pt("error",e.status,_(e.response)||e.statusText,e.getAllResponseHeaders()))},S.ontimeout=ht(a)):function(o){var s=new FormData;Q(r)&&s.append(n,JSON.stringify(r));var l="function"==typeof t.headers?t.headers(i,r):Object.assign({},t.headers,{"Upload-Length":i.size}),u=Object.assign({},t,{headers:l}),c=ft(E(s),mt(e,t.url),u);c.onload=function(e){return o(v(e,u.method))},c.onerror=function(e){return a(pt("error",e.status,_(e.response)||e.statusText,e.getAllResponseHeaders()))},c.ontimeout=ht(a)}((function(e){m.aborted||(u(e),m.serverId=e,L())})),{abort:function(){m.aborted=!0,d.forEach((function(e){clearTimeout(e.timeout),e.request&&e.request.abort()}))}}},At=function(e,t,n,i){return function(r,o,a,s,l,u,c){if(r){var d=i.chunkUploads,f=d&&r.size>i.chunkSize,p=d&&(f||i.chunkForce);if(r instanceof Blob&&p)return wt(e,t,n,r,o,a,s,l,u,c,i);var h=t.ondata||function(e){return e},g=t.onload||function(e){return e},m=t.onerror||function(e){return null},E="function"==typeof t.headers?t.headers(r,o)||{}:Object.assign({},t.headers),v=Object.assign({},t,{headers:E}),_=new FormData;Q(o)&&_.append(n,JSON.stringify(o)),(r instanceof Blob?[{name:null,file:r}]:r).forEach((function(e){_.append(n,e.file,null===e.name?e.file.name:""+e.name+e.file.name)}));var I=ft(h(_),mt(e,t.url),v);return I.onload=function(e){a(pt("load",e.status,g(e.response),e.getAllResponseHeaders()))},I.onerror=function(e){s(pt("error",e.status,m(e.response)||e.statusText,e.getAllResponseHeaders()))},I.ontimeout=ht(s),I.onprogress=l,I.onabort=u,I}}},Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("function"==typeof t)return t;if(!t||!B(t.url))return function(e,t){return t()};var n=t.onload||function(e){return e},i=t.onerror||function(e){return null};return function(r,o,a){var s=ft(r,e+t.url,t);return s.onload=function(e){o(pt("load",e.status,n(e.response),e.getAllResponseHeaders()))},s.onerror=function(e){a(pt("error",e.status,i(e.response)||e.statusText,e.getAllResponseHeaders()))},s.ontimeout=ht(a),s}},Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e+Math.random()*(t-e)},St=function(e,t){var n={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},i=t.allowMinimumUploadDuration,r=function(){n.request&&(n.perceivedPerformanceUpdater.clear(),n.request.abort&&n.request.abort(),n.complete=!0)},o=i?function(){return n.progress?Math.min(n.progress,n.perceivedProgress):null}:function(){return n.progress||null},a=i?function(){return Math.min(n.duration,n.perceivedDuration)}:function(){return n.duration},s=Object.assign({},Ie(),{process:function(t,r){var o=function(){0!==n.duration&&null!==n.progress&&s.fire("progress",s.getProgress())},a=function(){n.complete=!0,s.fire("load-perceived",n.response.body)};s.fire("start"),n.timestamp=Date.now(),n.perceivedPerformanceUpdater=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,r=null,o=Date.now(),a=function a(){var s=Date.now()-o,l=Rt(n,i);s+l>t&&(l=s+l-t);var u=s/t;u>=1||document.hidden?e(1):(e(u),r=setTimeout(a,l))};return t>0&&a(),{clear:function(){clearTimeout(r)}}}((function(e){n.perceivedProgress=e,n.perceivedDuration=Date.now()-n.timestamp,o(),n.response&&1===n.perceivedProgress&&!n.complete&&a()}),i?Rt(750,1500):0),n.request=e(t,r,(function(e){n.response=Q(e)?e:{type:"load",code:200,body:""+e,headers:{}},n.duration=Date.now()-n.timestamp,n.progress=1,s.fire("load",n.response.body),(!i||i&&1===n.perceivedProgress)&&a()}),(function(e){n.perceivedPerformanceUpdater.clear(),s.fire("error",Q(e)?e:{type:"error",code:0,body:""+e})}),(function(e,t,i){n.duration=Date.now()-n.timestamp,n.progress=e?t/i:null,o()}),(function(){n.perceivedPerformanceUpdater.clear(),s.fire("abort",n.response?n.response.body:null)}),(function(e){s.fire("transfer",e)}))},abort:r,getProgress:o,getDuration:a,reset:function(){r(),n.complete=!1,n.perceivedProgress=0,n.progress=0,n.timestamp=null,n.perceivedDuration=0,n.duration=0,n.request=null,n.response=null}});return s},bt=function(e){return e.substr(0,e.lastIndexOf("."))||e},Mt=function(e){var t=[e.name,e.size,e.type];return e instanceof Blob||Qe(e)?t[0]=e.name||tt():Qe(e)?(t[1]=e.length,t[2]=rt(e)):B(e)&&(t[0]=Ke(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},Ct=function(e){return!!(e instanceof File||e instanceof Blob&&e.name)},Pt=function e(t){if(!Q(t))return t;var n=G(t)?[]:{};for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];n[i]=r&&Q(r)?e(r):r}return n},Lt=function(e,t){var n=function(e,t){return N(t)?0:B(t)?e.findIndex((function(e){return e.id===t})):-1}(e,t);if(!(n<0))return e[n]||null},Dt=function(e,t,n,i,r,o){var a=ft(null,e,{method:"GET",responseType:"blob"});return a.onload=function(n){var i=n.getAllResponseHeaders(),r=ut(i).name||Ke(e);t(pt("load",n.status,nt(n.response,r),i))},a.onerror=function(e){n(pt("error",e.status,e.statusText,e.getAllResponseHeaders()))},a.onheaders=function(e){o(pt("headers",e.status,null,e.getAllResponseHeaders()))},a.ontimeout=ht(n),a.onprogress=i,a.onabort=r,a},xt=function(e){return 0===e.indexOf("//")&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]},Gt=function(e){return function(){return Y(e)?e.apply(void 0,arguments):e}},Nt=function(e,t){clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout((function(){e("DID_UPDATE_ITEMS",{items:ke(t.items)})}),0)},Ft=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise((function(t){if(!e)return t(!0);var i=e.apply(void 0,n);return null==i?t(!0):"boolean"==typeof i?t(i):void("function"==typeof i.then&&i.then(t))}))},kt=function(e,t){e.items.sort((function(e,n){return t(we(e),we(n))}))},Vt=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.query,r=n.success,o=void 0===r?function(){}:r,a=n.failure,s=void 0===a?function(){}:a,l=he(n,["query","success","failure"]),u=Ne(e.items,i);u?t(u,o,s,l||{}):s({error:pt("error",0,"Item not found"),file:null})}},Ut=function(e,t,n){return{ABORT_ALL:function(){ke(n.items).forEach((function(e){e.freeze(),e.abortLoad(),e.abortProcessing()}))},DID_SET_FILES:function(t){var i=t.value,r=(void 0===i?[]:i).map((function(e){return{source:e.source?e.source:e,options:e.options}})),o=ke(n.items);o.forEach((function(t){r.find((function(e){return e.source===t.source||e.source===t.file}))||e("REMOVE_ITEM",{query:t,remove:!1})})),o=ke(n.items),r.forEach((function(t,n){o.find((function(e){return e.source===t.source||e.file===t.source}))||e("ADD_ITEM",Object.assign({},t,{interactionMethod:ce,index:n}))}))},DID_UPDATE_ITEM_METADATA:function(i){var r=i.id,o=i.action,a=i.change;a.silent||(clearTimeout(n.itemUpdateTimeout),n.itemUpdateTimeout=setTimeout((function(){var i=Lt(n.items,r);if(t("IS_ASYNC")){i.origin===Re.LOCAL&&e("DID_LOAD_ITEM",{id:i.id,error:null,serverFileReference:i.source});var s,l=function(){setTimeout((function(){e("REQUEST_ITEM_PROCESSING",{query:r})}),32)};return i.status===Oe.PROCESSING_COMPLETE?(s=n.options.instantUpload,void i.revert(Ot(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(s?l:function(){}).catch((function(){}))):i.status===Oe.PROCESSING?function(e){i.abortProcessing().then(e?l:function(){})}(n.options.instantUpload):void(n.options.instantUpload&&l())}Pe("SHOULD_PREPARE_OUTPUT",!1,{item:i,query:t,action:o,change:a}).then((function(n){var o=t("GET_BEFORE_PREPARE_FILE");o&&(n=o(i,n)),n&&e("REQUEST_PREPARE_OUTPUT",{query:r,item:i,success:function(t){e("DID_PREPARE_OUTPUT",{id:r,file:t})}},!0)}))}),0))},MOVE_ITEM:function(e){var t=e.query,i=e.index,r=Ne(n.items,t);if(r){var o=n.items.indexOf(r);o!==(i=Ze(i,0,n.items.length-1))&&n.items.splice(i,0,n.items.splice(o,1)[0])}},SORT:function(i){var r=i.compare;kt(n,r),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:function(n){var i=n.items,r=n.index,o=n.interactionMethod,a=n.success,s=void 0===a?function(){}:a,l=n.failure,u=void 0===l?function(){}:l,c=r;if(-1===r||void 0===r){var d=t("GET_ITEM_INSERT_LOCATION"),f=t("GET_TOTAL_ITEMS");c="before"===d?0:f}var p=t("GET_IGNORED_FILES"),h=i.filter((function(e){return Ct(e)?!p.includes(e.name.toLowerCase()):!N(e)})).map((function(t){return new Promise((function(n,i){e("ADD_ITEM",{interactionMethod:o,source:t.source||t,success:n,failure:i,index:c++,options:t.options||{}})}))}));Promise.all(h).then(s).catch(u)},ADD_ITEM:function(i){var o=i.source,a=i.index,s=void 0===a?-1:a,l=i.interactionMethod,u=i.success,c=void 0===u?function(){}:u,d=i.failure,f=void 0===d?function(){}:d,p=i.options,h=void 0===p?{}:p;if(N(o))f({error:pt("error",0,"No source"),file:null});else if(!Ct(o)||!n.options.ignoredFiles.includes(o.name.toLowerCase())){if(!function(e){var t=ke(e.items).length;if(!e.options.allowMultiple)return 0===t;var n=e.options.maxFiles;return null===n||t<n}(n)){if(n.options.allowMultiple||!n.options.allowMultiple&&!n.options.allowReplace){var g=pt("warning",0,"Max files");return e("DID_THROW_MAX_FILES",{source:o,error:g}),void f({error:g,file:null})}var m=ke(n.items)[0];if(m.status===Oe.PROCESSING_COMPLETE||m.status===Oe.PROCESSING_REVERT_ERROR){var E=t("GET_FORCE_REVERT");if(m.revert(Ot(n.options.server.url,n.options.server.revert),E).then((function(){E&&e("ADD_ITEM",{source:o,index:s,interactionMethod:l,success:c,failure:f,options:h})})).catch((function(){})),E)return}e("REMOVE_ITEM",{query:m.id})}var v="local"===h.type?Re.LOCAL:"limbo"===h.type?Re.LIMBO:Re.INPUT,_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=de(),o={archived:!1,frozen:!1,released:!1,source:null,file:n,serverFileReference:t,transferId:null,processingAborted:!1,status:t?Oe.PROCESSING_COMPLETE:Oe.INIT,activeLoader:null,activeProcessor:null},a=null,s={},l=function(e){return o.status=e},u=function(e){if(!o.released&&!o.frozen){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];w.fire.apply(w,[e].concat(n))}},c=function(){return Je(o.file.name)},d=function(){return o.file.type},f=function(){return o.file.size},p=function(){return o.file},h=function(t,n,i){o.source=t,w.fireSync("init"),o.file?w.fireSync("load-skip"):(o.file=Mt(t),n.on("init",(function(){u("load-init")})),n.on("meta",(function(t){o.file.size=t.size,o.file.filename=t.filename,t.source&&(e=Re.LIMBO,o.serverFileReference=t.source,o.status=Oe.PROCESSING_COMPLETE),u("load-meta")})),n.on("progress",(function(e){l(Oe.LOADING),u("load-progress",e)})),n.on("error",(function(e){l(Oe.LOAD_ERROR),u("load-request-error",e)})),n.on("abort",(function(){l(Oe.INIT),u("load-abort")})),n.on("load",(function(t){o.activeLoader=null;var n=function(t){o.file=Ct(t)?t:o.file,e===Re.LIMBO&&o.serverFileReference?l(Oe.PROCESSING_COMPLETE):l(Oe.IDLE),u("load")};o.serverFileReference?n(t):i(t,n,(function(e){o.file=t,u("load-meta"),l(Oe.LOAD_ERROR),u("load-file-error",e)}))})),n.setSource(t),o.activeLoader=n,n.load())},g=function(){o.activeLoader&&o.activeLoader.load()},m=function(){o.activeLoader?o.activeLoader.abort():(l(Oe.INIT),u("load-abort"))},E=function e(t,n){if(o.processingAborted)o.processingAborted=!1;else if(l(Oe.PROCESSING),a=null,o.file instanceof Blob){t.on("load",(function(e){o.transferId=null,o.serverFileReference=e})),t.on("transfer",(function(e){o.transferId=e})),t.on("load-perceived",(function(e){o.activeProcessor=null,o.transferId=null,o.serverFileReference=e,l(Oe.PROCESSING_COMPLETE),u("process-complete",e)})),t.on("start",(function(){u("process-start")})),t.on("error",(function(e){o.activeProcessor=null,l(Oe.PROCESSING_ERROR),u("process-error",e)})),t.on("abort",(function(e){o.activeProcessor=null,o.serverFileReference=e,l(Oe.IDLE),u("process-abort"),a&&a()})),t.on("progress",(function(e){u("process-progress",e)}));var i=console.error;n(o.file,(function(e){o.archived||t.process(e,Object.assign({},s))}),i),o.activeProcessor=t}else w.on("load",(function(){e(t,n)}))},v=function(){o.processingAborted=!1,l(Oe.PROCESSING_QUEUED)},_=function(){return new Promise((function(e){if(!o.activeProcessor)return o.processingAborted=!0,l(Oe.IDLE),u("process-abort"),void e();a=function(){e()},o.activeProcessor.abort()}))},I=function(e,t){return new Promise((function(n,i){var r=null!==o.serverFileReference?o.serverFileReference:o.transferId;null!==r?(e(r,(function(){o.serverFileReference=null,o.transferId=null,n()}),(function(e){t?(l(Oe.PROCESSING_REVERT_ERROR),u("process-revert-error"),i(e)):n()})),l(Oe.IDLE),u("process-revert")):n()}))},y=function(e,t,n){var i=e.split("."),r=i[0],o=i.pop(),a=s;i.forEach((function(e){return a=a[e]})),JSON.stringify(a[o])!==JSON.stringify(t)&&(a[o]=t,u("metadata-update",{key:r,value:s[r],silent:n}))},T=function(e){return Pt(e?s[e]:s)},w=Object.assign({id:{get:function(){return i}},origin:{get:function(){return e},set:function(t){return e=t}},serverId:{get:function(){return o.serverFileReference}},transferId:{get:function(){return o.transferId}},status:{get:function(){return o.status}},filename:{get:function(){return o.file.name}},filenameWithoutExtension:{get:function(){return bt(o.file.name)}},fileExtension:{get:c},fileType:{get:d},fileSize:{get:f},file:{get:p},relativePath:{get:function(){return o.file._relativePath}},source:{get:function(){return o.source}},getMetadata:T,setMetadata:function(e,t,n){if(Q(e)){var i=e;return Object.keys(i).forEach((function(e){y(e,i[e],t)})),e}return y(e,t,n),t},extend:function(e,t){return A[e]=t},abortLoad:m,retryLoad:g,requestProcessing:v,abortProcessing:_,load:h,process:E,revert:I},Ie(),{freeze:function(){return o.frozen=!0},release:function(){return o.released=!0},released:{get:function(){return o.released}},archive:function(){return o.archived=!0},archived:{get:function(){return o.archived}}}),A=r(w);return A}(v,v===Re.INPUT?null:o,h.file);Object.keys(h.metadata||{}).forEach((function(e){_.setMetadata(e,h.metadata[e])})),Le("DID_CREATE_ITEM",_,{query:t,dispatch:e});var I=t("GET_ITEM_INSERT_LOCATION");n.options.itemInsertLocationFreedom||(s="before"===I?-1:n.items.length),function(e,t,n){N(t)||(void 0===n?e.push(t):function(e,t,n){e.splice(t,0,n)}(e,n=Ze(n,0,e.length),t))}(n.items,_,s),Y(I)&&o&&kt(n,I);var y=_.id;_.on("init",(function(){e("DID_INIT_ITEM",{id:y})})),_.on("load-init",(function(){e("DID_START_ITEM_LOAD",{id:y})})),_.on("load-meta",(function(){e("DID_UPDATE_ITEM_META",{id:y})})),_.on("load-progress",(function(t){e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:y,progress:t})})),_.on("load-request-error",(function(t){var i=Gt(n.options.labelFileLoadError)(t);if(t.code>=400&&t.code<500)return e("DID_THROW_ITEM_INVALID",{id:y,error:t,status:{main:i,sub:t.code+" ("+t.body+")"}}),void f({error:t,file:we(_)});e("DID_THROW_ITEM_LOAD_ERROR",{id:y,error:t,status:{main:i,sub:n.options.labelTapToRetry}})})),_.on("load-file-error",(function(t){e("DID_THROW_ITEM_INVALID",{id:y,error:t.status,status:t.status}),f({error:t.status,file:we(_)})})),_.on("load-abort",(function(){e("REMOVE_ITEM",{query:y})})),_.on("load-skip",(function(){e("COMPLETE_LOAD_ITEM",{query:y,item:_,data:{source:o,success:c}})})),_.on("load",(function(){var i=function(i){i?(_.on("metadata-update",(function(t){e("DID_UPDATE_ITEM_METADATA",{id:y,change:t})})),Pe("SHOULD_PREPARE_OUTPUT",!1,{item:_,query:t}).then((function(i){var r=t("GET_BEFORE_PREPARE_FILE");r&&(i=r(_,i));var a=function(){e("COMPLETE_LOAD_ITEM",{query:y,item:_,data:{source:o,success:c}}),Nt(e,n)};i?e("REQUEST_PREPARE_OUTPUT",{query:y,item:_,success:function(t){e("DID_PREPARE_OUTPUT",{id:y,file:t}),a()}},!0):a()}))):e("REMOVE_ITEM",{query:y})};Pe("DID_LOAD_ITEM",_,{query:t,dispatch:e}).then((function(){Ft(t("GET_BEFORE_ADD_FILE"),we(_)).then(i)})).catch((function(t){if(!t||!t.error||!t.status)return i(!1);e("DID_THROW_ITEM_INVALID",{id:y,error:t.error,status:t.status})}))})),_.on("process-start",(function(){e("DID_START_ITEM_PROCESSING",{id:y})})),_.on("process-progress",(function(t){e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:y,progress:t})})),_.on("process-error",(function(t){e("DID_THROW_ITEM_PROCESSING_ERROR",{id:y,error:t,status:{main:Gt(n.options.labelFileProcessingError)(t),sub:n.options.labelTapToRetry}})})),_.on("process-revert-error",(function(t){e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:y,error:t,status:{main:Gt(n.options.labelFileProcessingRevertError)(t),sub:n.options.labelTapToRetry}})})),_.on("process-complete",(function(t){e("DID_COMPLETE_ITEM_PROCESSING",{id:y,error:null,serverFileReference:t}),e("DID_DEFINE_VALUE",{id:y,value:t})})),_.on("process-abort",(function(){e("DID_ABORT_ITEM_PROCESSING",{id:y})})),_.on("process-revert",(function(){e("DID_REVERT_ITEM_PROCESSING",{id:y}),e("DID_DEFINE_VALUE",{id:y,value:null})})),e("DID_ADD_ITEM",{id:y,index:s,interactionMethod:l}),Nt(e,n);var T=n.options.server||{},w=T.url,A=T.load,O=T.restore,R=T.fetch;_.load(o,ct(v===Re.INPUT?B(o)&&function(e){return(e.indexOf(":")>-1||e.indexOf("//")>-1)&&xt(location.href)!==xt(e)}(o)&&R?Et(w,R):Dt:Et(w,v===Re.LIMBO?O:A)),(function(e,n,i){Pe("LOAD_FILE",e,{query:t}).then(n).catch(i)}))}},REQUEST_PREPARE_OUTPUT:function(e){var n=e.item,i=e.success,r=e.failure,o=void 0===r?function(){}:r,a={error:pt("error",0,"Item not found"),file:null};if(n.archived)return o(a);Pe("PREPARE_OUTPUT",n.file,{query:t,item:n}).then((function(e){Pe("COMPLETE_PREPARE_OUTPUT",e,{query:t,item:n}).then((function(e){if(n.archived)return o(a);i(e)}))}))},COMPLETE_LOAD_ITEM:function(i){var r=i.item,o=i.data,a=o.success,s=o.source,l=t("GET_ITEM_INSERT_LOCATION");if(Y(l)&&s&&kt(n,l),e("DID_LOAD_ITEM",{id:r.id,error:null,serverFileReference:r.origin===Re.INPUT?null:s}),a(we(r)),r.origin!==Re.LOCAL)return r.origin===Re.LIMBO?(e("DID_COMPLETE_ITEM_PROCESSING",{id:r.id,error:null,serverFileReference:s}),void e("DID_DEFINE_VALUE",{id:r.id,value:r.serverId||s})):void(t("IS_ASYNC")&&n.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:r.id}));e("DID_LOAD_LOCAL_ITEM",{id:r.id})},RETRY_ITEM_LOAD:Vt(n,(function(e){e.retryLoad()})),REQUEST_ITEM_PREPARE:Vt(n,(function(t,n,i){e("REQUEST_PREPARE_OUTPUT",{query:t.id,item:t,success:function(i){e("DID_PREPARE_OUTPUT",{id:t.id,file:i}),n({file:t,output:i})},failure:i},!0)})),REQUEST_ITEM_PROCESSING:Vt(n,(function(i,r,o){if(i.status===Oe.IDLE||i.status===Oe.PROCESSING_ERROR)i.status!==Oe.PROCESSING_QUEUED&&(i.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:i.id}),e("PROCESS_ITEM",{query:i,success:r,failure:o},!0));else{var a=function(){return e("REQUEST_ITEM_PROCESSING",{query:i,success:r,failure:o})},s=function(){return document.hidden?a():setTimeout(a,32)};i.status===Oe.PROCESSING_COMPLETE||i.status===Oe.PROCESSING_REVERT_ERROR?i.revert(Ot(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(s).catch((function(){})):i.status===Oe.PROCESSING&&i.abortProcessing().then(s)}})),PROCESS_ITEM:Vt(n,(function(i,r,o){var a=t("GET_MAX_PARALLEL_UPLOADS");if(t("GET_ITEMS_BY_STATUS",Oe.PROCESSING).length!==a){if(i.status!==Oe.PROCESSING){var s=function t(){var i=n.processingQueue.shift();if(i){var r=i.id,o=i.success,a=i.failure,s=Ne(n.items,r);s&&!s.archived?e("PROCESS_ITEM",{query:r,success:o,failure:a},!0):t()}};i.onOnce("process-complete",(function(){r(we(i)),s();var o=n.options.server;if(n.options.instantUpload&&i.origin===Re.LOCAL&&Y(o.remove)){var a=function(){};i.origin=Re.LIMBO,n.options.server.remove(i.source,a,a)}t("GET_ITEMS_BY_STATUS",Oe.PROCESSING_COMPLETE).length===n.items.length&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")})),i.onOnce("process-error",(function(e){o({error:e,file:we(i)}),s()}));var l=n.options;i.process(St(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return"function"==typeof t?function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(void 0,[n].concat(r,[i]))}:t&&B(t.url)?At(e,t,n,i):null}(l.server.url,l.server.process,l.name,{chunkTransferId:i.transferId,chunkServer:l.server.patch,chunkUploads:l.chunkUploads,chunkForce:l.chunkForce,chunkSize:l.chunkSize,chunkRetryDelays:l.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(function(n,r,o){Pe("PREPARE_OUTPUT",n,{query:t,item:i}).then((function(t){e("DID_PREPARE_OUTPUT",{id:i.id,file:t}),r(t)})).catch(o)}))}}else n.processingQueue.push({id:i.id,success:r,failure:o})})),RETRY_ITEM_PROCESSING:Vt(n,(function(t){e("REQUEST_ITEM_PROCESSING",{query:t})})),REQUEST_REMOVE_ITEM:Vt(n,(function(n){Ft(t("GET_BEFORE_REMOVE_FILE"),we(n)).then((function(t){t&&e("REMOVE_ITEM",{query:n})}))})),RELEASE_ITEM:Vt(n,(function(e){e.release()})),REMOVE_ITEM:Vt(n,(function(i,r,o,a){var s=function(){var t=i.id;Lt(n.items,t).archive(),e("DID_REMOVE_ITEM",{error:null,id:t,item:i}),Nt(e,n),r(we(i))},l=n.options.server;i.origin===Re.LOCAL&&l&&Y(l.remove)&&!1!==a.remove?(e("DID_START_ITEM_REMOVE",{id:i.id}),l.remove(i.source,(function(){return s()}),(function(t){e("DID_THROW_ITEM_REMOVE_ERROR",{id:i.id,error:pt("error",0,t,null),status:{main:Gt(n.options.labelFileRemoveError)(t),sub:n.options.labelTapToRetry}})}))):((a.revert&&i.origin!==Re.LOCAL&&null!==i.serverId||n.options.chunkUploads&&i.file.size>n.options.chunkSize||n.options.chunkUploads&&n.options.chunkForce)&&i.revert(Ot(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")),s())})),ABORT_ITEM_LOAD:Vt(n,(function(e){e.abortLoad()})),ABORT_ITEM_PROCESSING:Vt(n,(function(t){t.serverId?e("REVERT_ITEM_PROCESSING",{id:t.id}):t.abortProcessing().then((function(){n.options.instantUpload&&e("REMOVE_ITEM",{query:t.id})}))})),REQUEST_REVERT_ITEM_PROCESSING:Vt(n,(function(i){if(n.options.instantUpload){var r=function(t){t&&e("REVERT_ITEM_PROCESSING",{query:i})},o=t("GET_BEFORE_REMOVE_FILE");if(!o)return r(!0);var a=o(we(i));return null==a?r(!0):"boolean"==typeof a?r(a):void("function"==typeof a.then&&a.then(r))}e("REVERT_ITEM_PROCESSING",{query:i})})),REVERT_ITEM_PROCESSING:Vt(n,(function(i){i.revert(Ot(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then((function(){var t=n.options.instantUpload||function(e){return!Ct(e.file)}(i);t&&e("REMOVE_ITEM",{query:i.id})})).catch((function(){}))})),SET_OPTIONS:function(t){var n=t.options,i=Object.keys(n),r=Bt.filter((function(e){return i.includes(e)}));[].concat(ge(r),ge(Object.keys(n).filter((function(e){return!r.includes(e)})))).forEach((function(t){e("SET_"+ne(t,"_").toUpperCase(),{value:n[t]})}))}}},Bt=["server"],qt=function(e){return document.createElement(e)},zt=function(e,t){var n=e.childNodes[0];n?t!==n.nodeValue&&(n.nodeValue=t):(n=document.createTextNode(t),e.appendChild(n))},jt=function(e,t,n,i){var r=(i%360-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}},Wt=function(e,t,n,i,r){var o=1;return r>i&&r-i<=.5&&(o=0),i>r&&i-r>=.5&&(o=0),function(e,t,n,i,r,o){var a=jt(e,t,n,r),s=jt(e,t,n,i);return["M",a.x,a.y,"A",n,n,0,o,0,s.x,s.y].join(" ")}(e,t,n,360*Math.min(.9999,i),360*Math.min(.9999,r),o)},Ht=P({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:function(e){var t=e.root,n=e.props;n.spin=!1,n.progress=0,n.opacity=0;var i=u("svg");t.ref.path=u("path",{"stroke-width":2,"stroke-linecap":"round"}),i.appendChild(t.ref.path),t.ref.svg=i,t.appendChild(i)},write:function(e){var t=e.root,n=e.props;if(0!==n.opacity){n.align&&(t.element.dataset.align=n.align);var i=parseInt(o(t.ref.path,"stroke-width"),10),r=.5*t.rect.element.width,a=0,s=0;n.spin?(a=0,s=.5):(a=0,s=n.progress);var l=Wt(r,r,r-i,a,s);o(t.ref.path,"d",l),o(t.ref.path,"stroke-opacity",n.spin||n.progress>0?1:0)}},mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),Yt=P({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:function(e){var t=e.root,n=e.props;t.element.innerHTML=(n.icon||"")+"<span>"+n.label+"</span>",n.isDisabled=!1},write:function(e){var t=e.root,n=e.props,i=n.isDisabled,r=t.query("GET_DISABLED")||0===n.opacity;r&&!i?(n.isDisabled=!0,o(t.element,"disabled","disabled")):!r&&i&&(n.isDisabled=!1,t.element.removeAttribute("disabled"))}}),Xt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i.labelBytes,o=void 0===r?"bytes":r,a=i.labelKilobytes,s=void 0===a?"KB":a,l=i.labelMegabytes,u=void 0===l?"MB":l,c=i.labelGigabytes,d=void 0===c?"GB":c,f=n,p=n*n,h=n*n*n;return(e=Math.round(Math.abs(e)))<f?e+" "+o:e<p?Math.floor(e/f)+" "+s:e<h?Zt(e/p,1,t)+" "+u:Zt(e/h,2,t)+" "+d},Zt=function(e,t,n){return e.toFixed(t).split(".").filter((function(e){return"0"!==e})).join(n)},Qt=function(e){var t=e.root,n=e.props;zt(t.ref.fileSize,Xt(t.query("GET_ITEM_SIZE",n.id),".",t.query("GET_FILE_SIZE_BASE"),t.query("GET_FILE_SIZE_LABELS",t.query))),zt(t.ref.fileName,t.query("GET_ITEM_NAME",n.id))},Kt=function(e){var t=e.root,n=e.props;W(t.query("GET_ITEM_SIZE",n.id))?Qt({root:t,props:n}):zt(t.ref.fileSize,t.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},Jt=P({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:L({DID_LOAD_ITEM:Qt,DID_UPDATE_ITEM_META:Qt,DID_THROW_ITEM_LOAD_ERROR:Kt,DID_THROW_ITEM_INVALID:Kt}),didCreateView:function(e){Le("CREATE_VIEW",Object.assign({},e,{view:e}))},create:function(e){var t=e.root,n=e.props,i=qt("span");i.className="filepond--file-info-main",o(i,"aria-hidden","true"),t.appendChild(i),t.ref.fileName=i;var r=qt("span");r.className="filepond--file-info-sub",t.appendChild(r),t.ref.fileSize=r,zt(r,t.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),zt(i,t.query("GET_ITEM_NAME",n.id))},mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),$t=function(e){return Math.round(100*e)},en=function(e){var t=e.root,n=e.action,i=null===n.progress?t.query("GET_LABEL_FILE_LOADING"):t.query("GET_LABEL_FILE_LOADING")+" "+$t(n.progress)+"%";zt(t.ref.main,i),zt(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},tn=function(e){var t=e.root;zt(t.ref.main,""),zt(t.ref.sub,"")},nn=function(e){var t=e.root,n=e.action;zt(t.ref.main,n.status.main),zt(t.ref.sub,n.status.sub)},rn=P({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:L({DID_LOAD_ITEM:tn,DID_REVERT_ITEM_PROCESSING:tn,DID_REQUEST_ITEM_PROCESSING:function(e){var t=e.root;zt(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING")),zt(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},DID_ABORT_ITEM_PROCESSING:function(e){var t=e.root;zt(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_ABORTED")),zt(t.ref.sub,t.query("GET_LABEL_TAP_TO_RETRY"))},DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root;zt(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),zt(t.ref.sub,t.query("GET_LABEL_TAP_TO_UNDO"))},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var t=e.root,n=e.action,i=null===n.progress?t.query("GET_LABEL_FILE_PROCESSING"):t.query("GET_LABEL_FILE_PROCESSING")+" "+$t(n.progress)+"%";zt(t.ref.main,i),zt(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},DID_UPDATE_ITEM_LOAD_PROGRESS:en,DID_THROW_ITEM_LOAD_ERROR:nn,DID_THROW_ITEM_INVALID:nn,DID_THROW_ITEM_PROCESSING_ERROR:nn,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:nn,DID_THROW_ITEM_REMOVE_ERROR:nn}),didCreateView:function(e){Le("CREATE_VIEW",Object.assign({},e,{view:e}))},create:function(e){var t=e.root,n=qt("span");n.className="filepond--file-status-main",t.appendChild(n),t.ref.main=n;var i=qt("span");i.className="filepond--file-status-sub",t.appendChild(i),t.ref.sub=i,en({root:t,action:{progress:null}})},mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),on={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},an=[];i(on,(function(e){an.push(e)}));var sn,ln=function(e){if("right"===fn(e))return 0;var t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},un=function(e){return e.ref.buttonAbortItemLoad.rect.element.width},cn=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.height/4)},dn=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.left/2)},fn=function(e){return e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION")},pn={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:function(e){return e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}},processProgressIndicator:{opacity:0,align:function(e){return e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},hn={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ln},status:{translateX:ln}},gn={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},mn={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:ln},status:{translateX:ln,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:ln},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:fn},info:{translateX:ln},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:fn},buttonRemoveItem:{opacity:1},info:{translateX:ln},status:{opacity:1,translateX:ln}},DID_LOAD_ITEM:hn,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:ln},status:{translateX:ln}},DID_START_ITEM_PROCESSING:gn,DID_REQUEST_ITEM_PROCESSING:gn,DID_UPDATE_ITEM_PROCESS_PROGRESS:gn,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:ln}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ln},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:hn},En=P({create:function(e){var t=e.root;t.element.innerHTML=t.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),vn=L({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function(e){var t=e.root,n=e.action;t.ref.buttonAbortItemProcessing.label=n.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function(e){var t=e.root,n=e.action;t.ref.buttonAbortItemLoad.label=n.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function(e){var t=e.root,n=e.action;t.ref.buttonAbortItemRemoval.label=n.value},DID_REQUEST_ITEM_PROCESSING:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:function(e){var t=e.root;t.ref.loadProgressIndicator.spin=!0,t.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:function(e){var t=e.root,n=e.action;t.ref.loadProgressIndicator.spin=!1,t.ref.loadProgressIndicator.progress=n.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var t=e.root,n=e.action;t.ref.processProgressIndicator.spin=!1,t.ref.processProgressIndicator.progress=n.progress}}),_n=P({create:function(e){var t,n=e.root,r=e.props,o=Object.keys(on).reduce((function(e,t){return e[t]=Object.assign({},on[t]),e}),{}),a=r.id,s=n.query("GET_ALLOW_REVERT"),l=n.query("GET_ALLOW_REMOVE"),u=n.query("GET_ALLOW_PROCESS"),c=n.query("GET_INSTANT_UPLOAD"),d=n.query("IS_ASYNC"),f=n.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");d?u&&!s?t=function(e){return!/RevertItemProcessing/.test(e)}:!u&&s?t=function(e){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(e)}:u||s||(t=function(e){return!/Process/.test(e)}):t=function(e){return!/Process/.test(e)};var p=t?an.filter(t):an.concat();if(c&&s&&(o.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",o.RevertItemProcessing.icon="GET_ICON_REMOVE"),d&&!s){var h=mn.DID_COMPLETE_ITEM_PROCESSING;h.info.translateX=dn,h.info.translateY=cn,h.status.translateY=cn,h.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(d&&!u&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach((function(e){mn[e].status.translateY=cn})),mn.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=un),f&&s){o.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";var g=mn.DID_COMPLETE_ITEM_PROCESSING;g.info.translateX=ln,g.status.translateY=cn,g.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}l||(o.RemoveItem.disabled=!0),i(o,(function(e,t){var i=n.createChildView(Yt,{label:n.query(t.label),icon:n.query(t.icon),opacity:0});p.includes(e)&&n.appendChildView(i),t.disabled&&(i.element.setAttribute("disabled","disabled"),i.element.setAttribute("hidden","hidden")),i.element.dataset.align=n.query("GET_STYLE_"+t.align),i.element.classList.add(t.className),i.on("click",(function(e){e.stopPropagation(),t.disabled||n.dispatch(t.action,{query:a})})),n.ref["button"+e]=i})),n.ref.processingCompleteIndicator=n.appendChildView(n.createChildView(En)),n.ref.processingCompleteIndicator.element.dataset.align=n.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),n.ref.info=n.appendChildView(n.createChildView(Jt,{id:a})),n.ref.status=n.appendChildView(n.createChildView(rn,{id:a}));var m=n.appendChildView(n.createChildView(Ht,{opacity:0,align:n.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));m.element.classList.add("filepond--load-indicator"),n.ref.loadProgressIndicator=m;var E=n.appendChildView(n.createChildView(Ht,{opacity:0,align:n.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));E.element.classList.add("filepond--process-indicator"),n.ref.processProgressIndicator=E,n.ref.activeStyles=[]},write:function(e){var t=e.root,n=e.actions,r=e.props;vn({root:t,actions:n,props:r});var o=n.concat().filter((function(e){return/^DID_/.test(e.type)})).reverse().find((function(e){return mn[e.type]}));if(o){t.ref.activeStyles=[];var a=mn[o.type];i(pn,(function(e,n){var r=t.ref[e];i(n,(function(n,i){var o=a[e]&&void 0!==a[e][n]?a[e][n]:i;t.ref.activeStyles.push({control:r,key:n,value:o})}))}))}t.ref.activeStyles.forEach((function(e){var n=e.control,i=e.key,r=e.value;n[i]="function"==typeof r?r(t):r}))},didCreateView:function(e){Le("CREATE_VIEW",Object.assign({},e,{view:e}))},name:"file"}),In=P({create:function(e){var t=e.root,n=e.props;t.ref.fileName=qt("legend"),t.appendChild(t.ref.fileName),t.ref.file=t.appendChildView(t.createChildView(_n,{id:n.id})),t.ref.data=!1},ignoreRect:!0,write:L({DID_LOAD_ITEM:function(e){var t=e.root,n=e.props;zt(t.ref.fileName,t.query("GET_ITEM_NAME",n.id))}}),didCreateView:function(e){Le("CREATE_VIEW",Object.assign({},e,{view:e}))},tag:"fieldset",name:"file-wrapper"}),yn={type:"spring",damping:.6,mass:7},Tn=function(e,t,n){var i=P({name:"panel-"+t.name+" filepond--"+n,mixins:t.mixins,ignoreRectUpdate:!0}),r=e.createChildView(i,t.props);e.ref[t.name]=e.appendChildView(r)},wn=P({name:"panel",read:function(e){var t=e.root;return e.props.heightCurrent=t.ref.bottom.translateY},write:function(e){var t=e.root,n=e.props;if(null!==t.ref.scalable&&n.scalable===t.ref.scalable||(t.ref.scalable=!V(n.scalable)||n.scalable,t.element.dataset.scalable=t.ref.scalable),n.height){var i=t.ref.top.rect.element,r=t.ref.bottom.rect.element,o=Math.max(i.height+r.height,n.height);t.ref.center.translateY=i.height,t.ref.center.scaleY=(o-i.height-r.height)/100,t.ref.bottom.translateY=o-r.height}},create:function(e){var t=e.root,n=e.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:yn},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:yn},styles:["translateY"]}}].forEach((function(e){Tn(t,e,n.name)})),t.element.classList.add("filepond--"+n.name),t.ref.scalable=null},ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),An={type:"spring",stiffness:.75,damping:.45,mass:10},On="spring",Rn={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},Sn=L({DID_UPDATE_PANEL_HEIGHT:function(e){var t=e.root,n=e.action;t.height=n.height}}),bn=L({DID_GRAB_ITEM:function(e){var t=e.root;e.props.dragOrigin={x:t.translateX,y:t.translateY}},DID_DRAG_ITEM:function(e){e.root.element.dataset.dragState="drag"},DID_DROP_ITEM:function(e){var t=e.root,n=e.props;n.dragOffset=null,n.dragOrigin=null,t.element.dataset.dragState="drop"}},(function(e){var t=e.root,n=e.actions,i=e.props,r=e.shouldOptimize;"drop"===t.element.dataset.dragState&&t.scaleX<=1&&(t.element.dataset.dragState="idle");var o=n.concat().filter((function(e){return/^DID_/.test(e.type)})).reverse().find((function(e){return Rn[e.type]}));o&&o.type!==i.currentState&&(i.currentState=o.type,t.element.dataset.filepondItemState=Rn[i.currentState]||"");var a=t.query("GET_ITEM_PANEL_ASPECT_RATIO")||t.query("GET_PANEL_ASPECT_RATIO");a?r||(t.height=t.rect.element.width*a):(Sn({root:t,actions:n,props:i}),!t.height&&t.ref.container.rect.element.height>0&&(t.height=t.ref.container.rect.element.height)),r&&(t.ref.panel.height=null),t.ref.panel.height=t.height})),Mn=P({create:function(e){var t=e.root,n=e.props;if(t.ref.handleClick=function(e){return t.dispatch("DID_ACTIVATE_ITEM",{id:n.id})},t.element.id="filepond--item-"+n.id,t.element.addEventListener("click",t.ref.handleClick),t.ref.container=t.appendChildView(t.createChildView(In,{id:n.id})),t.ref.panel=t.appendChildView(t.createChildView(wn,{name:"item-panel"})),t.ref.panel.height=null,n.markedForRemoval=!1,t.query("GET_ALLOW_REORDER")){t.element.dataset.dragState="idle";t.element.addEventListener("pointerdown",(function(e){if(e.isPrimary){var i=!1,r=e.pageX,o=e.pageY;n.dragOrigin={x:t.translateX,y:t.translateY},n.dragCenter={x:e.offsetX,y:e.offsetY};var a,s,l,u=(a=t.query("GET_ACTIVE_ITEMS"),s=a.map((function(e){return e.id})),l=void 0,{setIndex:function(e){l=e},getIndex:function(){return l},getItemIndex:function(e){return s.indexOf(e.id)}});t.dispatch("DID_GRAB_ITEM",{id:n.id,dragState:u});var c=function(e){e.isPrimary&&(e.stopPropagation(),e.preventDefault(),n.dragOffset={x:e.pageX-r,y:e.pageY-o},n.dragOffset.x*n.dragOffset.x+n.dragOffset.y*n.dragOffset.y>16&&!i&&(i=!0,t.element.removeEventListener("click",t.ref.handleClick)),t.dispatch("DID_DRAG_ITEM",{id:n.id,dragState:u}))};document.addEventListener("pointermove",c),document.addEventListener("pointerup",(function e(a){a.isPrimary&&(document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",e),n.dragOffset={x:a.pageX-r,y:a.pageY-o},t.dispatch("DID_DROP_ITEM",{id:n.id,dragState:u}),i&&setTimeout((function(){return t.element.addEventListener("click",t.ref.handleClick)}),0))}))}}))}},write:bn,destroy:function(e){var t=e.root,n=e.props;t.element.removeEventListener("click",t.ref.handleClick),t.dispatch("RELEASE_ITEM",{query:n.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:On,scaleY:On,translateX:An,translateY:An,opacity:{type:"tween",duration:150}}}}),Cn=function(e,t){return Math.max(1,Math.floor((e+1)/t))},Pn=function(e,t,n){if(n){var i=e.rect.element.width,r=t.length,o=null;if(0===r||n.top<t[0].rect.element.top)return-1;var a=t[0].rect.element,s=a.marginLeft+a.marginRight,l=a.width+s,u=Cn(i,l);if(1===u){for(var c=0;c<r;c++){var d=t[c],f=d.rect.outer.top+.5*d.rect.element.height;if(n.top<f)return c}return r}for(var p=a.marginTop+a.marginBottom,h=a.height+p,g=0;g<r;g++){var m=g%u*l,E=Math.floor(g/u)*h,v=E-a.marginTop,_=m+l,I=E+h+a.marginBottom;if(n.top<I&&n.top>v){if(n.left<_)return g;o=g!==r-1?g:null}}return null!==o?o:r}},Ln={height:0,width:0,get getHeight(){return this.height},set setHeight(e){0!==this.height&&0!==e||(this.height=e)},get getWidth(){return this.width},set setWidth(e){0!==this.width&&0!==e||(this.width=e)},setDimensions:function(e,t){0!==this.height&&0!==e||(this.height=e),0!==this.width&&0!==t||(this.width=t)}},Dn=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=n,Date.now()>e.spawnDate&&(0===e.opacity&&xn(e,t,n,i,r),e.scaleX=1,e.scaleY=1,e.opacity=1))},xn=function(e,t,n,i,r){e.interactionMethod===ce?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=n):e.interactionMethod===se?(e.translateX=null,e.translateX=t-20*i,e.translateY=null,e.translateY=n-10*r,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===le?(e.translateY=null,e.translateY=n-30):e.interactionMethod===ae&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},Gn=function(e){return e.rect.element.height+.5*e.rect.element.marginBottom+.5*e.rect.element.marginTop},Nn=L({DID_ADD_ITEM:function(e){var t=e.root,n=e.action,i=n.id,r=n.index,o=n.interactionMethod;t.ref.addIndex=r;var a=Date.now(),s=a,l=1;if(o!==ce){l=0;var u=t.query("GET_ITEM_INSERT_INTERVAL"),c=a-t.ref.lastItemSpanwDate;s=c<u?a+(u-c):a}t.ref.lastItemSpanwDate=s,t.appendChildView(t.createChildView(Mn,{spawnDate:s,id:i,opacity:l,interactionMethod:o}),r)},DID_REMOVE_ITEM:function(e){var t=e.root,n=e.action.id,i=t.childViews.find((function(e){return e.id===n}));i&&(i.scaleX=.9,i.scaleY=.9,i.opacity=0,i.markedForRemoval=!0)},DID_DRAG_ITEM:function(e){var t=e.root,n=e.action,i=n.id,r=n.dragState,o=t.query("GET_ITEM",{id:i}),a=t.childViews.find((function(e){return e.id===i})),s=t.childViews.length,l=r.getItemIndex(o);if(a){var u,c=a.dragOrigin.x+a.dragOffset.x+a.dragCenter.x,d=a.dragOrigin.y+a.dragOffset.y+a.dragCenter.y,f=Gn(a),p=(u=a).rect.element.width+.5*u.rect.element.marginLeft+.5*u.rect.element.marginRight,h=Math.floor(t.rect.outer.width/p);h>s&&(h=s);var g=Math.floor(s/h+1);Ln.setHeight=f*g,Ln.setWidth=p*h;var m={y:Math.floor(d/f),x:Math.floor(c/p),getGridIndex:function(){return d>Ln.getHeight||d<0||c>Ln.getWidth||c<0?l:this.y*h+this.x},getColIndex:function(){for(var e=t.query("GET_ACTIVE_ITEMS"),n=t.childViews.filter((function(e){return e.rect.element.height})),i=e.map((function(e){return n.find((function(t){return t.id===e.id}))})),r=i.findIndex((function(e){return e===a})),o=Gn(a),s=i.length,l=s,u=0,c=0,f=0,p=0;p<s;p++)if(u=Gn(i[p]),d<(c=(f=c)+u)){if(r>p){if(d<f+o){l=p;break}continue}l=p;break}return l}},E=h>1?m.getGridIndex():m.getColIndex();t.dispatch("MOVE_ITEM",{query:a,index:E});var v=r.getIndex();if(void 0===v||v!==E){if(r.setIndex(E),void 0===v)return;t.dispatch("DID_REORDER_ITEMS",{items:t.query("GET_ACTIVE_ITEMS"),origin:l,target:E})}}}}),Fn=P({create:function(e){var t=e.root;o(t.element,"role","list"),t.ref.lastItemSpanwDate=Date.now()},write:function(e){var t=e.root,n=e.props,i=e.actions,r=e.shouldOptimize;Nn({root:t,props:n,actions:i});var o=n.dragCoordinates,a=t.rect.element.width,s=t.childViews.filter((function(e){return e.rect.element.height})),l=t.query("GET_ACTIVE_ITEMS").map((function(e){return s.find((function(t){return t.id===e.id}))})).filter((function(e){return e})),u=o?Pn(t,l,o):null,c=t.ref.addIndex||null;t.ref.addIndex=null;var d=0,f=0,p=0;if(0!==l.length){var h=l[0].rect.element,g=h.marginTop+h.marginBottom,m=h.marginLeft+h.marginRight,E=h.width+m,v=h.height+g,_=Cn(a,E);if(1===_){var I=0,y=0;l.forEach((function(e,t){if(u){var n=t-u;y=-2===n?.25*-g:-1===n?.75*-g:0===n?.75*g:1===n?.25*g:0}r&&(e.translateX=null,e.translateY=null),e.markedForRemoval||Dn(e,0,I+y);var i=(e.rect.element.height+g)*(e.markedForRemoval?e.opacity:1);I+=i}))}else{var T=0,w=0;l.forEach((function(e,t){t===u&&(d=1),t===c&&(p+=1),e.markedForRemoval&&e.opacity<.5&&(f-=1);var n=t+p+d+f,i=n%_,o=Math.floor(n/_),a=i*E,s=o*v,l=Math.sign(a-T),h=Math.sign(s-w);T=a,w=s,e.markedForRemoval||(r&&(e.translateX=null,e.translateY=null),Dn(e,a,s,l,h))}))}}},tag:"ul",name:"list",didWriteView:function(e){var t=e.root;t.childViews.filter((function(e){return e.markedForRemoval&&0===e.opacity&&e.resting})).forEach((function(e){e._destroy(),t.removeChildView(e)}))},filterFrameActionsForChild:function(e,t){return t.filter((function(t){return!t.data||!t.data.id||e.id===t.data.id}))},mixins:{apis:["dragCoordinates"]}}),kn=L({DID_DRAG:function(e){var t=e.root,n=e.props,i=e.action;t.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(n.dragCoordinates={left:i.position.scopeLeft-t.ref.list.rect.element.left,top:i.position.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},DID_END_DRAG:function(e){e.props.dragCoordinates=null}}),Vn=P({create:function(e){var t=e.root,n=e.props;t.ref.list=t.appendChildView(t.createChildView(Fn)),n.dragCoordinates=null,n.overflowing=!1},write:function(e){var t=e.root,n=e.props,i=e.actions;if(kn({root:t,props:n,actions:i}),t.ref.list.dragCoordinates=n.dragCoordinates,n.overflowing&&!n.overflow&&(n.overflowing=!1,t.element.dataset.state="",t.height=null),n.overflow){var r=Math.round(n.overflow);r!==t.height&&(n.overflowing=!0,t.element.dataset.state="overflow",t.height=r)}},name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),Un=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";n?o(e,t,i):e.removeAttribute(t)},Bn=function(e){var t=e.root,n=e.action;t.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&Un(t.element,"accept",!!n.value,n.value?n.value.join(","):"")},qn=function(e){var t=e.root,n=e.action;Un(t.element,"multiple",n.value)},zn=function(e){var t=e.root,n=e.action;Un(t.element,"webkitdirectory",n.value)},jn=function(e){var t=e.root,n=t.query("GET_DISABLED"),i=t.query("GET_ALLOW_BROWSE"),r=n||!i;Un(t.element,"disabled",r)},Wn=function(e){var t=e.root;e.action.value?0===t.query("GET_TOTAL_ITEMS")&&Un(t.element,"required",!0):Un(t.element,"required",!1)},Hn=function(e){var t=e.root,n=e.action;Un(t.element,"capture",!!n.value,!0===n.value?"":n.value)},Yn=function(e){var t=e.root,n=t.element;t.query("GET_TOTAL_ITEMS")>0?(Un(n,"required",!1),Un(n,"name",!1)):(Un(n,"name",!0,t.query("GET_NAME")),t.query("GET_CHECK_VALIDITY")&&n.setCustomValidity(""),t.query("GET_REQUIRED")&&Un(n,"required",!0))},Xn=P({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:function(e){var t=e.root,n=e.props;t.element.id="filepond--browser-"+n.id,o(t.element,"name",t.query("GET_NAME")),o(t.element,"aria-controls","filepond--assistant-"+n.id),o(t.element,"aria-labelledby","filepond--drop-label-"+n.id),Bn({root:t,action:{value:t.query("GET_ACCEPTED_FILE_TYPES")}}),qn({root:t,action:{value:t.query("GET_ALLOW_MULTIPLE")}}),zn({root:t,action:{value:t.query("GET_ALLOW_DIRECTORIES_ONLY")}}),jn({root:t}),Wn({root:t,action:{value:t.query("GET_REQUIRED")}}),Hn({root:t,action:{value:t.query("GET_CAPTURE_METHOD")}}),t.ref.handleChange=function(e){if(t.element.value){var i=Array.from(t.element.files).map((function(e){return e._relativePath=e.webkitRelativePath,e}));setTimeout((function(){n.onload(i),function(e){if(e&&""!==e.value){try{e.value=""}catch(e){}if(e.value){var t=qt("form"),n=e.parentNode,i=e.nextSibling;t.appendChild(e),t.reset(),i?n.insertBefore(e,i):n.appendChild(e)}}}(t.element)}),250)}},t.element.addEventListener("change",t.ref.handleChange)},destroy:function(e){var t=e.root;t.element.removeEventListener("change",t.ref.handleChange)},write:L({DID_LOAD_ITEM:Yn,DID_REMOVE_ITEM:Yn,DID_THROW_ITEM_INVALID:function(e){var t=e.root;t.query("GET_CHECK_VALIDITY")&&t.element.setCustomValidity(t.query("GET_LABEL_INVALID_FIELD"))},DID_SET_DISABLED:jn,DID_SET_ALLOW_BROWSE:jn,DID_SET_ALLOW_DIRECTORIES_ONLY:zn,DID_SET_ALLOW_MULTIPLE:qn,DID_SET_ACCEPTED_FILE_TYPES:Bn,DID_SET_CAPTURE_METHOD:Hn,DID_SET_REQUIRED:Wn})}),Zn=13,Qn=32,Kn=function(e,t){e.innerHTML=t;var n=e.querySelector(".filepond--label-action");return n&&o(n,"tabindex","0"),t},Jn=P({name:"drop-label",ignoreRect:!0,create:function(e){var t=e.root,n=e.props,i=qt("label");o(i,"for","filepond--browser-"+n.id),o(i,"id","filepond--drop-label-"+n.id),o(i,"aria-hidden","true"),t.ref.handleKeyDown=function(e){(e.keyCode===Zn||e.keyCode===Qn)&&(e.preventDefault(),t.ref.label.click())},t.ref.handleClick=function(e){e.target===i||i.contains(e.target)||t.ref.label.click()},i.addEventListener("keydown",t.ref.handleKeyDown),t.element.addEventListener("click",t.ref.handleClick),Kn(i,n.caption),t.appendChild(i),t.ref.label=i},destroy:function(e){var t=e.root;t.ref.label.addEventListener("keydown",t.ref.handleKeyDown),t.element.removeEventListener("click",t.ref.handleClick)},write:L({DID_SET_LABEL_IDLE:function(e){var t=e.root,n=e.action;Kn(t.ref.label,n.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),$n=P({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),ei=L({DID_DRAG:function(e){var t=e.root,n=e.action;t.ref.blob?(t.ref.blob.translateX=n.position.scopeLeft,t.ref.blob.translateY=n.position.scopeTop,t.ref.blob.scaleX=1,t.ref.blob.scaleY=1,t.ref.blob.opacity=1):function(e){var t=e.root,n=.5*t.rect.element.width,i=.5*t.rect.element.height;t.ref.blob=t.appendChildView(t.createChildView($n,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:n,translateY:i}))}({root:t})},DID_DROP:function(e){var t=e.root;t.ref.blob&&(t.ref.blob.scaleX=2.5,t.ref.blob.scaleY=2.5,t.ref.blob.opacity=0)},DID_END_DRAG:function(e){var t=e.root;t.ref.blob&&(t.ref.blob.opacity=0)}}),ti=P({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:function(e){var t=e.root,n=e.props,i=e.actions;ei({root:t,props:n,actions:i});var r=t.ref.blob;0===i.length&&r&&0===r.opacity&&(t.removeChildView(r),t.ref.blob=null)}}),ni=function(e,t){try{var n=new DataTransfer;t.forEach((function(e){e instanceof File?n.items.add(e):n.items.add(new File([e],e.name,{type:e.type}))})),e.files=n.files}catch(e){return!1}return!0},ii=function(e,t){return e.ref.fields[t]},ri=function(e){e.query("GET_ACTIVE_ITEMS").forEach((function(t){e.ref.fields[t.id]&&e.element.appendChild(e.ref.fields[t.id])}))},oi=function(e){var t=e.root;return ri(t)},ai=L({DID_SET_DISABLED:function(e){var t=e.root;t.element.disabled=t.query("GET_DISABLED")},DID_ADD_ITEM:function(e){var t=e.root,n=e.action,i=!(t.query("GET_ITEM",n.id).origin===Re.LOCAL)&&t.query("SHOULD_UPDATE_FILE_INPUT"),r=qt("input");r.type=i?"file":"hidden",r.name=t.query("GET_NAME"),r.disabled=t.query("GET_DISABLED"),t.ref.fields[n.id]=r,ri(t)},DID_LOAD_ITEM:function(e){var t=e.root,n=e.action,i=ii(t,n.id);if(i&&(null!==n.serverFileReference&&(i.value=n.serverFileReference),t.query("SHOULD_UPDATE_FILE_INPUT"))){var r=t.query("GET_ITEM",n.id);ni(i,[r.file])}},DID_REMOVE_ITEM:function(e){var t=e.root,n=e.action,i=ii(t,n.id);i&&(i.parentNode&&i.parentNode.removeChild(i),delete t.ref.fields[n.id])},DID_DEFINE_VALUE:function(e){var t=e.root,n=e.action,i=ii(t,n.id);i&&(null===n.value?i.removeAttribute("value"):i.value=n.value,ri(t))},DID_PREPARE_OUTPUT:function(e){var t=e.root,n=e.action;t.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout((function(){var e=ii(t,n.id);e&&ni(e,[n.file])}),0)},DID_REORDER_ITEMS:oi,DID_SORT_ITEMS:oi}),si=P({tag:"fieldset",name:"data",create:function(e){return e.root.ref.fields={}},write:ai,ignoreRect:!0}),li=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ui=["css","csv","html","txt"],ci={zip:"zip|compressed",epub:"application/epub+zip"},di=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e=e.toLowerCase(),li.includes(e)?"image/"+("jpg"===e?"jpeg":"svg"===e?"svg+xml":e):ui.includes(e)?"text/"+e:ci[e]||""},fi=function(e){return new Promise((function(t,n){var i=Ti(e);if(i.length&&!pi(e))return t(i);hi(e).then(t)}))},pi=function(e){return!!e.files&&e.files.length>0},hi=function(e){return new Promise((function(t,n){var i=(e.items?Array.from(e.items):[]).filter((function(e){return gi(e)})).map((function(e){return mi(e)}));i.length?Promise.all(i).then((function(e){var n=[];e.forEach((function(e){n.push.apply(n,e)})),t(n.filter((function(e){return e})).map((function(e){return e._relativePath||(e._relativePath=e.webkitRelativePath),e})))})).catch(console.error):t(e.files?Array.from(e.files):[])}))},gi=function(e){if(Ii(e)){var t=yi(e);if(t)return t.isFile||t.isDirectory}return"file"===e.kind},mi=function(e){return new Promise((function(t,n){_i(e)?Ei(yi(e)).then(t).catch(n):t([e.getAsFile()])}))},Ei=function(e){return new Promise((function(t,n){var i=[],r=0,o=0,a=function(){0===o&&0===r&&t(i)};!function e(t){r++;var s=t.createReader();!function t(){s.readEntries((function(n){if(0===n.length)return r--,void a();n.forEach((function(t){t.isDirectory?e(t):(o++,t.file((function(e){var n=vi(e);t.fullPath&&(n._relativePath=t.fullPath),i.push(n),o--,a()})))})),t()}),n)}()}(e)}))},vi=function(e){if(e.type.length)return e;var t=e.lastModifiedDate,n=e.name,i=di(Je(e.name));return i.length?((e=e.slice(0,e.size,i)).name=n,e.lastModifiedDate=t,e):e},_i=function(e){return Ii(e)&&(yi(e)||{}).isDirectory},Ii=function(e){return"webkitGetAsEntry"in e},yi=function(e){return e.webkitGetAsEntry()},Ti=function(e){var t=[];try{if((t=Ai(e)).length)return t;t=wi(e)}catch(e){}return t},wi=function(e){var t=e.getData("url");return"string"==typeof t&&t.length?[t]:[]},Ai=function(e){var t=e.getData("text/html");if("string"==typeof t&&t.length){var n=t.match(/src\s*=\s*"(.+?)"/);if(n)return[n[1]]}return[]},Oi=[],Ri=function(e){return{pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}},Si=function(e){var t=Oi.find((function(t){return t.element===e}));if(t)return t;var n=bi(e);return Oi.push(n),n},bi=function(e){var t=[],n={dragenter:Li,dragover:Di,dragleave:Gi,drop:xi},r={};i(n,(function(n,i){r[n]=i(e,t),e.addEventListener(n,r[n],!1)}));var o={element:e,addListener:function(a){return t.push(a),function(){t.splice(t.indexOf(a),1),0===t.length&&(Oi.splice(Oi.indexOf(o),1),i(n,(function(t){e.removeEventListener(t,r[t],!1)})))}}};return o},Mi=function(e,t){var n,i=function(e,t){return"elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)}("getRootNode"in(n=t)?n.getRootNode():document,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return i===t||t.contains(i)},Ci=null,Pi=function(e,t){try{e.dropEffect=t}catch(e){}},Li=function(e,t){return function(e){e.preventDefault(),Ci=e.target,t.forEach((function(t){var n=t.element,i=t.onenter;Mi(e,n)&&(t.state="enter",i(Ri(e)))}))}},Di=function(e,t){return function(e){e.preventDefault();var n=e.dataTransfer;fi(n).then((function(i){var r=!1;t.some((function(t){var o=t.filterElement,a=t.element,s=t.onenter,l=t.onexit,u=t.ondrag,c=t.allowdrop;Pi(n,"copy");var d=c(i);if(d)if(Mi(e,a)){if(r=!0,null===t.state)return t.state="enter",void s(Ri(e));if(t.state="over",o&&!d)return void Pi(n,"none");u(Ri(e))}else o&&!r&&Pi(n,"none"),t.state&&(t.state=null,l(Ri(e)));else Pi(n,"none")}))}))}},xi=function(e,t){return function(e){e.preventDefault();var n=e.dataTransfer;fi(n).then((function(n){t.forEach((function(t){var i=t.filterElement,r=t.element,o=t.ondrop,a=t.onexit,s=t.allowdrop;if(t.state=null,!i||Mi(e,r))return s(n)?void o(Ri(e),n):a(Ri(e))}))}))}},Gi=function(e,t){return function(e){Ci===e.target&&t.forEach((function(t){var n=t.onexit;t.state=null,n(Ri(e))}))}},Ni=function(e,t,n){e.classList.add("filepond--hopper");var i=n.catchesDropsOnPage,r=n.requiresDropOnElement,o=n.filterItems,a=void 0===o?function(e){return e}:o,s=function(e,t,n){var i=Si(t),r={element:e,filterElement:n,state:null,ondrop:function(){},onenter:function(){},ondrag:function(){},onexit:function(){},onload:function(){},allowdrop:function(){}};return r.destroy=i.addListener(r),r}(e,i?document.documentElement:e,r),l="",u="";s.allowdrop=function(e){return t(a(e))},s.ondrop=function(e,n){var i=a(n);t(i)?(u="drag-drop",c.onload(i,e)):c.ondragend(e)},s.ondrag=function(e){c.ondrag(e)},s.onenter=function(e){u="drag-over",c.ondragstart(e)},s.onexit=function(e){u="drag-exit",c.ondragend(e)};var c={updateHopperState:function(){l!==u&&(e.dataset.hopperState=u,l=u)},onload:function(){},ondragstart:function(){},ondrag:function(){},ondragend:function(){},destroy:function(){s.destroy()}};return c},Fi=!1,ki=[],Vi=function(e){var t=document.activeElement;if(t&&/textarea|input/i.test(t.nodeName)){for(var n=!1,i=t;i!==document.body;){if(i.classList.contains("filepond--root")){n=!0;break}i=i.parentNode}if(!n)return}fi(e.clipboardData).then((function(e){e.length&&ki.forEach((function(t){return t(e)}))}))},Ui=function(){var e=function(e){t.onload(e)},t={destroy:function(){var t;t=e,_e(ki,ki.indexOf(t)),0===ki.length&&(document.removeEventListener("paste",Vi),Fi=!1)},onload:function(){}};return function(e){ki.includes(e)||(ki.push(e),Fi||(Fi=!0,document.addEventListener("paste",Vi)))}(e),t},Bi=null,qi=null,zi=[],ji=function(e,t){e.element.textContent=t},Wi=function(e,t,n){var i=e.query("GET_TOTAL_ITEMS");ji(e,n+" "+t+", "+i+" "+(1===i?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL"))),clearTimeout(qi),qi=setTimeout((function(){!function(e){e.element.textContent=""}(e)}),1500)},Hi=function(e){return e.element.parentNode.contains(document.activeElement)},Yi=function(e){var t=e.root,n=e.action,i=t.query("GET_ITEM",n.id).filename,r=t.query("GET_LABEL_FILE_PROCESSING_ABORTED");ji(t,i+" "+r)},Xi=function(e){var t=e.root,n=e.action,i=t.query("GET_ITEM",n.id).filename;ji(t,n.status.main+" "+i+" "+n.status.sub)},Zi=P({create:function(e){var t=e.root,n=e.props;t.element.id="filepond--assistant-"+n.id,o(t.element,"role","status"),o(t.element,"aria-live","polite"),o(t.element,"aria-relevant","additions")},ignoreRect:!0,ignoreRectUpdate:!0,write:L({DID_LOAD_ITEM:function(e){var t=e.root,n=e.action;if(Hi(t)){t.element.textContent="";var i=t.query("GET_ITEM",n.id);zi.push(i.filename),clearTimeout(Bi),Bi=setTimeout((function(){Wi(t,zi.join(", "),t.query("GET_LABEL_FILE_ADDED")),zi.length=0}),750)}},DID_REMOVE_ITEM:function(e){var t=e.root,n=e.action;if(Hi(t)){var i=n.item;Wi(t,i.filename,t.query("GET_LABEL_FILE_REMOVED"))}},DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root,n=e.action,i=t.query("GET_ITEM",n.id).filename,r=t.query("GET_LABEL_FILE_PROCESSING_COMPLETE");ji(t,i+" "+r)},DID_ABORT_ITEM_PROCESSING:Yi,DID_REVERT_ITEM_PROCESSING:Yi,DID_THROW_ITEM_REMOVE_ERROR:Xi,DID_THROW_ITEM_LOAD_ERROR:Xi,DID_THROW_ITEM_INVALID:Xi,DID_THROW_ITEM_PROCESSING_ERROR:Xi}),tag:"span",name:"assistant"}),Qi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.replace(new RegExp(t+".","g"),(function(e){return e.charAt(1).toUpperCase()}))},Ki=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Date.now(),r=null;return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];clearTimeout(r);var l=Date.now()-i,u=function(){i=Date.now(),e.apply(void 0,a)};l<t?n||(r=setTimeout(u,t-l)):u()}},Ji=function(e){return e.preventDefault()},$i=function(e){var t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},er=function(e){var t=0,n=0,i=e.ref.list,r=i.childViews[0],o=r.childViews.filter((function(e){return e.rect.element.height})),a=e.query("GET_ACTIVE_ITEMS").map((function(e){return o.find((function(t){return t.id===e.id}))})).filter((function(e){return e}));if(0===a.length)return{visual:t,bounds:n};var s=r.rect.element.width,l=Pn(r,a,i.dragCoordinates),u=a[0].rect.element,c=u.marginTop+u.marginBottom,d=u.marginLeft+u.marginRight,f=u.width+d,p=u.height+c,h=void 0!==l&&l>=0?1:0,g=a.find((function(e){return e.markedForRemoval&&e.opacity<.45}))?-1:0,m=a.length+h+g,E=Cn(s,f);return 1===E?a.forEach((function(e){var i=e.rect.element.height+c;n+=i,t+=i*e.opacity})):(n=Math.ceil(m/E)*p,t=n),{visual:t,bounds:n}},tr=function(e){var t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:0===t?null:t}},nr=function(e,t){var n=e.query("GET_ALLOW_REPLACE"),i=e.query("GET_ALLOW_MULTIPLE"),r=e.query("GET_TOTAL_ITEMS"),o=e.query("GET_MAX_FILES"),a=t.length;return!i&&a>1||!!(W(o=i||n?o:1)&&r+a>o)&&(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:pt("warning",0,"Max files")}),!0)},ir=function(e,t,n){var i=e.childViews[0];return Pn(i,t,{left:n.scopeLeft-i.rect.element.left,top:n.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},rr=function(e){var t=e.query("GET_ALLOW_DROP"),n=e.query("GET_DISABLED"),i=t&&!n;if(i&&!e.ref.hopper){var r=Ni(e.element,(function(t){var n=e.query("GET_BEFORE_DROP_FILE")||function(){return!0};return!e.query("GET_DROP_VALIDATION")||t.every((function(t){return Le("ALLOW_HOPPER_ITEM",t,{query:e.query}).every((function(e){return!0===e}))&&n(t)}))}),{filterItems:function(t){var n=e.query("GET_IGNORED_FILES");return t.filter((function(e){return!Ct(e)||!n.includes(e.name.toLowerCase())}))},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});r.onload=function(t,n){var i=e.ref.list.childViews[0].childViews.filter((function(e){return e.rect.element.height})),r=e.query("GET_ACTIVE_ITEMS").map((function(e){return i.find((function(t){return t.id===e.id}))})).filter((function(e){return e}));Pe("ADD_ITEMS",t,{dispatch:e.dispatch}).then((function(t){if(nr(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:ir(e.ref.list,r,n),interactionMethod:se})})),e.dispatch("DID_DROP",{position:n}),e.dispatch("DID_END_DRAG",{position:n})},r.ondragstart=function(t){e.dispatch("DID_START_DRAG",{position:t})},r.ondrag=Ki((function(t){e.dispatch("DID_DRAG",{position:t})})),r.ondragend=function(t){e.dispatch("DID_END_DRAG",{position:t})},e.ref.hopper=r,e.ref.drip=e.appendChildView(e.createChildView(ti))}else!i&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},or=function(e,t){var n=e.query("GET_ALLOW_BROWSE"),i=e.query("GET_DISABLED"),r=n&&!i;r&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(Xn,Object.assign({},t,{onload:function(t){Pe("ADD_ITEMS",t,{dispatch:e.dispatch}).then((function(t){if(nr(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:-1,interactionMethod:le})}))}})),0):!r&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},ar=function(e){var t=e.query("GET_ALLOW_PASTE"),n=e.query("GET_DISABLED"),i=t&&!n;i&&!e.ref.paster?(e.ref.paster=Ui(),e.ref.paster.onload=function(t){Pe("ADD_ITEMS",t,{dispatch:e.dispatch}).then((function(t){if(nr(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:-1,interactionMethod:ue})}))}):!i&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},sr=L({DID_SET_ALLOW_BROWSE:function(e){var t=e.root,n=e.props;or(t,n)},DID_SET_ALLOW_DROP:function(e){var t=e.root;rr(t)},DID_SET_ALLOW_PASTE:function(e){var t=e.root;ar(t)},DID_SET_DISABLED:function(e){var t=e.root,n=e.props;rr(t),ar(t),or(t,n),t.query("GET_DISABLED")?t.element.dataset.disabled="disabled":t.element.removeAttribute("data-disabled")}}),lr=P({name:"root",read:function(e){var t=e.root;t.ref.measure&&(t.ref.measureHeight=t.ref.measure.offsetHeight)},create:function(e){var t=e.root,n=e.props,i=t.query("GET_ID");i&&(t.element.id=i);var r=t.query("GET_CLASS_NAME");r&&r.split(" ").filter((function(e){return e.length})).forEach((function(e){t.element.classList.add(e)})),t.ref.label=t.appendChildView(t.createChildView(Jn,Object.assign({},n,{translateY:null,caption:t.query("GET_LABEL_IDLE")}))),t.ref.list=t.appendChildView(t.createChildView(Vn,{translateY:null})),t.ref.panel=t.appendChildView(t.createChildView(wn,{name:"panel-root"})),t.ref.assistant=t.appendChildView(t.createChildView(Zi,Object.assign({},n))),t.ref.data=t.appendChildView(t.createChildView(si,Object.assign({},n))),t.ref.measure=qt("div"),t.ref.measure.style.height="100%",t.element.appendChild(t.ref.measure),t.ref.bounds=null,t.query("GET_STYLES").filter((function(e){return!N(e.value)})).map((function(e){var n=e.name,i=e.value;t.element.dataset[n]=i})),t.ref.widthPrevious=null,t.ref.widthUpdated=Ki((function(){t.ref.updateHistory=[],t.dispatch("DID_RESIZE_ROOT")}),250),t.ref.previousAspectRatio=null,t.ref.updateHistory=[];var o=window.matchMedia("(pointer: fine) and (hover: hover)").matches,a="PointerEvent"in window;t.query("GET_ALLOW_REORDER")&&a&&!o&&(t.element.addEventListener("touchmove",Ji,{passive:!1}),t.element.addEventListener("gesturestart",Ji));var s=t.query("GET_CREDITS");if(2===s.length){var l=document.createElement("a");l.className="filepond--credits",l.setAttribute("aria-hidden","true"),l.href=s[0],l.tabindex=-1,l.target="_blank",l.rel="noopener noreferrer",l.textContent=s[1],t.element.appendChild(l),t.ref.credits=l}},write:function(e){var t=e.root,n=e.props,i=e.actions;if(sr({root:t,props:n,actions:i}),i.filter((function(e){return/^DID_SET_STYLE_/.test(e.type)})).filter((function(e){return!N(e.data.value)})).map((function(e){var n=e.type,i=e.data,r=Qi(n.substr(8).toLowerCase(),"_");t.element.dataset[r]=i.value,t.invalidateLayout()})),!t.rect.element.hidden){t.rect.element.width!==t.ref.widthPrevious&&(t.ref.widthPrevious=t.rect.element.width,t.ref.widthUpdated());var r=t.ref.bounds;r||(r=t.ref.bounds=tr(t),t.element.removeChild(t.ref.measure),t.ref.measure=null);var o=t.ref,a=o.hopper,s=o.label,l=o.list,u=o.panel;a&&a.updateHopperState();var c=t.query("GET_PANEL_ASPECT_RATIO"),d=t.query("GET_ALLOW_MULTIPLE"),f=t.query("GET_TOTAL_ITEMS"),p=f===(d?t.query("GET_MAX_FILES")||1e6:1),h=i.find((function(e){return"DID_ADD_ITEM"===e.type}));if(p&&h){var g=h.data.interactionMethod;s.opacity=0,d?s.translateY=-40:g===ae?s.translateX=40:s.translateY=g===le?40:30}else p||(s.opacity=1,s.translateX=0,s.translateY=0);var m=$i(t),E=er(t),v=s.rect.element.height,_=!d||p?0:v,I=p?l.rect.element.marginTop:0,y=0===f?0:l.rect.element.marginBottom,T=_+I+E.visual+y,w=_+I+E.bounds+y;if(l.translateY=Math.max(0,_-l.rect.element.marginTop)-m.top,c){var A=t.rect.element.width,O=A*c;c!==t.ref.previousAspectRatio&&(t.ref.previousAspectRatio=c,t.ref.updateHistory=[]);var R=t.ref.updateHistory;R.push(A);if(R.length>4)for(var S=R.length,b=S-10,M=0,C=S;C>=b;C--)if(R[C]===R[C-2]&&M++,M>=2)return;u.scalable=!1,u.height=O;var P=O-_-(y-m.bottom)-(p?I:0);E.visual>P?l.overflow=P:l.overflow=null,t.height=O}else if(r.fixedHeight){u.scalable=!1;var L=r.fixedHeight-_-(y-m.bottom)-(p?I:0);E.visual>L?l.overflow=L:l.overflow=null}else if(r.cappedHeight){var D=T>=r.cappedHeight,x=Math.min(r.cappedHeight,T);u.scalable=!0,u.height=D?x:x-m.top-m.bottom;var G=x-_-(y-m.bottom)-(p?I:0);T>r.cappedHeight&&E.visual>G?l.overflow=G:l.overflow=null,t.height=Math.min(r.cappedHeight,w-m.top-m.bottom)}else{var F=f>0?m.top+m.bottom:0;u.scalable=!0,u.height=Math.max(v,T-F),t.height=Math.max(v,w-F)}t.ref.credits&&u.heightCurrent&&(t.ref.credits.style.transform="translateY("+u.heightCurrent+"px)")}},destroy:function(e){var t=e.root;t.ref.paster&&t.ref.paster.destroy(),t.ref.hopper&&t.ref.hopper.destroy(),t.element.removeEventListener("touchmove",Ji),t.element.removeEventListener("gesturestart",Ji)},mixins:{styles:["height"]}}),ur=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,i=xe(),o=n(te(i),[Xe,oe(i)],[Ut,re(i)]);o.dispatch("SET_OPTIONS",{options:e});var a=function(){document.hidden||o.dispatch("KICK")};document.addEventListener("visibilitychange",a);var s=null,l=!1,u=!1,c=null,d=null,f=function(){l||(l=!0),clearTimeout(s),s=setTimeout((function(){l=!1,c=null,d=null,u&&(u=!1,o.dispatch("DID_STOP_RESIZE"))}),500)};window.addEventListener("resize",f);var p=lr(o,{id:de()}),h=!1,g=!1,m={_read:function(){l&&(d=window.innerWidth,c||(c=d),u||d===c||(o.dispatch("DID_START_RESIZE"),u=!0)),g&&h&&(h=null===p.element.offsetParent),h||(p._read(),g=p.rect.element.hidden)},_write:function(e){var t=o.processActionQueue().filter((function(e){return!/^SET_/.test(e.type)}));h&&!t.length||(y(t),h=p._write(e,t,u),Ae(o.query("GET_ITEMS")),h&&o.processDispatchQueue())}},E=function(e){return function(t){var n={type:e};if(!t)return n;if(t.hasOwnProperty("error")&&(n.error=t.error?Object.assign({},t.error):null),t.status&&(n.status=Object.assign({},t.status)),t.file&&(n.output=t.file),t.source)n.file=t.source;else if(t.item||t.id){var i=t.item?t.item:o.query("GET_ITEM",t.id);n.file=i?we(i):null}return t.items&&(n.items=t.items.map(we)),/progress/.test(e)&&(n.progress=t.progress),t.hasOwnProperty("origin")&&t.hasOwnProperty("target")&&(n.origin=t.origin,n.target=t.target),n}},v={DID_DESTROY:E("destroy"),DID_INIT:E("init"),DID_THROW_MAX_FILES:E("warning"),DID_INIT_ITEM:E("initfile"),DID_START_ITEM_LOAD:E("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:E("addfileprogress"),DID_LOAD_ITEM:E("addfile"),DID_THROW_ITEM_INVALID:[E("error"),E("addfile")],DID_THROW_ITEM_LOAD_ERROR:[E("error"),E("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[E("error"),E("removefile")],DID_PREPARE_OUTPUT:E("preparefile"),DID_START_ITEM_PROCESSING:E("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:E("processfileprogress"),DID_ABORT_ITEM_PROCESSING:E("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:E("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:E("processfiles"),DID_REVERT_ITEM_PROCESSING:E("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[E("error"),E("processfile")],DID_REMOVE_ITEM:E("removefile"),DID_UPDATE_ITEMS:E("updatefiles"),DID_ACTIVATE_ITEM:E("activatefile"),DID_REORDER_ITEMS:E("reorderfiles")},_=function(e){var t=Object.assign({pond:F},e);delete t.type,p.element.dispatchEvent(new CustomEvent("FilePond:"+e.type,{detail:t,bubbles:!0,cancelable:!0,composed:!0}));var n=[];e.hasOwnProperty("error")&&n.push(e.error),e.hasOwnProperty("file")&&n.push(e.file);var i=["type","error","file"];Object.keys(e).filter((function(e){return!i.includes(e)})).forEach((function(t){return n.push(e[t])})),F.fire.apply(F,[e.type].concat(n));var r=o.query("GET_ON"+e.type.toUpperCase());r&&r.apply(void 0,n)},y=function(e){e.length&&e.filter((function(e){return v[e.type]})).forEach((function(e){var t=v[e.type];(Array.isArray(t)?t:[t]).forEach((function(t){"DID_INIT_ITEM"===e.type?_(t(e.data)):setTimeout((function(){_(t(e.data))}),0)}))}))},T=function(e){return o.dispatch("SET_OPTIONS",{options:e})},w=function(e){return o.query("GET_ACTIVE_ITEM",e)},A=function(e){return new Promise((function(t,n){o.dispatch("REQUEST_ITEM_PREPARE",{query:e,success:function(e){t(e)},failure:function(e){n(e)}})}))},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,i){b([{source:e,options:t}],{index:t.index}).then((function(e){return n(e&&e[0])})).catch(i)}))},R=function(e){return e.file&&e.id},S=function(e,t){return"object"!=typeof e||R(e)||t||(t=e,e=void 0),o.dispatch("REMOVE_ITEM",Object.assign({},t,{query:e})),null===o.query("GET_ACTIVE_ITEM",e)},b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise((function(e,n){var i=[],r={};if(G(t[0]))i.push.apply(i,t[0]),Object.assign(r,t[1]||{});else{var a=t[t.length-1];"object"!=typeof a||a instanceof Blob||Object.assign(r,t.pop()),i.push.apply(i,t)}o.dispatch("ADD_ITEMS",{items:i,index:r.index,interactionMethod:ae,success:e,failure:n})}))},M=function(){return o.query("GET_ACTIVE_ITEMS")},C=function(e){return new Promise((function(t,n){o.dispatch("REQUEST_ITEM_PROCESSING",{query:e,success:function(e){t(e)},failure:function(e){n(e)}})}))},P=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Array.isArray(t[0])?t[0]:t,r=i.length?i:M();return Promise.all(r.map(A))},L=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Array.isArray(t[0])?t[0]:t;if(!i.length){var r=M().filter((function(e){return!(e.status===Oe.IDLE&&e.origin===Re.LOCAL)&&e.status!==Oe.PROCESSING&&e.status!==Oe.PROCESSING_COMPLETE&&e.status!==Oe.PROCESSING_REVERT_ERROR}));return Promise.all(r.map(C))}return Promise.all(i.map(C))},N=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=Array.isArray(t[0])?t[0]:t;"object"==typeof r[r.length-1]?i=r.pop():Array.isArray(t[0])&&(i=t[1]);var o=M();if(!r.length)return Promise.all(o.map((function(e){return S(e,i)})));var a=r.map((function(e){return I(e)?o[e]?o[e].id:null:e})).filter((function(e){return e}));return a.map((function(e){return S(e,i)}))},F=Object.assign({},Ie(),{},m,{},ie(o,i),{setOptions:T,addFile:O,addFiles:b,getFile:w,processFile:C,prepareFile:A,removeFile:S,moveFile:function(e,t){return o.dispatch("MOVE_ITEM",{query:e,index:t})},getFiles:M,processFiles:L,removeFiles:N,prepareFiles:P,sort:function(e){return o.dispatch("SORT",{compare:e})},browse:function(){var e=p.element.querySelector("input[type=file]");e&&e.click()},destroy:function(){F.fire("destroy",p.element),o.dispatch("ABORT_ALL"),p._destroy(),window.removeEventListener("resize",f),document.removeEventListener("visibilitychange",a),o.dispatch("DID_DESTROY")},insertBefore:function(e){return D(p.element,e)},insertAfter:function(e){return x(p.element,e)},appendTo:function(e){return e.appendChild(p.element)},replaceElement:function(e){D(p.element,e),e.parentNode.removeChild(e),t=e},restoreElement:function(){t&&(x(t,p.element),p.element.parentNode.removeChild(p.element),t=null)},isAttachedTo:function(e){return p.element===e||t===e},element:{get:function(){return p.element}},status:{get:function(){return o.query("GET_STATUS")}}});return o.dispatch("DID_INIT"),r(F)},cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};i(xe(),(function(e,n){t[e]=n[0]}));var n=ur(Object.assign({},t,{},e));return n},dr=function(e){return Qi(e.replace(/^data-/,""))},fr=function e(t,n){i(n,(function(n,r){i(t,(function(e,i){var o=new RegExp(n);if(o.test(e)&&(delete t[e],!1!==r))if(B(r))t[r]=i;else{var a,s=r.group;Q(r)&&!t[s]&&(t[s]={}),t[s][(a=e.replace(o,""),a.charAt(0).toLowerCase()+a.slice(1))]=i}})),r.mapping&&e(t[r.group],r.mapping)}))},pr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];i(e.attributes,(function(t){n.push(e.attributes[t])}));var r=n.filter((function(e){return e.name})).reduce((function(t,n){var i=o(e,n.name);return t[dr(n.name)]=i===n.name||i,t}),{});return fr(r,t),r},hr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};Le("SET_ATTRIBUTE_TO_OPTION_MAP",n);var i=Object.assign({},t),r=pr("FIELDSET"===e.nodeName?e.querySelector("input[type=file]"):e,n);Object.keys(r).forEach((function(e){Q(r[e])?(Q(i[e])||(i[e]={}),Object.assign(i[e],r[e])):i[e]=r[e]})),i.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map((function(e){return{source:e.value,options:{type:e.dataset.type}}})));var o=cr(i);return e.files&&Array.from(e.files).forEach((function(e){o.addFile(e)})),o.replaceElement(e),o},gr=function(){return t(arguments.length<=0?void 0:arguments[0])?hr.apply(void 0,arguments):cr.apply(void 0,arguments)},mr=["fire","_read","_write"],Er=function(e){var t={};return ye(e,t,mr),t},vr=function(e,t){return e.replace(/(?:{([a-zA-Z]+)})/g,(function(e,n){return t[n]}))},_r=function(e){var t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(t),i=new Worker(n);return{transfer:function(e,t){},post:function(e,t,n){var r=de();i.onmessage=function(e){e.data.id===r&&t(e.data.message)},i.postMessage({id:r,message:e},n)},terminate:function(){i.terminate(),URL.revokeObjectURL(n)}}},Ir=function(e){return new Promise((function(t,n){var i=new Image;i.onload=function(){t(i)},i.onerror=function(e){n(e)},i.src=e}))},yr=function(e,t){var n=e.slice(0,e.size,e.type);return n.lastModifiedDate=e.lastModifiedDate,n.name=t,n},Tr=function(e){return yr(e,e.name)},wr=[],Ar=function(e){if(!wr.includes(e)){wr.push(e);var t,n=e({addFilter:De,utils:{Type:Me,forin:i,isString:B,isFile:Ct,toNaturalFileSize:Xt,replaceInString:vr,getExtensionFromFilename:Je,getFilenameWithoutExtension:bt,guesstimateMimeType:di,getFileFromBlob:nt,getFilenameFromURL:Ke,createRoute:L,createWorker:_r,createView:P,createItemAPI:we,loadImage:Ir,copyFile:Tr,renameFile:yr,createBlob:it,applyFilterChain:Pe,text:zt,getNumericAspectRatioFromString:Fe},views:{fileActionButton:Yt}});t=n.options,Object.assign(Ge,t)}},Or=(sn=g()&&!("[object OperaMini]"===Object.prototype.toString.call(window.operamini))&&"visibilityState"in document&&"Promise"in window&&"slice"in Blob.prototype&&"URL"in window&&"createObjectURL"in window.URL&&"performance"in window&&("supports"in(window.CSS||{})||/MSIE|Trident/.test(window.navigator.userAgent)),function(){return sn}),Rr={apps:[]},Sr=function(){};if(e.Status={},e.FileStatus={},e.FileOrigin={},e.OptionTypes={},e.create=Sr,e.destroy=Sr,e.parse=Sr,e.find=Sr,e.registerPlugin=Sr,e.getOptions=Sr,e.setOptions=Sr,Or()){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,i="__framePainter";if(window[i])return window[i].readers.push(e),void window[i].writers.push(t);window[i]={readers:[e],writers:[t]};var r=window[i],o=1e3/n,a=null,s=null,l=null,u=null,c=function(){document.hidden?(l=function(){return window.setTimeout((function(){return d(performance.now())}),o)},u=function(){return window.clearTimeout(s)}):(l=function(){return window.requestAnimationFrame(d)},u=function(){return window.cancelAnimationFrame(s)})};document.addEventListener("visibilitychange",(function(){u&&u(),c(),d(performance.now())}));var d=function e(t){s=l(e),a||(a=t);var n=t-a;n<=o||(a=t-n%o,r.readers.forEach((function(e){return e()})),r.writers.forEach((function(e){return e(t)})))};c(),d(performance.now())}((function(){Rr.apps.forEach((function(e){return e._read()}))}),(function(e){Rr.apps.forEach((function(t){return t._write(e)}))}));var br=function t(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:Or,create:e.create,destroy:e.destroy,parse:e.parse,find:e.find,registerPlugin:e.registerPlugin,setOptions:e.setOptions}})),document.removeEventListener("DOMContentLoaded",t)};"loading"!==document.readyState?setTimeout((function(){return br()}),0):document.addEventListener("DOMContentLoaded",br);var Mr=function(){return i(xe(),(function(t,n){e.OptionTypes[t]=n[1]}))};e.Status=Object.assign({},Ve),e.FileOrigin=Object.assign({},Re),e.FileStatus=Object.assign({},Oe),e.OptionTypes={},Mr(),e.create=function(){var t=gr.apply(void 0,arguments);return t.on("destroy",e.destroy),Rr.apps.push(t),Er(t)},e.destroy=function(e){var t=Rr.apps.findIndex((function(t){return t.isAttachedTo(e)}));return t>=0&&(Rr.apps.splice(t,1)[0].restoreElement(),!0)},e.parse=function(t){return Array.from(t.querySelectorAll(".filepond")).filter((function(e){return!Rr.apps.find((function(t){return t.isAttachedTo(e)}))})).map((function(t){return e.create(t)}))},e.find=function(e){var t=Rr.apps.find((function(t){return t.isAttachedTo(e)}));return t?Er(t):null},e.registerPlugin=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(Ar),Mr()},e.getOptions=function(){var e={};return i(xe(),(function(t,n){e[t]=n[0]})),e},e.setOptions=function(t){return Q(t)&&(Rr.apps.forEach((function(e){e.setOptions(t)})),function(e){i(e,(function(e,t){Ge[e]&&(Ge[e][0]=$(t,Ge[e][0],Ge[e][1]))}))}(t)),e.getOptions()}}e.supported=Or,Object.defineProperty(e,"__esModule",{value:!0})}));var F={},k=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,o=Object.create(r.prototype),a=new b(i||[]);return o._invoke=function(e,t,n){var i=d;return function(r,o){if(i===p)throw new Error("Generator is already running");if(i===h){if("throw"===r)throw o;return C()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(e,t,n);if("normal"===l.type){if(i=n.done?h:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=h,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",g={};function m(){}function E(){}function v(){}var _={};l(_,o,(function(){return this}));var I=Object.getPrototypeOf,y=I&&I(I(M([])));y&&y!==n&&i.call(y,o)&&(_=y);var T=v.prototype=m.prototype=Object.create(_);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(r,o,a,s){var l=c(e[r],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var r;this._invoke=function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}}function O(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=c(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function M(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return E.prototype=v,l(T,"constructor",v),l(v,"constructor",E),E.displayName=l(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,s,"GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},w(A.prototype),l(A.prototype,a,(function(){return this})),e.AsyncIterator=A,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new A(u(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(T),l(T,s,"Generator"),l(T,o,(function(){return this})),l(T,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=M,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:M(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),g}},e}(F);try{regeneratorRuntime=k}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=k:Function("r","regeneratorRuntime = r")(k)}
/*!
 * Pintura Image Editor 8.23.3
 * (c) 2018-2022 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 */var V,U,B=function(e){return e instanceof File},q=function(e){return/^image/.test(e.type)},z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e),r=Object.getOwnPropertyDescriptors(i.__proto__);for(var o in t)"style"===o?i.style.cssText=t[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||"function"==typeof t[o]?i[o]=t[o]:i.setAttribute(o,t[o]);return n.forEach((function(e){return i.appendChild(e)})),i},j=null,W=function(){return null===j&&(j="undefined"!=typeof window&&void 0!==window.document),j},H=W()&&!!Node.prototype.replaceChildren?function(e,t){return e.replaceChildren(t)}:function(e,t){for(;e.lastChild;)e.removeChild(e.lastChild);void 0!==t&&e.append(t)},Y=W()&&z("div",{class:"PinturaMeasure",style:"pointer-events:none;left:0;top:0;width:0;height:0;contain:strict;overflow:hidden;position:absolute;"}),X=null,Z=function(e){return new Promise((function(t,n){var i=!1;!e.parentNode&&(null===X&&(X=W()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),X)&&(i=!0,e.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",H(Y,e),Y.parentNode||document.body.append(Y),clearTimeout(V),V=setTimeout((function(){Y.remove()}),500));var r=function(){var n=e.naturalWidth,r=e.naturalHeight;n&&r&&(i&&e.remove(),clearInterval(o),t({width:n,height:r}))};e.onerror=function(e){clearInterval(o),n(e)};var o=setInterval(r,1);r()}))},Q=(U=e(F).mark((function t(n){var i,r;return e(F).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=n).src||((i=new Image).src="string"==typeof n?n:URL.createObjectURL(n)),e.prev=3,e.next=6,Z(i);case 6:r=e.sent;case 7:return e.prev=7,B(n)&&URL.revokeObjectURL(i.src),e.finish(7);case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),t,null,[[3,,7,10]])})),function(){var e=this,t=arguments;return new Promise((function(i,r){var o=U.apply(e,t);function a(e){n(o,i,r,a,s,"next",e)}function s(e){n(o,i,r,a,s,"throw",e)}a(void 0)}))}),K=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]},J=function(e){e.width=1,e.height=1;var t=e.getContext("2d");t&&t.clearRect(0,0,1,1)},$=null,ee=function(e,t){return function(){if(null===$)if("WebGL2RenderingContext"in window){var e;try{e=z("canvas"),$=!!e.getContext("webgl2")}catch(e){$=!1}e&&J(e),e=void 0}else $=!1;return $}()?e.getContext("webgl2",t):e.getContext("webgl",t)||e.getContext("experimental-webgl",t)},te=null,ne=function(){if(null===te){var e=z("canvas");te=!!ee(e),J(e),e=void 0}return te},ie=null,re=function(){return null===ie&&(ie=W()&&!("[object OperaMini]"===Object.prototype.toString.call(window.operamini))&&"visibilityState"in document&&"Promise"in window&&"File"in window&&"URL"in window&&"createObjectURL"in window.URL&&"performance"in window),ie},oe=function(e){var t,n,i,r,o,a,l,c,d,f,p=e.addFilter,h=e.utils,g=e.views,m=h.Type,E=h.createRoute,v=g.fileActionButton,_=(n=(t={parallel:1}).parallel,i=void 0===n?1:n,r=t.autoShift,o=void 0===r||r,a=[],l=0,c=function(){if(!a.length)return f.oncomplete();l++,a.shift()((function(){--l<i&&d()}))},f={queue:function(e){a.push(e),o&&d()},runJobs:d=function(){for(var e=0;e<i-l;e++)c()},oncomplete:function(){}}),I=function(e){return null===e?{}:e};p("SHOULD_REMOVE_ON_REVERT",(function(e,t){var n=t.item,i=t.query;return new Promise((function(e){var t=n.file;e(!(i("GET_ALLOW_IMAGE_EDITOR")&&i("GET_IMAGE_EDITOR_ALLOW_EDIT")&&i("GET_IMAGE_EDITOR_SUPPORT_EDIT")&&i("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(t)))}))})),p("DID_LOAD_ITEM",(function(e,t){var n=t.query,i=t.dispatch;return new Promise((function(t,r){if(e.origin>1)t(e);else{var o=e.file;if(!n("GET_ALLOW_IMAGE_EDITOR")||!n("GET_IMAGE_EDITOR_INSTANT_EDIT"))return t(e);if(!n("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(o))return t(e);var a=function(){if(y.length){var e=y[0],t=e.item,n=e.resolve,r=e.reject;i("EDIT_ITEM",{id:t.id,handleEditorResponse:s(t,n,r)})}},s=function(e,t,n){return function(r){y.shift(),r?t(e):n(e),i("KICK"),a()}};T({item:e,resolve:t,reject:r}),1===y.length&&a()}}))})),p("DID_CREATE_ITEM",(function(e,t){t.query;var n=t.dispatch;e.extend("edit",(function(){n("EDIT_ITEM",{id:e.id})}))}));var y=[],T=function(e){return y.push(e),e},w=function(e,t){var n=e("GET_FILE_POSTER_HEIGHT"),i=e("GET_FILE_POSTER_MAX_HEIGHT");return n?(t.width=2*n,t.height=2*n):i&&(t.width=2*i,t.height=2*i),t},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(t){var i=I(e("GET_IMAGE_EDITOR")),r=i.imageProcessor,o=i.imageReader,a=i.imageWriter,l=i.editorOptions,c=i.imageState;if(r){var d=u(o),f=d[0],p=d[1],h=u(a),g=h[0],m=void 0===g?K:g,E=h[1],v=t.file,y=t.getMetadata("imageState");if(y){var T=w(e,{width:512,height:512}),A=s({},l,{imageReader:f(p),imageWriter:m(s({},E||{},{canvasMemoryLimit:T.width*T.height*2})),imageState:s({},c,y)});_.queue((function(e){r(v,A).then((function(i){var r=i.dest;t.setMetadata("poster",URL.createObjectURL(r),!0),e(),n()}))}))}else n()}}};p("CREATE_VIEW",(function(e){var t=e.is,n=e.view,i=e.query;if(i("GET_ALLOW_IMAGE_EDITOR")&&i("GET_IMAGE_EDITOR_SUPPORT_WRITE_IMAGE")){var r=i("GET_ALLOW_FILE_POSTER")||i("GET_ALLOW_FILE_GRID")||i("GET_ALLOW_FILE_GRID");if(t("file-info")&&!r||t("file")&&r){var o=I(i("GET_IMAGE_EDITOR")),a=o.createEditor,l=o.imageReader,c=o.imageWriter,d=o.editorOptions,f=o.legacyDataToImageState,p=o.imageState;if(l&&c&&d&&d.locale){delete d.imageReader,delete d.imageWriter;var h=u(l),g=h[0],m=h[1],_=function(e){var t=e.id;return i("GET_ITEM",t)},y=function(e,t){if(e.ref.handleEdit||(e.ref.handleEdit=function(n){n.stopPropagation(),e.dispatch("EDIT_ITEM",{id:t.id})}),function(e){if(!(i("GET_ALLOW_FILE_POSTER")||i("GET_ALLOW_FILE_GRID")||i("GET_ALLOW_FILE_GRID")))return!1;var t=_(e);return t?!!i("GET_FILE_POSTER_FILTER_ITEM")(t)&&!!t.getMetadata("poster"):void 0}(t)){e.ref.editButton&&e.ref.editButton.parentNode&&e.ref.editButton.parentNode.removeChild(e.ref.editButton);var r=n.createChildView(v,{label:"edit",icon:i("GET_IMAGE_EDITOR_ICON_EDIT"),opacity:0});r.element.classList.add("filepond--action-edit-item"),r.element.dataset.align=i("GET_STYLE_IMAGE_EDITOR_BUTTON_EDIT_ITEM_POSITION"),r.on("click",e.ref.handleEdit),e.ref.buttonEditItem=n.appendChildView(r)}else{e.ref.buttonEditItem&&e.removeChildView(e.ref.buttonEditItem);var o=n.element.querySelector(".filepond--file-info-main"),a=document.createElement("button");a.className="filepond--action-edit-item-alt",a.innerHTML=i("GET_IMAGE_EDITOR_ICON_EDIT")+"<span>edit</span>",a.addEventListener("click",e.ref.handleEdit),o.appendChild(a),e.ref.editButton=a}};n.registerDestroyer((function(e){var t=e.root;t.ref.buttonEditItem&&t.ref.buttonEditItem.off("click",t.ref.handleEdit),t.ref.editButton&&t.ref.editButton.removeEventListener("click",t.ref.handleEdit)}));var T={EDIT_ITEM:function(e){e.root;var t=e.props,n=e.action.handleEditorResponse,i=_(t),r=i.file,o=a(s({},d,{imageReader:g(m),src:r}));o.on("load",(function(e){var t=e.size,n=i.getMetadata("imageState");n=f?f(o,t,n):n,o.imageState=s({},p,n)})),o.on("process",(function(e){var t=e.imageState;i.setMetadata("imageState",t),n&&n(!0)})),o.on("close",(function(){n&&n(!1)}))},DID_LOAD_ITEM:function(e){var t=e.root,n=e.props,r=n.id,o=i("GET_ITEM",r);if(o){var a=o.file;i("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(a)&&((i("GET_ALLOW_FILE_POSTER")||i("GET_ALLOW_FILE_GRID")||i("GET_ALLOW_FILE_GRID"))&&!o.getMetadata("poster")&&t.dispatch("REQUEST_CREATE_IMAGE_POSTER",{id:r}),i("GET_IMAGE_EDITOR_ALLOW_EDIT")&&i("GET_IMAGE_EDITOR_SUPPORT_EDIT")&&y(t,n))}},DID_UPDATE_ITEM_METADATA:function(e){var t=e.root,n=e.props,r=e.action;if(/imageState/.test(r.change.key)&&(i("GET_ALLOW_FILE_POSTER")||i("GET_ALLOW_FILE_GRID")||i("GET_ALLOW_FILE_GRID")))return t.dispatch("REQUEST_CREATE_IMAGE_POSTER",{id:n.id});/poster/.test(r.change.key)&&i("GET_IMAGE_EDITOR_ALLOW_EDIT")&&i("GET_IMAGE_EDITOR_SUPPORT_EDIT")&&y(t,n)},DID_REMOVE_ITEM:function(e){var t=e.props.id,n=i("GET_ITEM",t);if(n){var r=n.getMetadata("poster");r&&URL.revokeObjectURL(r)}},REQUEST_CREATE_IMAGE_POSTER:function(e){var t=e.root,n=e.props;return A(t.query,_(n))},DID_FILE_POSTER_LOAD:void 0};if(r){T.DID_FILE_POSTER_LOAD=function(e){var t=e.root;t.ref.buttonEditItem&&(t.ref.buttonEditItem.opacity=1)}}n.registerWriter(E(T))}}}})),p("SHOULD_PREPARE_OUTPUT",(function(e,t){var n=t.query,i=t.change,r=t.item;return new Promise((function(e){return n("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(r.file)?i&&!/imageState/.test(i.key)?e(!1):void e(!n("IS_ASYNC")):e(!1)}))}));var O=function(e,t,n){return new Promise((function(i){if(!function(e){var t=I(e("GET_IMAGE_EDITOR")),n=t.imageProcessor,i=t.imageReader,r=t.imageWriter;return e("GET_IMAGE_EDITOR_WRITE_IMAGE")&&e("GET_IMAGE_EDITOR_SUPPORT_WRITE_IMAGE")&&n&&i&&r}(e)||n.archived||!B(t)&&(!((r=t)instanceof Blob)||r instanceof File)||!e("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(t))return i(!1);var r;Q(t).then((function(){var n=e("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(n){var r=n(t);if("boolean"==typeof r)return i(r);if("function"==typeof r.then)return r.then(i)}i(!0)})).catch((function(){i(!1)}))}))};return p("PREPARE_OUTPUT",(function(e,t){var n=t.query,i=t.item;return new Promise((function(t){O(n,e,i).then((function(r){if(!r)return t(e);var o;(o=e,new Promise((function(e,t){var r=function(){_.queue((function(r){var a=i.getMetadata("imageState"),l=I(n("GET_IMAGE_EDITOR")),c=l.imageProcessor,d=l.imageReader,f=l.imageWriter,p=l.editorOptions,h=l.imageState;if(c&&d&&f&&p){var g=u(d),m=g[0],E=g[1],v=u(f),_=v[0],y=void 0===_?K:_,T=v[1];c(o,s({},p,{imageReader:m(E),imageWriter:y(T),imageState:s({},h,a)})).then(e).catch(t).finally(r)}}))};!n("GET_ALLOW_FILE_POSTER")&&!n("GET_ALLOW_FILE_GRID")||i.getMetadata("poster")?r():A(n,i,r)}))).then((function(e){var i=n("GET_IMAGE_EDITOR_AFTER_WRITE_IMAGE");if(i)return Promise.resolve(i(e)).then(t);t(e.dest)}))}))}))})),{options:{allowImageEditor:[!0,m.BOOLEAN],imageEditorInstantEdit:[!1,m.BOOLEAN],imageEditorAllowEdit:[!0,m.BOOLEAN],imageEditorSupportEdit:[W()&&re()&&ne(),m.BOOLEAN],imageEditorSupportImage:[q,m.FUNCTION],imageEditorSupportWriteImage:[re(),m.BOOLEAN],imageEditorWriteImage:[!0,m.BOOLEAN],imageEditorAfterWriteImage:[void 0,m.FUNCTION],imageEditor:[null,m.OBJECT],imageEditorIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',m.STRING],styleImageEditorButtonEditItemPosition:["bottom center",m.STRING]}}};W()&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:oe}));var ae=oe,se={};
/*!
 * FilePondPluginFilePoster 2.5.1
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof se?se=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginFilePoster=t()}(se,(function(){"use strict";var e={type:"spring",stiffness:.5,damping:.45,mass:10},t=function(e){return-.5*(Math.cos(Math.PI*e)-1)},n=function(e,t){return Math.floor(Math.sqrt(e/(t/4)))},i=function(e,n,i,r,o){e.width=n,e.height=i;var a=e.getContext("2d"),s=.5*n,l=a.createRadialGradient(s,i+110,i-100,s,i+110,i+100);!function(e,n){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=1-a,l=n.join(","),u=0;u<=o;u++){var c=u/o,d=a+s*c;e.addColorStop(d,"rgba(".concat(l,", ").concat(r(c)*i,")"))}}(l,r,o,void 0,8,.4),a.save(),a.translate(.5*-n,0),a.scale(2,1),a.fillStyle=l,a.fillRect(0,0,n,i),a.restore()},r="undefined"!=typeof navigator,o=500,a=200,s=r&&document.createElement("canvas"),l=r&&document.createElement("canvas"),u=r&&document.createElement("canvas"),c=[40,40,40],d=[196,78,71],f=[54,151,99];r&&(i(s,o,a,c,.85),i(l,o,a,d,1),i(u,o,a,f,1));var p=function(t){var r=t.utils.createView({name:"file-poster-overlay",tag:"canvas",ignoreRect:!0,create:function(e){var t,n,i=e.root;t=e.props.template,(n=i.element).width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),p=function(e){var t=e.root;t.ref.overlayShadow.opacity=1,t.ref.overlayError.opacity=0,t.ref.overlaySuccess.opacity=0},h=function(e){var t=e.root;t.ref.overlayShadow.opacity=.25,t.ref.overlayError.opacity=1};return t.utils.createView({name:"file-poster-wrapper",create:function(n){var p=n.root,h=n.props,g=p.query("GET_FILE_POSTER_ITEM_OVERLAY_SHADOW_COLOR"),m=p.query("GET_FILE_POSTER_ITEM_OVERLAY_ERROR_COLOR"),E=p.query("GET_FILE_POSTER_ITEM_OVERLAY_SUCCESS_COLOR");g&&g!==c&&i(s,o,a,c=g,.85),m&&m!==d&&i(l,o,a,d=m,1),E&&E!==f&&i(u,o,a,f=E,1);var v=function(t){return t.utils.createView({name:"file-poster",tag:"div",ignoreRect:!0,create:function(e){var t=e.root;t.ref.image=document.createElement("img"),t.element.appendChild(t.ref.image)},write:t.utils.createRoute({DID_FILE_POSTER_LOAD:function(e){var t=e.root,n=e.props,i=n.id,r=t.query("GET_ITEM",{id:n.id});if(r){var o=r.getMetadata("poster");t.ref.image.src=o,t.dispatch("DID_FILE_POSTER_DRAW",{id:i})}}}),mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:e,scaleY:e,opacity:{type:"tween",duration:750}}}})}(t);p.ref.image=p.appendChildView(p.createChildView(v,{id:h.id,scaleX:1.25,scaleY:1.25,opacity:0})),p.ref.overlayShadow=p.appendChildView(p.createChildView(r,{template:s,opacity:0})),p.ref.overlaySuccess=p.appendChildView(p.createChildView(r,{template:u,opacity:0})),p.ref.overlayError=p.appendChildView(p.createChildView(r,{template:l,opacity:0}))},write:t.utils.createRoute({DID_FILE_POSTER_LOAD:function(e){e.root.ref.overlayShadow.opacity=1},DID_FILE_POSTER_DRAW:function(e){var t=e.root.ref.image;t.scaleX=1,t.scaleY=1,t.opacity=1},DID_FILE_POSTER_CONTAINER_CREATE:function(e){var t=e.root,i=e.props.id,r=t.query("GET_ITEM",i);if(r){var o,a,s,l=r.getMetadata("poster"),u=function(e){var o=t.query("GET_FILE_POSTER_CALCULATE_AVERAGE_IMAGE_COLOR")?function(e){var t=Math.min(10/e.width,10/e.height),i=document.createElement("canvas"),r=i.getContext("2d"),o=i.width=Math.ceil(e.width*t),a=i.height=Math.ceil(e.height*t);r.drawImage(e,0,0,o,a);var s=null;try{s=r.getImageData(0,0,o,a).data}catch(e){return null}for(var l=s.length,u=0,c=0,d=0,f=0;f<l;f+=4)u+=s[f]*s[f],c+=s[f+1]*s[f+1],d+=s[f+2]*s[f+2];return{r:u=n(u,l),g:c=n(c,l),b:d=n(d,l)}}(e):null;r.setMetadata("color",o,!0),t.dispatch("DID_FILE_POSTER_LOAD",{id:i,data:e})};o=l,a=function(e,n){var r,o;t.dispatch("DID_FILE_POSTER_CALCULATE_SIZE",{id:i,width:e,height:n}),(r=l,o=t.query("GET_FILE_POSTER_CROSS_ORIGIN_ATTRIBUTE_VALUE"),new Promise((function(e,t){var n=new Image;"string"==typeof crossOrigin&&(n.crossOrigin=o),n.onload=function(){e(n)},n.onerror=function(e){t(e)},n.src=r}))).then(u)},(s=new Image).onload=function(){var e=s.naturalWidth,t=s.naturalHeight;s=null,a(e,t)},s.src=o}},DID_THROW_ITEM_LOAD_ERROR:h,DID_THROW_ITEM_PROCESSING_ERROR:h,DID_THROW_ITEM_INVALID:h,DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root;t.ref.overlayShadow.opacity=.25,t.ref.overlaySuccess.opacity=1},DID_START_ITEM_PROCESSING:p,DID_REVERT_ITEM_PROCESSING:p})})},h=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.createRoute,o=p(e);return t("CREATE_VIEW",(function(e){var t=e.is,n=e.view,i=e.query;if(t("file")&&i("GET_ALLOW_FILE_POSTER")){var a=function(e,t){var r=t.id,a=i("GET_ITEM",r);a&&a.getMetadata("poster")&&!a.archived&&e.ref.previousPoster!==a.getMetadata("poster")&&(e.ref.previousPoster=a.getMetadata("poster"),i("GET_FILE_POSTER_FILTER_ITEM")(a)&&(e.ref.filePoster&&n.removeChildView(e.ref.filePoster),e.ref.filePoster=n.appendChildView(n.createChildView(o,{id:r})),e.dispatch("DID_FILE_POSTER_CONTAINER_CREATE",{id:r})))},s=function(e){var t=e.root,n=t.query("GET_FILE_POSTER_HEIGHT");if(n)return n;var i=t.query("GET_FILE_POSTER_MIN_HEIGHT"),r=t.query("GET_FILE_POSTER_MAX_HEIGHT");if(i&&t.ref.imageHeight<i)return i;var o=t.rect.element.width*(t.ref.imageHeight/t.ref.imageWidth);return i&&o<i?i:r&&o>r?r:o};n.registerWriter(r({DID_LOAD_ITEM:function(e){var t=e.root,n=e.props;a(t,n)},DID_FILE_POSTER_CALCULATE_SIZE:function(e){var t=e.root,n=e.action;t.ref.filePoster&&(t.ref.imageWidth=n.width,t.ref.imageHeight=n.height,t.ref.shouldUpdatePanelHeight=!0,t.dispatch("KICK"))},DID_UPDATE_ITEM_METADATA:function(e){var t=e.root,n=e.props,i=e.action;/poster/.test(i.change.key)&&a(t,n)}},(function(e){var t=e.root,n=e.props;t.ref.filePoster&&(t.rect.element.hidden||t.ref.shouldUpdatePanelHeight&&(t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:n.id,height:s({root:t})}),t.ref.shouldUpdatePanelHeight=!1))})))}})),{options:{allowFilePoster:[!0,i.BOOLEAN],filePosterHeight:[null,i.INT],filePosterMinHeight:[null,i.INT],filePosterMaxHeight:[null,i.INT],filePosterFilterItem:[function(){return!0},i.FUNCTION],filePosterCalculateAverageImageColor:[!1,i.BOOLEAN],filePosterCrossOriginAttributeValue:["Anonymous",i.STRING],filePosterItemOverlayShadowColor:[null,i.ARRAY],filePosterItemOverlayErrorColor:[null,i.ARRAY],filePosterItemOverlaySuccessColor:[null,i.ARRAY]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:h})),h}));var le={};
/*!
 * FilePondPluginFileValidateType 1.2.5
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof le?le=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginFileValidateType=t()}(le,(function(){"use strict";var e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.isString,o=n.replaceInString,a=n.guesstimateMimeType,s=n.getExtensionFromFilename,l=n.getFilenameFromURL,u=function(e,t){return e.some((function(e){return/\*$/.test(e)?(n=e,(/^[^/]+/.exec(t)||[]).pop()===n.slice(0,-2)):e===t;var n}))},c=function(e,t,n){if(0===t.length)return!0;var i=function(e){var t="";if(r(e)){var n=l(e),i=s(n);i&&(t=a(i))}else t=e.type;return t}(e);return n?new Promise((function(r,o){n(e,i).then((function(e){u(t,e)?r():o()})).catch(o)})):u(t,i)};return t("SET_ATTRIBUTE_TO_OPTION_MAP",(function(e){return Object.assign(e,{accept:"acceptedFileTypes"})})),t("ALLOW_HOPPER_ITEM",(function(e,t){var n=t.query;return!n("GET_ALLOW_FILE_TYPE_VALIDATION")||c(e,n("GET_ACCEPTED_FILE_TYPES"))})),t("LOAD_FILE",(function(e,t){var n=t.query;return new Promise((function(t,i){if(n("GET_ALLOW_FILE_TYPE_VALIDATION")){var r=n("GET_ACCEPTED_FILE_TYPES"),a=n("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),s=c(e,r,a),l=function(){var e,t=r.map((e=n("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"),function(t){return null!==e[t]&&(e[t]||t)})).filter((function(e){return!1!==e}));i({status:{main:n("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:o(n("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:t.join(", "),allButLastType:t.slice(0,-1).join(", "),lastType:t[t.length-1]})}})};if("boolean"==typeof s)return s?t(e):l();s.then((function(){t(e)})).catch(l)}else t(e)}))})),{options:{allowFileTypeValidation:[!0,i.BOOLEAN],acceptedFileTypes:[[],i.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",i.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",i.STRING],fileValidateTypeLabelExpectedTypesMap:[{},i.OBJECT],fileValidateTypeDetectType:[null,i.FUNCTION]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}));var ue={};
/*!
 * FilePondPluginFileValidateSize 2.2.1
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof ue?ue=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginFileValidateSize=t()}(ue,(function(){"use strict";var e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.replaceInString,o=n.toNaturalFileSize;return t("ALLOW_HOPPER_ITEM",(function(e,t){var n=t.query;if(!n("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;var i=n("GET_MAX_FILE_SIZE");if(null!==i&&e.size>=i)return!1;var r=n("GET_MIN_FILE_SIZE");return!(null!==r&&e.size<=r)})),t("LOAD_FILE",(function(e,t){var n=t.query;return new Promise((function(t,i){if(!n("GET_ALLOW_FILE_SIZE_VALIDATION"))return t(e);var a=n("GET_FILE_VALIDATE_SIZE_FILTER");if(a&&!a(e))return t(e);var s=n("GET_MAX_FILE_SIZE");if(null!==s&&e.size>=s)i({status:{main:n("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:r(n("GET_LABEL_MAX_FILE_SIZE"),{filesize:o(s)})}});else{var l=n("GET_MIN_FILE_SIZE");if(null!==l&&e.size<=l)i({status:{main:n("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:r(n("GET_LABEL_MIN_FILE_SIZE"),{filesize:o(l)})}});else{var u=n("GET_MAX_TOTAL_FILE_SIZE");if(null!==u)if(n("GET_ACTIVE_ITEMS").reduce((function(e,t){return e+t.fileSize}),0)>u)return void i({status:{main:n("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:r(n("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:o(u)})}});t(e)}}}))})),{options:{allowFileSizeValidation:[!0,i.BOOLEAN],maxFileSize:[null,i.INT],minFileSize:[null,i.INT],maxTotalFileSize:[null,i.INT],fileValidateSizeFilter:[null,i.FUNCTION],labelMinFileSizeExceeded:["File is too small",i.STRING],labelMinFileSize:["Minimum file size is {filesize}",i.STRING],labelMaxFileSizeExceeded:["File is too large",i.STRING],labelMaxFileSize:["Maximum file size is {filesize}",i.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",i.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}));var ce={};
/*!
 * FilePondPluginImageExifOrientation 1.0.9
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof ce?ce=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginImageExifOrientation=t()}(ce,(function(){"use strict";var e=65496,t=65505,n=1165519206,i=18761,r=274,o=65280,a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.getUint16(t,n)},s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.getUint32(t,n)},l="undefined"!=typeof window&&void 0!==window.document,u=void 0,c=l?new Image:{};c.onload=function(){return u=c.naturalWidth>c.naturalHeight},c.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";var d=function(l){var c=l.addFilter,d=l.utils,f=d.Type,p=d.isFile;return c("DID_LOAD_ITEM",(function(l,c){var d=c.query;return new Promise((function(c,f){var h=l.file;if(!(p(h)&&function(e){return/^image\/jpeg/.test(e.type)}(h)&&d("GET_ALLOW_IMAGE_EXIF_ORIENTATION")&&u))return c(l);(function(l){return new Promise((function(u,c){var d=new FileReader;d.onload=function(l){var c=new DataView(l.target.result);if(a(c,0)===e){for(var d=c.byteLength,f=2;f<d;){var p=a(c,f);if(f+=2,p===t){if(s(c,f+=2)!==n)break;var h=a(c,f+=6)===i;f+=s(c,f+4,h);var g=a(c,f,h);f+=2;for(var m=0;m<g;m++)if(a(c,f+12*m,h)===r)return void u(a(c,f+12*m+8,h))}else{if((p&o)!==o)break;f+=a(c,f)}}u(-1)}else u(-1)},d.readAsArrayBuffer(l.slice(0,65536))}))})(h).then((function(e){l.setMetadata("exif",{orientation:e}),c(l)}))}))})),{options:{allowImageExifOrientation:[!0,f.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:d})),d}));var de={};
/*!
 * FilePondPluginImagePreview 4.6.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof de?de=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginImagePreview=t()}(void 0,(function(){"use strict";function e(e){this.wrapped=e}function t(t){var n,i;function r(n,i){try{var a=t[n](i),s=a.value,l=s instanceof e;Promise.resolve(l?s.wrapped:s).then((function(e){l?r("next",e):o(a.done?"return":"normal",e)}),(function(e){r("throw",e)}))}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?r(n.key,n.arg):i=null}this._invoke=function(e,t){return new Promise((function(o,a){var s={key:e,arg:t,resolve:o,reject:a,next:null};i?i=i.next=s:(n=i=s,r(e,t))}))},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)};function n(e,t){return i(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||r()}function i(e){if(Array.isArray(e))return e}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var o=function(e,t){return l(e.x*t,e.y*t)},a=function(e,t){return l(e.x+t.x,e.y+t.y)},s=function(e,t,n){var i=Math.cos(t),r=Math.sin(t),o=l(e.x-n.x,e.y-n.y);return l(n.x+i*o.x-r*o.y,n.y+r*o.x+i*o.y)},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:e,y:t}},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0;return"string"==typeof e?parseFloat(e)*n:"number"==typeof e?e*(i?t[i]:Math.min(t.width,t.height)):void 0},c=function(e){return null!=e},d=function(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(n,t[n])}))},f=function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);return t&&d(n,t),n},p={contain:"xMidYMid meet",cover:"xMidYMid slice"},h={left:"start",center:"middle",right:"end"},g=function(e){return function(t){return f(e,{id:t.id})}},m={image:function(e){var t=f("image",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return t.onload=function(){t.setAttribute("opacity",e.opacity||1)},t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.src),t},rect:g("rect"),ellipse:g("ellipse"),text:g("text"),path:g("path"),line:function(e){var t=f("g",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=f("line");t.appendChild(n);var i=f("path");t.appendChild(i);var r=f("path");return t.appendChild(r),t}},E={rect:function(e){return d(e,Object.assign({},e.rect,e.styles))},ellipse:function(e){var t=e.rect.x+.5*e.rect.width,n=e.rect.y+.5*e.rect.height,i=.5*e.rect.width,r=.5*e.rect.height;return d(e,Object.assign({cx:t,cy:n,rx:i,ry:r},e.styles))},image:function(e,t){d(e,Object.assign({},e.rect,e.styles,{preserveAspectRatio:p[t.fit]||"none"}))},text:function(e,t,n,i){var r=u(t.fontSize,n,i),o=t.fontFamily||"sans-serif",a=t.fontWeight||"normal",s=h[t.textAlign]||"start";d(e,Object.assign({},e.rect,e.styles,{"stroke-width":0,"font-weight":a,"font-size":r,"font-family":o,"text-anchor":s})),e.text!==t.text&&(e.text=t.text,e.textContent=t.text.length?t.text:" ")},path:function(e,t,n,i){var r;d(e,Object.assign({},e.styles,{fill:"none",d:(r=t.points.map((function(e){return{x:u(e.x,n,i,"width"),y:u(e.y,n,i,"height")}})),r.map((function(e,t){return"".concat(0===t?"M":"L"," ").concat(e.x," ").concat(e.y)})).join(" "))}))},line:function(e,t,n,i){d(e,Object.assign({},e.rect,e.styles,{fill:"none"}));var r=e.childNodes[0],c=e.childNodes[1],f=e.childNodes[2],p=e.rect,h={x:e.rect.x+e.rect.width,y:e.rect.y+e.rect.height};if(d(r,{x1:p.x,y1:p.y,x2:h.x,y2:h.y}),t.lineDecoration){c.style.display="none",f.style.display="none";var g=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return 0===t?{x:0,y:0}:l(e.x/t,e.y/t)}({x:h.x-p.x,y:h.y-p.y}),m=u(.05,n,i);if(-1!==t.lineDecoration.indexOf("arrow-begin")){var E=o(g,m),v=a(p,E),_=s(p,2,v),I=s(p,-2,v);d(c,{style:"display:block;",d:"M".concat(_.x,",").concat(_.y," L").concat(p.x,",").concat(p.y," L").concat(I.x,",").concat(I.y)})}if(-1!==t.lineDecoration.indexOf("arrow-end")){var y=o(g,-m),T=a(h,y),w=s(h,2,T),A=s(h,-2,T);d(f,{style:"display:block;",d:"M".concat(w.x,",").concat(w.y," L").concat(h.x,",").concat(h.y," L").concat(A.x,",").concat(A.y)})}}}},v=function(e,t,n,i,r){"path"!==t&&(e.rect=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=u(e.x,t,n,"width")||u(e.left,t,n,"width"),r=u(e.y,t,n,"height")||u(e.top,t,n,"height"),o=u(e.width,t,n,"width"),a=u(e.height,t,n,"height"),s=u(e.right,t,n,"width"),l=u(e.bottom,t,n,"height");return c(r)||(r=c(a)&&c(l)?t.height-a-l:l),c(i)||(i=c(o)&&c(s)?t.width-o-s:s),c(o)||(o=c(i)&&c(s)?t.width-i-s:0),c(a)||(a=c(r)&&c(l)?t.height-r-l:0),{x:i||0,y:r||0,width:o||0,height:a||0}}(n,i,r)),e.styles=function(e,t,n){var i=e.borderStyle||e.lineStyle||"solid",r=e.backgroundColor||e.fontColor||"transparent",o=e.borderColor||e.lineColor||"transparent",a=u(e.borderWidth||e.lineWidth,t,n);return{"stroke-linecap":e.lineCap||"round","stroke-linejoin":e.lineJoin||"round","stroke-width":a||0,"stroke-dasharray":"string"==typeof i?"":i.map((function(e){return u(e,t,n)})).join(","),stroke:o,fill:r,opacity:e.opacity||1}}(n,i,r),E[t](e,n,i,r)},_=["x","y","left","top","right","bottom","width","height"],I=function(e){var t=n(e,2),i=t[0],r=t[1],o=r.points?{}:_.reduce((function(e,t){var n;return e[t]="string"==typeof(n=r[t])&&/%/.test(n)?parseFloat(n)/100:n,e}),{});return[i,Object.assign({zIndex:0},r,o)]},y=function(e,t){return e[1].zIndex>t[1].zIndex?1:e[1].zIndex<t[1].zIndex?-1:0},T=function(e){return e.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:function(e){var t=e.root,i=e.props;if(i.dirty){var r=i.crop,o=i.resize,a=i.markup,s=i.width,l=i.height,u=r.width,c=r.height;if(o){var d=o.size,f=d&&d.width,p=d&&d.height,h=o.mode,g=o.upscale;f&&!p&&(p=f),p&&!f&&(f=p);var E=u<f&&c<p;if(!E||E&&g){var _,T=f/u,w=p/c;if("force"===h)u=f,c=p;else"cover"===h?_=Math.max(T,w):"contain"===h&&(_=Math.min(T,w)),u*=_,c*=_}}var A={width:s,height:l};t.element.setAttribute("width",A.width),t.element.setAttribute("height",A.height);var O=Math.min(s/u,l/c);t.element.innerHTML="";var R=t.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");a.filter(R).map(I).sort(y).forEach((function(e){var i=n(e,2),r=i[0],o=i[1],a=function(e,t){return m[e](t)}(r,o);v(a,r,o,A,O),t.element.appendChild(a)}))}}})},w=function(e,t){return{x:e,y:t}},A=function(e,t){return w(e.x-t.x,e.y-t.y)},O=function(e,t){return Math.sqrt(function(e,t){return function(e,t){return e.x*t.x+e.y*t.y}(A(e,t),A(e,t))}(e,t))},R=function(e,t){var n=e,i=t,r=1.5707963267948966-t,o=Math.sin(1.5707963267948966),a=Math.sin(i),s=Math.sin(r),l=Math.cos(r),u=n/o;return w(l*(u*a),l*(u*s))},S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.height/e.width,r=1,o=t,a=1,s=i;s>o&&(a=(s=o)/i);var l=Math.max(r/a,o/s),u=e.width/(n*l*a),c=u*t;return{width:u,height:c}},b=function(e,t,n,i){var r=i.x>.5?1-i.x:i.x,o=i.y>.5?1-i.y:i.y,a=2*r*e.width,s=2*o*e.height,l=function(e,t){var n=e.width,i=e.height,r=R(n,t),o=R(i,t),a=w(e.x+Math.abs(r.x),e.y-Math.abs(r.y)),s=w(e.x+e.width+Math.abs(o.y),e.y+Math.abs(o.x)),l=w(e.x-Math.abs(o.y),e.y+e.height-Math.abs(o.x));return{width:O(a,s),height:O(a,l)}}(t,n);return Math.max(l.width/a,l.height/s)},M=function(e,t){var n=e.width,i=n*t;return i>e.height&&(n=(i=e.height)/t),{x:.5*(e.width-n),y:.5*(e.height-i),width:n,height:i}},C={type:"spring",stiffness:.5,damping:.45,mass:10},P=function(e){return e.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function(e){var t=e.root,n=e.props;n.background&&(t.element.style.backgroundColor=n.background)},create:function(t){var n=t.root,i=t.props;n.ref.image=n.appendChildView(n.createChildView(function(e){return e.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:C,originY:C,scaleX:C,scaleY:C,translateX:C,translateY:C,rotateZ:C}},create:function(t){var n=t.root,i=t.props;i.width=i.image.width,i.height=i.image.height,n.ref.bitmap=n.appendChildView(n.createChildView(function(e){return e.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:function(e){var t=e.root,n=e.props;t.appendChild(n.image)}})}(e),{image:i.image}))},write:function(e){var t=e.root,n=e.props.crop.flip,i=t.ref.bitmap;i.scaleX=n.horizontal?-1:1,i.scaleY=n.vertical?-1:1}})}(e),Object.assign({},i))),n.ref.createMarkup=function(){n.ref.markup||(n.ref.markup=n.appendChildView(n.createChildView(T(e),Object.assign({},i))))},n.ref.destroyMarkup=function(){n.ref.markup&&(n.removeChildView(n.ref.markup),n.ref.markup=null)};var r=n.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");null!==r&&(n.element.dataset.transparencyIndicator="grid"===r?r:"color")},write:function(e){var t=e.root,n=e.props,i=e.shouldOptimize,r=n.crop,o=n.markup,a=n.resize,s=n.dirty,l=n.width,u=n.height;t.ref.image.crop=r;var c={x:0,y:0,width:l,height:u,center:{x:.5*l,y:.5*u}},d={width:t.ref.image.width,height:t.ref.image.height},f={x:r.center.x*d.width,y:r.center.y*d.height},p={x:c.center.x-d.width*r.center.x,y:c.center.y-d.height*r.center.y},h=2*Math.PI+r.rotation%(2*Math.PI),g=r.aspectRatio||d.height/d.width,m=void 0===r.scaleToFit||r.scaleToFit,E=b(d,M(c,g),h,m?r.center:{x:.5,y:.5}),v=r.zoom*E;o&&o.length?(t.ref.createMarkup(),t.ref.markup.width=l,t.ref.markup.height=u,t.ref.markup.resize=a,t.ref.markup.dirty=s,t.ref.markup.markup=o,t.ref.markup.crop=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.zoom,i=t.rotation,r=t.center,o=t.aspectRatio;o||(o=e.height/e.width);var a=S(e,o,n),s={x:.5*a.width,y:.5*a.height},l={x:0,y:0,width:a.width,height:a.height,center:s},u=void 0===t.scaleToFit||t.scaleToFit,c=b(e,M(l,o),i,u?r:{x:.5,y:.5}),d=n*c;return{widthFloat:a.width/d,heightFloat:a.height/d,width:Math.round(a.width/d),height:Math.round(a.height/d)}}(d,r)):t.ref.markup&&t.ref.destroyMarkup();var _=t.ref.image;if(i)return _.originX=null,_.originY=null,_.translateX=null,_.translateY=null,_.rotateZ=null,_.scaleX=null,void(_.scaleY=null);_.originX=f.x,_.originY=f.y,_.translateX=p.x,_.translateY=p.y,_.rotateZ=h,_.scaleX=v,_.scaleY=v}})},L='<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">\n    <defs>\n        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">\n            <stop offset=\'50%\' stop-color=\'#000000\'/>\n            <stop offset=\'56%\' stop-color=\'#0a0a0a\'/>\n            <stop offset=\'63%\' stop-color=\'#262626\'/>\n            <stop offset=\'69%\' stop-color=\'#4f4f4f\'/>\n            <stop offset=\'75%\' stop-color=\'#808080\'/>\n            <stop offset=\'81%\' stop-color=\'#b1b1b1\'/>\n            <stop offset=\'88%\' stop-color=\'#dadada\'/>\n            <stop offset=\'94%\' stop-color=\'#f6f6f6\'/>\n            <stop offset=\'100%\' stop-color=\'#ffffff\'/>\n        </radialGradient>\n        <mask id="mask-__UID__">\n            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>\n        </mask>\n    </defs>\n    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>\n</svg>',D=!1,x=0,G=function(){self.onmessage=function(e){createImageBitmap(e.data.message.file).then((function(t){self.postMessage({id:e.data.id,message:t},[t])}))}},N=function(){self.onmessage=function(e){for(var t=e.data.message.imageData,n=e.data.message.colorMatrix,i=t.data,r=i.length,o=n[0],a=n[1],s=n[2],l=n[3],u=n[4],c=n[5],d=n[6],f=n[7],p=n[8],h=n[9],g=n[10],m=n[11],E=n[12],v=n[13],_=n[14],I=n[15],y=n[16],T=n[17],w=n[18],A=n[19],O=0,R=0,S=0,b=0,M=0;O<r;O+=4)R=i[O]/255,S=i[O+1]/255,b=i[O+2]/255,M=i[O+3]/255,i[O]=Math.max(0,Math.min(255*(R*o+S*a+b*s+M*l+u),255)),i[O+1]=Math.max(0,Math.min(255*(R*c+S*d+b*f+M*p+h),255)),i[O+2]=Math.max(0,Math.min(255*(R*g+S*m+b*E+M*v+_),255)),i[O+3]=Math.max(0,Math.min(255*(R*I+S*y+b*T+M*w+A),255));self.postMessage({id:e.data.id,message:t},[t.data.buffer])}},F={1:function(){return[1,0,0,1,0,0]},2:function(e){return[-1,0,0,1,e,0]},3:function(e,t){return[-1,0,0,-1,e,t]},4:function(e,t){return[1,0,0,-1,0,t]},5:function(){return[0,1,1,0,0,0]},6:function(e,t){return[0,1,-1,0,t,0]},7:function(e,t){return[0,-1,-1,0,t,e]},8:function(e){return[0,-1,1,0,0,e]}},k=function(e,t,n,i){t=Math.round(t),n=Math.round(n);var r=document.createElement("canvas");r.width=t,r.height=n;var o=r.getContext("2d");if(i>=5&&i<=8){var a=[n,t];t=a[0],n=a[1]}return function(e,t,n,i){-1!==i&&e.transform.apply(e,F[i](t,n))}(o,t,n,i),o.drawImage(e,0,0,t,n),r},V=function(e){return/^image/.test(e.type)&&!/svg/.test(e.type)},U=function(e,t){return Math.floor(Math.sqrt(e/(t/4)))},B=function(e){var t=e.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:function(e){var t=e.root,n=e.props;!D&&document.querySelector("base")&&(L=L.replace(/url\(\#/g,"url("+window.location.href.replace(window.location.hash,"")+"#"),D=!0),x++,t.element.classList.add("filepond--image-preview-overlay-".concat(n.status)),t.element.innerHTML=L.replace(/__UID__/g,x)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),n=function(e){return e.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:C,scaleY:C,translateY:C,opacity:{type:"tween",duration:400}}},create:function(t){var n=t.root,i=t.props;n.ref.clip=n.appendChildView(n.createChildView(P(e),{id:i.id,image:i.image,crop:i.crop,markup:i.markup,resize:i.resize,dirty:i.dirty,background:i.background}))},write:function(e){var t=e.root,n=e.props,i=e.shouldOptimize,r=t.ref.clip,o=n.image,a=n.crop,s=n.markup,l=n.resize,u=n.dirty;if(r.crop=a,r.markup=s,r.resize=l,r.dirty=u,r.opacity=i?0:1,!i&&!t.rect.element.hidden){var c=o.height/o.width,d=a.aspectRatio||c,f=t.rect.inner.width,p=t.rect.inner.height,h=t.query("GET_IMAGE_PREVIEW_HEIGHT"),g=t.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),m=t.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),E=t.query("GET_PANEL_ASPECT_RATIO"),v=t.query("GET_ALLOW_MULTIPLE");E&&!v&&(h=f*E,d=E);var _=null!==h?h:Math.max(g,Math.min(f*d,m)),I=_/d;I>f&&(_=(I=f)*d),_>p&&(_=p,I=p/d),r.width=I,r.height=_}}})}(e),i=e.utils.createWorker,r=function(e,t,n){return new Promise((function(r){e.ref.imageData||(e.ref.imageData=n.getContext("2d").getImageData(0,0,n.width,n.height));var o=function(e){var t;try{t=new ImageData(e.width,e.height)}catch(n){t=document.createElement("canvas").getContext("2d").createImageData(e.width,e.height)}return t.data.set(new Uint8ClampedArray(e.data)),t}(e.ref.imageData);if(!t||20!==t.length)return n.getContext("2d").putImageData(o,0,0),r();var a=i(N);a.post({imageData:o,colorMatrix:t},(function(e){n.getContext("2d").putImageData(e,0,0),a.terminate(),r()}),[o.data.buffer])}))},o=function(e){var t=e.root,i=e.props,r=e.image,o=i.id,a=t.query("GET_ITEM",{id:o});if(a){var s,l,u=a.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},c=t.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),d=!1;t.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(s=a.getMetadata("markup")||[],l=a.getMetadata("resize"),d=!0);var f=t.appendChildView(t.createChildView(n,{id:o,image:r,crop:u,resize:l,markup:s,dirty:d,background:c,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),t.childViews.length);t.ref.images.push(f),f.opacity=1,f.scaleX=1,f.scaleY=1,f.translateY=0,setTimeout((function(){t.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:o})}),250)}},a=function(e){var t=e.root;t.ref.overlayShadow.opacity=1,t.ref.overlayError.opacity=0,t.ref.overlaySuccess.opacity=0},s=function(e){var t=e.root;t.ref.overlayShadow.opacity=.25,t.ref.overlayError.opacity=1};return e.utils.createView({name:"image-preview-wrapper",create:function(e){var n=e.root;n.ref.images=[],n.ref.imageData=null,n.ref.imageViewBin=[],n.ref.overlayShadow=n.appendChildView(n.createChildView(t,{opacity:0,status:"idle"})),n.ref.overlaySuccess=n.appendChildView(n.createChildView(t,{opacity:0,status:"success"})),n.ref.overlayError=n.appendChildView(n.createChildView(t,{opacity:0,status:"failure"}))},styles:["height"],apis:["height"],destroy:function(e){e.root.ref.images.forEach((function(e){e.image.width=1,e.image.height=1}))},didWriteView:function(e){e.root.ref.images.forEach((function(e){e.dirty=!1}))},write:e.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:function(e){var t=e.root,n=t.ref.images[t.ref.images.length-1];n.translateY=0,n.scaleX=1,n.scaleY=1,n.opacity=1},DID_IMAGE_PREVIEW_CONTAINER_CREATE:function(e){var t=e.root,n=e.props.id,i=t.query("GET_ITEM",n);if(i){var r,o,a,s=URL.createObjectURL(i.file);r=s,o=function(e,i){t.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:n,width:e,height:i})},(a=new Image).onload=function(){var e=a.naturalWidth,t=a.naturalHeight;a=null,o(e,t)},a.src=r}},DID_FINISH_CALCULATE_PREVIEWSIZE:function(e){var t=e.root,n=e.props,a=n.id,s=t.query("GET_ITEM",a);if(s){var l,u,c=URL.createObjectURL(s.file),d=function(){var e;(e=c,new Promise((function(t,n){var i=new Image;i.crossOrigin="Anonymous",i.onload=function(){t(i)},i.onerror=function(e){n(e)},i.src=e}))).then(f)},f=function(e){URL.revokeObjectURL(c);var i=(s.getMetadata("exif")||{}).orientation||-1,a=e.width,l=e.height;if(i>=5&&i<=8){var u=[l,a];a=u[0],l=u[1]}var d=Math.max(1,.75*window.devicePixelRatio),f=t.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*d,p=l/a,h=t.rect.element.width,g=t.rect.element.height,m=h,E=m*p;p>1?E=(m=Math.min(a,h*f))*p:m=(E=Math.min(l,g*f))/p;var v=k(e,m,E,i),_=function(){var i=t.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?function(e){var t=Math.min(10/e.width,10/e.height),n=document.createElement("canvas"),i=n.getContext("2d"),r=n.width=Math.ceil(e.width*t),o=n.height=Math.ceil(e.height*t);i.drawImage(e,0,0,r,o);var a=null;try{a=i.getImageData(0,0,r,o).data}catch(e){return null}for(var s=a.length,l=0,u=0,c=0,d=0;d<s;d+=4)l+=a[d]*a[d],u+=a[d+1]*a[d+1],c+=a[d+2]*a[d+2];return{r:l=U(l,s),g:u=U(u,s),b:c=U(c,s)}}(data):null;s.setMetadata("color",i,!0),"close"in e&&e.close(),t.ref.overlayShadow.opacity=1,o({root:t,props:n,image:v})},I=s.getMetadata("filter");I?r(t,I,v).then(_):_()};if(l=s.file,((u=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./))?parseInt(u[1]):null)<=58||!("createImageBitmap"in window)||!V(l))d();else{var p=i(G);p.post({file:s.file},(function(e){p.terminate(),e?f(e):d()}))}}},DID_UPDATE_ITEM_METADATA:function(e){var t=e.root,n=e.props,i=e.action;if(/crop|filter|markup|resize/.test(i.change.key)&&t.ref.images.length){var a=t.query("GET_ITEM",{id:n.id});if(a)if(/filter/.test(i.change.key)){var s=t.ref.images[t.ref.images.length-1];r(t,i.change.value,s.image)}else{if(/crop|markup|resize/.test(i.change.key)){var l=a.getMetadata("crop"),u=t.ref.images[t.ref.images.length-1];if(Math.abs(l.aspectRatio-u.crop.aspectRatio)>1e-5){var c=function(e){var t=e.root,n=t.ref.images.shift();return n.opacity=0,n.translateY=-15,t.ref.imageViewBin.push(n),n}({root:t});o({root:t,props:n,image:(d=c.image,(f=f||document.createElement("canvas")).width=d.width,f.height=d.height,f.getContext("2d").drawImage(d,0,0),f)})}else!function(e){var t=e.root,n=e.props,i=t.query("GET_ITEM",{id:n.id});if(i){var r=t.ref.images[t.ref.images.length-1];r.crop=i.getMetadata("crop"),r.background=t.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),t.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(r.dirty=!0,r.resize=i.getMetadata("resize"),r.markup=i.getMetadata("markup"))}}({root:t,props:n})}var d,f}}},DID_THROW_ITEM_LOAD_ERROR:s,DID_THROW_ITEM_PROCESSING_ERROR:s,DID_THROW_ITEM_INVALID:s,DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root;t.ref.overlayShadow.opacity=.25,t.ref.overlaySuccess.opacity=1},DID_START_ITEM_PROCESSING:a,DID_REVERT_ITEM_PROCESSING:a},(function(e){var t=e.root,n=t.ref.imageViewBin.filter((function(e){return 0===e.opacity}));t.ref.imageViewBin=t.ref.imageViewBin.filter((function(e){return e.opacity>0})),n.forEach((function(e){return function(e,t){e.removeChildView(t),t.image.width=1,t.image.height=1,t._destroy()}(t,e)})),n.length=0}))})},q=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.createRoute,o=n.isFile,a=B(e);return t("CREATE_VIEW",(function(e){var t=e.is,n=e.view,i=e.query;if(t("file")&&i("GET_ALLOW_IMAGE_PREVIEW")){var s=function(e){e.root.ref.shouldRescale=!0};n.registerWriter(r({DID_RESIZE_ROOT:s,DID_STOP_RESIZE:s,DID_LOAD_ITEM:function(e){var t=e.root,r=e.props.id,s=i("GET_ITEM",r);if(s&&o(s.file)&&!s.archived){var l=s.file;if(function(e){return/^image/.test(e.type)}(l)&&i("GET_IMAGE_PREVIEW_FILTER_ITEM")(s)){var u="createImageBitmap"in(window||{}),c=i("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!(!u&&c&&l.size>c)){t.ref.imagePreview=n.appendChildView(n.createChildView(a,{id:r}));var d=t.query("GET_IMAGE_PREVIEW_HEIGHT");d&&t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:s.id,height:d});var f=!u&&l.size>i("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");t.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:r},f)}}}},DID_IMAGE_PREVIEW_CALCULATE_SIZE:function(e){var t=e.root,n=e.action;t.ref.imageWidth=n.width,t.ref.imageHeight=n.height,t.ref.shouldRescale=!0,t.ref.shouldDrawPreview=!0,t.dispatch("KICK")},DID_UPDATE_ITEM_METADATA:function(e){var t=e.root;"crop"===e.action.change.key&&(t.ref.shouldRescale=!0)}},(function(e){var t=e.root,n=e.props;t.ref.imagePreview&&(t.rect.element.hidden||(t.ref.shouldRescale&&(!function(e,t){if(e.ref.imagePreview){var n=t.id,i=e.query("GET_ITEM",{id:n});if(i){var r=e.query("GET_PANEL_ASPECT_RATIO"),o=e.query("GET_ITEM_PANEL_ASPECT_RATIO"),a=e.query("GET_IMAGE_PREVIEW_HEIGHT");if(!(r||o||a)){var s=e.ref,l=s.imageWidth,u=s.imageHeight;if(l&&u){var c=e.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),d=e.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),f=(i.getMetadata("exif")||{}).orientation||-1;if(f>=5&&f<=8){var p=[u,l];l=p[0],u=p[1]}if(!V(i.file)||e.query("GET_IMAGE_PREVIEW_UPSCALE")){var h=2048/l;l*=h,u*=h}var g=u/l,m=(i.getMetadata("crop")||{}).aspectRatio||g,E=Math.max(c,Math.min(u,d)),v=e.rect.element.width,_=Math.min(v*m,E);e.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:i.id,height:_})}}}}}(t,n),t.ref.shouldRescale=!1),t.ref.shouldDrawPreview&&(requestAnimationFrame((function(){t.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:n.id})})),t.ref.shouldDrawPreview=!1)))})))}})),{options:{allowImagePreview:[!0,i.BOOLEAN],imagePreviewFilterItem:[function(){return!0},i.FUNCTION],imagePreviewHeight:[null,i.INT],imagePreviewMinHeight:[44,i.INT],imagePreviewMaxHeight:[256,i.INT],imagePreviewMaxFileSize:[null,i.INT],imagePreviewZoomFactor:[2,i.INT],imagePreviewUpscale:[!1,i.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,i.INT],imagePreviewTransparencyIndicator:[null,i.STRING],imagePreviewCalculateAverageImageColor:[!1,i.BOOLEAN],imagePreviewMarkupShow:[!0,i.BOOLEAN],imagePreviewMarkupFilter:[function(){return!0},i.FUNCTION]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:q})),q}));
/*!
 * FilePondPluginImageEdit 1.6.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */
var fe=function(e){return/^image/.test(e.type)},pe=function(e){var t=e.addFilter,n=e.utils,i=e.views,r=n.Type,o=n.createRoute,a=n.createItemAPI,s=void 0===a?function(e){return e}:a,l=i.fileActionButton;t("SHOULD_REMOVE_ON_REVERT",(function(e,t){var n=t.item,i=t.query;return new Promise((function(e){var t=n.file;e(!(i("GET_ALLOW_IMAGE_EDIT")&&i("GET_IMAGE_EDIT_ALLOW_EDIT")&&i("GET_IMAGE_EDIT_SUPPORT_IMAGE")(t)))}))})),t("DID_LOAD_ITEM",(function(e,t){var n=t.query,i=t.dispatch;return new Promise((function(t,r){if(e.origin>1)t(e);else{var o=e.file;if(n("GET_ALLOW_IMAGE_EDIT")&&n("GET_IMAGE_EDIT_INSTANT_EDIT"))if(n("GET_IMAGE_EDIT_SUPPORT_IMAGE")(o)){var a=function(e,t,n){return function(r){u.shift(),r?t(e):n(e),i("KICK"),s()}},s=function(){if(u.length){var e=u[0],t=e.item,n=e.resolve,r=e.reject;i("EDIT_ITEM",{id:t.id,handleEditorResponse:a(t,n,r)})}};c({item:e,resolve:t,reject:r}),1===u.length&&s()}else t(e);else t(e)}}))})),t("DID_CREATE_ITEM",(function(e,t){t.query;var n=t.dispatch;e.extend("edit",(function(){n("EDIT_ITEM",{id:e.id})}))}));var u=[],c=function(e){return u.push(e),e};return t("CREATE_VIEW",(function(e){var t=e.is,n=e.view,i=e.query;if(i("GET_ALLOW_IMAGE_EDIT")){var r=i("GET_ALLOW_IMAGE_PREVIEW");if(t("file-info")&&!r||t("file")&&r){var a=i("GET_IMAGE_EDIT_EDITOR");if(a){a.filepondCallbackBridge||(a.outputData=!0,a.outputFile=!1,a.filepondCallbackBridge={onconfirm:a.onconfirm||function(){},oncancel:a.oncancel||function(){}});n.registerDestroyer((function(e){var t=e.root;t.ref.buttonEditItem&&t.ref.buttonEditItem.off("click",t.ref.handleEdit),t.ref.editButton&&t.ref.editButton.removeEventListener("click",t.ref.handleEdit)}));var u={EDIT_ITEM:function(e){var t=e.root,n=e.props,i=e.action,r=n.id,o=i.handleEditorResponse;a.cropAspectRatio=t.query("GET_IMAGE_CROP_ASPECT_RATIO")||a.cropAspectRatio,a.outputCanvasBackgroundColor=t.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||a.outputCanvasBackgroundColor;var l=t.query("GET_ITEM",r);if(l){var u=l.file,c=l.getMetadata("crop"),d=l.getMetadata("resize"),f=l.getMetadata("filter")||null,p=l.getMetadata("filters")||null,h=l.getMetadata("colors")||null,g=l.getMetadata("markup")||null,m={crop:c||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},size:d?{upscale:d.upscale,mode:d.mode,width:d.size.width,height:d.size.height}:null,filter:p?p.id||p.matrix:t.query("GET_ALLOW_IMAGE_FILTER")&&t.query("GET_IMAGE_FILTER_COLOR_MATRIX")&&!h?f:null,color:h,markup:g};a.onconfirm=function(e){var t=e.data,n=t.crop,i=t.size,r=t.filter,u=t.color,c=t.colorMatrix,d=t.markup,f={};if(n&&(f.crop=n),i){var p=(l.getMetadata("resize")||{}).size,h={width:i.width,height:i.height};h.width&&h.height||!p||(h.width=p.width,h.height=p.height),(h.width||h.height)&&(f.resize={upscale:i.upscale,mode:i.mode,size:h})}d&&(f.markup=d),f.colors=u,f.filters=r,f.filter=c,l.setMetadata(f),a.filepondCallbackBridge.onconfirm(t,s(l)),o&&(a.onclose=function(){o(!0),a.onclose=null})},a.oncancel=function(){a.filepondCallbackBridge.oncancel(s(l)),o&&(a.onclose=function(){o(!1),a.onclose=null})},a.open(u,m)}},DID_LOAD_ITEM:function(e){var t=e.root,o=e.props;if(i("GET_IMAGE_EDIT_ALLOW_EDIT")){var a=o.id,s=i("GET_ITEM",a);if(s){var u=s.file;if(i("GET_IMAGE_EDIT_SUPPORT_IMAGE")(u))if(t.ref.handleEdit=function(e){e.stopPropagation(),t.dispatch("EDIT_ITEM",{id:a})},r){var c=n.createChildView(l,{label:"edit",icon:i("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});c.element.classList.add("filepond--action-edit-item"),c.element.dataset.align=i("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),c.on("click",t.ref.handleEdit),t.ref.buttonEditItem=n.appendChildView(c)}else{var d=n.element.querySelector(".filepond--file-info-main"),f=document.createElement("button");f.className="filepond--action-edit-item-alt",f.innerHTML=i("GET_IMAGE_EDIT_ICON_EDIT")+"<span>edit</span>",f.addEventListener("click",t.ref.handleEdit),d.appendChild(f),t.ref.editButton=f}}}}};if(r){u.DID_IMAGE_PREVIEW_SHOW=function(e){var t=e.root;t.ref.buttonEditItem&&(t.ref.buttonEditItem.opacity=1)}}n.registerWriter(o(u))}}}})),{options:{allowImageEdit:[!0,r.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",r.STRING],imageEditInstantEdit:[!1,r.BOOLEAN],imageEditAllowEdit:[!0,r.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',r.STRING],imageEditEditor:[null,r.OBJECT],imageEditSupportImage:[fe,r.FUNCTION]}}};"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:pe}));var he=pe,ge={};
/*!
 * FilePondPluginImageCrop 2.0.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof ge?ge=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginImageCrop=t()}(ge,(function(){"use strict";var e=function(e){return/^image/.test(e.type)},t=function(t){var n=t.addFilter,i=t.utils,r=i.Type,o=i.isFile,a=i.getNumericAspectRatioFromString,s=function(t,n){return!(!e(t.file)||!n("GET_ALLOW_IMAGE_CROP"))},l=function(e){return"object"==typeof e},u=function(e){return"number"==typeof e},c=function(e,t){return e.setMetadata("crop",Object.assign({},e.getMetadata("crop"),t))};return n("DID_CREATE_ITEM",(function(e,t){var n=t.query;e.extend("setImageCrop",(function(t){if(s(e,n)&&l(center))return e.setMetadata("crop",t),t})),e.extend("setImageCropCenter",(function(t){if(s(e,n)&&l(t))return c(e,{center:t})})),e.extend("setImageCropZoom",(function(t){if(s(e,n)&&u(t))return c(e,{zoom:Math.max(1,t)})})),e.extend("setImageCropRotation",(function(t){if(s(e,n)&&u(t))return c(e,{rotation:t})})),e.extend("setImageCropFlip",(function(t){if(s(e,n)&&l(t))return c(e,{flip:t})})),e.extend("setImageCropAspectRatio",(function(t){if(s(e,n)&&void 0!==t){var i=e.getMetadata("crop"),r=a(t),o={center:{x:.5,y:.5},flip:i?Object.assign({},i.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:r};return e.setMetadata("crop",o),o}}))})),n("DID_LOAD_ITEM",(function(t,n){var i=n.query;return new Promise((function(n,r){var s=t.file;if(!o(s)||!e(s)||!i("GET_ALLOW_IMAGE_CROP"))return n(t);if(t.getMetadata("crop"))return n(t);var l=i("GET_IMAGE_CROP_ASPECT_RATIO");t.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:l?a(l):null}),n(t)}))})),{options:{allowImageCrop:[!0,r.BOOLEAN],imageCropAspectRatio:[null,r.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t}));var me={};
/*!
 * FilePondPluginImageResize 2.0.7
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof me?me=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginImageResize=t()}(me,(function(){"use strict";var e=function(e){var t=e.addFilter,n=e.utils.Type;return t("DID_LOAD_ITEM",(function(e,t){var n=t.query;return new Promise((function(t,i){var r=e.file;if(!function(e){return/^image/.test(e.type)}(r)||!n("GET_ALLOW_IMAGE_RESIZE"))return t(e);var o=n("GET_IMAGE_RESIZE_MODE"),a=n("GET_IMAGE_RESIZE_TARGET_WIDTH"),s=n("GET_IMAGE_RESIZE_TARGET_HEIGHT"),l=n("GET_IMAGE_RESIZE_UPSCALE");if(null===a&&null===s)return t(e);var u,c,d,f=null===a?s:a,p=null===s?f:s,h=URL.createObjectURL(r);u=h,c=function(n){if(URL.revokeObjectURL(h),!n)return t(e);var i=n.width,r=n.height,a=(e.getMetadata("exif")||{}).orientation||-1;if(a>=5&&a<=8){var s=[r,i];i=s[0],r=s[1]}return i===f&&r===p||i<=f&&r<=p&&!l?t(e):(e.setMetadata("resize",{mode:o,upscale:l,size:{width:f,height:p}}),void t(e))},(d=new Image).onload=function(){var e=d.naturalWidth,t=d.naturalHeight;d=null,c({width:e,height:t})},d.onerror=function(){return c(null)},d.src=u}))})),{options:{allowImageResize:[!0,n.BOOLEAN],imageResizeMode:["cover",n.STRING],imageResizeUpscale:[!0,n.BOOLEAN],imageResizeTargetWidth:[null,n.INT],imageResizeTargetHeight:[null,n.INT]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}));var Ee={};
/*!
 * FilePondPluginImageTransform 3.7.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e,t){"object"==typeof Ee?Ee=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FilePondPluginImageTransform=t()}(void 0,(function(){"use strict";var e={jpeg:"jpg","svg+xml":"svg"},t=function(e){return/^image/.test(e.type)},n={1:function(){return[1,0,0,1,0,0]},2:function(e){return[-1,0,0,1,e,0]},3:function(e,t){return[-1,0,0,-1,e,t]},4:function(e,t){return[1,0,0,-1,0,t]},5:function(){return[0,1,1,0,0,0]},6:function(e,t){return[0,1,-1,0,t,0]},7:function(e,t){return[0,-1,-1,0,t,e]},8:function(e){return[0,-1,1,0,0,e]}},i=function(e,t){return{x:e,y:t}},r=function(e,t){return i(e.x-t.x,e.y-t.y)},o=function(e,t){return Math.sqrt(function(e,t){return function(e,t){return e.x*t.x+e.y*t.y}(r(e,t),r(e,t))}(e,t))},a=function(e,t){var n=e,r=t,o=1.5707963267948966-t,a=Math.sin(1.5707963267948966),s=Math.sin(r),l=Math.sin(o),u=Math.cos(o),c=n/a;return i(u*(c*s),u*(c*l))},s=function(e,t){var n=e.width,r=e.height,s=a(n,t),l=a(r,t),u=i(e.x+Math.abs(s.x),e.y-Math.abs(s.y)),c=i(e.x+e.width+Math.abs(l.y),e.y+Math.abs(l.x)),d=i(e.x-Math.abs(l.y),e.y+e.height-Math.abs(l.x));return{width:o(u,c),height:o(u,d)}},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:.5,y:.5},r=i.x>.5?1-i.x:i.x,o=i.y>.5?1-i.y:i.y,a=2*r*e.width,l=2*o*e.height,u=s(t,n);return Math.max(u.width/a,u.height/l)},u=function(e,t){var n=e.width,i=n*t;return i>e.height&&(n=(i=e.height)/t),{x:.5*(e.width-n),y:.5*(e.height-i),width:n,height:i}},c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.height/e.width,r=1,o=t,a=1,s=i;s>o&&(a=(s=o)/i);var l=Math.max(r/a,o/s),u=e.width/(n*l*a),c=u*t;return{width:u,height:c}},d=function(e){e.width=1,e.height=1,e.getContext("2d").clearRect(0,0,1,1)},f=function(e){return e&&(e.horizontal||e.vertical)},p=function(e,t,i){if(t<=1&&!f(i))return e.width=e.naturalWidth,e.height=e.naturalHeight,e;var r=document.createElement("canvas"),o=e.naturalWidth,a=e.naturalHeight,s=t>=5&&t<=8;s?(r.width=a,r.height=o):(r.width=o,r.height=a);var l=r.getContext("2d");if(t&&l.transform.apply(l,function(e,t,i){return-1===i&&(i=1),n[i](e,t)}(o,a,t)),f(i)){var u=[1,0,0,1,0,0];(!s&&i.horizontal||s&i.vertical)&&(u[0]=-1,u[4]=o),(!s&&i.vertical||s&&i.horizontal)&&(u[3]=-1,u[5]=a),l.transform.apply(l,u)}return l.drawImage(e,0,0,o,a),r},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i.canvasMemoryLimit,o=i.background,a=void 0===o?null:o,s=n.zoom||1,f=p(e,t,n.flip),h={width:f.width,height:f.height},g=n.aspectRatio||h.height/h.width,m=c(h,g,s);if(r){var E=m.width*m.height;if(E>r){var v=Math.sqrt(r)/Math.sqrt(E);h.width=Math.floor(h.width*v),h.height=Math.floor(h.height*v),m=c(h,g,s)}}var _=document.createElement("canvas"),I={x:.5*m.width,y:.5*m.height},y={x:0,y:0,width:m.width,height:m.height,center:I},T=void 0===n.scaleToFit||n.scaleToFit,w=s*l(h,u(y,g),n.rotation,T?n.center:{x:.5,y:.5});_.width=Math.round(m.width/w),_.height=Math.round(m.height/w),I.x/=w,I.y/=w;var A={x:I.x-h.width*(n.center?n.center.x:.5),y:I.y-h.height*(n.center?n.center.y:.5)},O=_.getContext("2d");a&&(O.fillStyle=a,O.fillRect(0,0,_.width,_.height)),O.translate(I.x,I.y),O.rotate(n.rotation||0),O.drawImage(f,A.x-I.x,A.y-I.y,h.width,h.height);var R=O.getImageData(0,0,_.width,_.height);return d(_),R};"undefined"!=typeof window&&void 0!==window.document&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var i=this.toDataURL(t,n).split(",")[1];setTimeout((function(){for(var n=atob(i),r=n.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}))}))}}));var g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(i){var r=n?n(e):e;Promise.resolve(r).then((function(e){e.toBlob(i,t.type,t.quality)}))}))},m=function(e,t){return I(e.x*t,e.y*t)},E=function(e,t){return I(e.x+t.x,e.y+t.y)},v=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return 0===t?{x:0,y:0}:I(e.x/t,e.y/t)},_=function(e,t,n){var i=Math.cos(t),r=Math.sin(t),o=I(e.x-n.x,e.y-n.y);return I(n.x+i*o.x-r*o.y,n.y+r*o.x+i*o.y)},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:e,y:t}},y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0;return"string"==typeof e?parseFloat(e)*n:"number"==typeof e?e*(i?t[i]:Math.min(t.width,t.height)):void 0},T=function(e,t,n){var i=e.borderStyle||e.lineStyle||"solid",r=e.backgroundColor||e.fontColor||"transparent",o=e.borderColor||e.lineColor||"transparent",a=y(e.borderWidth||e.lineWidth,t,n);return{"stroke-linecap":e.lineCap||"round","stroke-linejoin":e.lineJoin||"round","stroke-width":a||0,"stroke-dasharray":"string"==typeof i?"":i.map((function(e){return y(e,t,n)})).join(","),stroke:o,fill:r,opacity:e.opacity||1}},w=function(e){return null!=e},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=y(e.x,t,n,"width")||y(e.left,t,n,"width"),r=y(e.y,t,n,"height")||y(e.top,t,n,"height"),o=y(e.width,t,n,"width"),a=y(e.height,t,n,"height"),s=y(e.right,t,n,"width"),l=y(e.bottom,t,n,"height");return w(r)||(r=w(a)&&w(l)?t.height-a-l:l),w(i)||(i=w(o)&&w(s)?t.width-o-s:s),w(o)||(o=w(i)&&w(s)?t.width-i-s:0),w(a)||(a=w(r)&&w(l)?t.height-r-l:0),{x:i||0,y:r||0,width:o||0,height:a||0}},O=function(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(n,t[n])}))},R=function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);return t&&O(n,t),n},S={contain:"xMidYMid meet",cover:"xMidYMid slice"},b={left:"start",center:"middle",right:"end"},M=function(e){return function(t){return R(e,{id:t.id})}},C={image:function(e){var t=R("image",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return t.onload=function(){t.setAttribute("opacity",e.opacity||1)},t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.src),t},rect:M("rect"),ellipse:M("ellipse"),text:M("text"),path:M("path"),line:function(e){var t=R("g",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=R("line");t.appendChild(n);var i=R("path");t.appendChild(i);var r=R("path");return t.appendChild(r),t}},P={rect:function(e){return O(e,Object.assign({},e.rect,e.styles))},ellipse:function(e){var t=e.rect.x+.5*e.rect.width,n=e.rect.y+.5*e.rect.height,i=.5*e.rect.width,r=.5*e.rect.height;return O(e,Object.assign({cx:t,cy:n,rx:i,ry:r},e.styles))},image:function(e,t){O(e,Object.assign({},e.rect,e.styles,{preserveAspectRatio:S[t.fit]||"none"}))},text:function(e,t,n,i){var r=y(t.fontSize,n,i),o=t.fontFamily||"sans-serif",a=t.fontWeight||"normal",s=b[t.textAlign]||"start";O(e,Object.assign({},e.rect,e.styles,{"stroke-width":0,"font-weight":a,"font-size":r,"font-family":o,"text-anchor":s})),e.text!==t.text&&(e.text=t.text,e.textContent=t.text.length?t.text:" ")},path:function(e,t,n,i){var r;O(e,Object.assign({},e.styles,{fill:"none",d:(r=t.points.map((function(e){return{x:y(e.x,n,i,"width"),y:y(e.y,n,i,"height")}})),r.map((function(e,t){return"".concat(0===t?"M":"L"," ").concat(e.x," ").concat(e.y)})).join(" "))}))},line:function(e,t,n,i){O(e,Object.assign({},e.rect,e.styles,{fill:"none"}));var r=e.childNodes[0],o=e.childNodes[1],a=e.childNodes[2],s=e.rect,l={x:e.rect.x+e.rect.width,y:e.rect.y+e.rect.height};if(O(r,{x1:s.x,y1:s.y,x2:l.x,y2:l.y}),t.lineDecoration){o.style.display="none",a.style.display="none";var u=v({x:l.x-s.x,y:l.y-s.y}),c=y(.05,n,i);if(-1!==t.lineDecoration.indexOf("arrow-begin")){var d=m(u,c),f=E(s,d),p=_(s,2,f),h=_(s,-2,f);O(o,{style:"display:block;",d:"M".concat(p.x,",").concat(p.y," L").concat(s.x,",").concat(s.y," L").concat(h.x,",").concat(h.y)})}if(-1!==t.lineDecoration.indexOf("arrow-end")){var g=m(u,-c),I=E(l,g),T=_(l,2,I),w=_(l,-2,I);O(a,{style:"display:block;",d:"M".concat(T.x,",").concat(T.y," L").concat(l.x,",").concat(l.y," L").concat(w.x,",").concat(w.y)})}}}},L=function(e,t){return C[e](t)},D=function(e,t,n,i,r){"path"!==t&&(e.rect=A(n,i,r)),e.styles=T(n,i,r),P[t](e,n,i,r)},x=function(e,t){return e[1].zIndex>t[1].zIndex?1:e[1].zIndex<t[1].zIndex?-1:0},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return new Promise((function(r){var o=i.background,a=void 0===o?null:o,s=new FileReader;s.onloadend=function(){var e=s.result,i=document.createElement("div");i.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;",i.innerHTML=e;var o=i.querySelector("svg");document.body.appendChild(i);var c=o.getBBox();i.parentNode.removeChild(i);var d=i.querySelector("title"),f=o.getAttribute("viewBox")||"",p=o.getAttribute("width")||"",h=o.getAttribute("height")||"",g=parseFloat(p)||null,m=parseFloat(h)||null,E=(p.match(/[a-z]+/)||[])[0]||"",v=(h.match(/[a-z]+/)||[])[0]||"",_=f.split(" ").map(parseFloat),I=_.length?{x:_[0],y:_[1],width:_[2],height:_[3]}:c,y=null!=g?g:I.width,T=null!=m?m:I.height;o.style.overflow="visible",o.setAttribute("width",y),o.setAttribute("height",T);var w="";if(n&&n.length){var A={width:y,height:T};w=n.sort(x).reduce((function(e,t){var n=L(t[0],t[1]);return D(n,t[0],t[1],A),n.removeAttribute("id"),1===n.getAttribute("opacity")&&n.removeAttribute("opacity"),e+"\n"+n.outerHTML+"\n"}),""),w="\n\n<g>".concat(w.replace(/&nbsp;/g," "),"</g>\n\n")}var O=t.aspectRatio||T/y,R=y,S=R*O,b=void 0===t.scaleToFit||t.scaleToFit,M=t.center?t.center.x:.5,C=t.center?t.center.y:.5,P=l({width:y,height:T},u({width:R,height:S},O),t.rotation,b?{x:M,y:C}:{x:.5,y:.5}),G=t.zoom*P,N=t.rotation*(180/Math.PI),F={x:.5*R,y:.5*S},k={x:F.x-y*M,y:F.y-T*C},V=["rotate(".concat(N," ").concat(F.x," ").concat(F.y,")"),"translate(".concat(F.x," ").concat(F.y,")"),"scale(".concat(G,")"),"translate(".concat(-F.x," ").concat(-F.y,")"),"translate(".concat(k.x," ").concat(k.y,")")],U=t.flip&&t.flip.horizontal,B=t.flip&&t.flip.vertical,q=["scale(".concat(U?-1:1," ").concat(B?-1:1,")"),"translate(".concat(U?-y:0," ").concat(B?-T:0,")")],z='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'.concat(R).concat(E,'" height="').concat(S).concat(v,'" \nviewBox="0 0 ').concat(R," ").concat(S,'" ').concat(a?'style="background:'+a+'" ':"",'\npreserveAspectRatio="xMinYMin"\nxmlns:xlink="http://www.w3.org/1999/xlink"\nxmlns="http://www.w3.org/2000/svg">\n\x3c!-- Generated by PQINA - https://pqina.nl/ --\x3e\n<title>').concat(d?d.textContent:"",'</title>\n<g transform="').concat(V.join(" "),'">\n<g transform="').concat(q.join(" "),'">\n').concat(o.outerHTML).concat(w,"\n</g>\n</g>\n</svg>");r(z)},s.readAsText(e)}))},N=function(e){var t;try{t=new ImageData(e.width,e.height)}catch(n){t=document.createElement("canvas").getContext("2d").createImageData(e.width,e.height)}return t.data.set(e.data),t},F=function(){var e={resize:function(e,t){var i=t.mode,a=void 0===i?"contain":i,s=t.upscale,l=void 0!==s&&s,u=t.width,c=t.height,d=t.matrix;if(d=!d||r(d)?null:d,!u&&!c)return o(e,d);null===u?u=c:null===c&&(c=u);if("force"!==a){var f=u/e.width,p=c/e.height,h=1;if("cover"===a?h=Math.max(f,p):"contain"===a&&(h=Math.min(f,p)),h>1&&!1===l)return o(e,d);u=e.width*h,c=e.height*h}for(var g=e.width,m=e.height,E=Math.round(u),v=Math.round(c),_=e.data,I=new Uint8ClampedArray(E*v*4),y=g/E,T=m/v,w=Math.ceil(.5*y),A=Math.ceil(.5*T),O=0;O<v;O++)for(var R=0;R<E;R++){for(var S=4*(R+O*E),b=0,M=0,C=0,P=0,L=0,D=0,x=0,G=(O+.5)*T,N=Math.floor(O*T);N<(O+1)*T;N++)for(var F=Math.abs(G-(N+.5))/A,k=(R+.5)*y,V=F*F,U=Math.floor(R*y);U<(R+1)*y;U++){var B=Math.abs(k-(U+.5))/w,q=Math.sqrt(V+B*B);if(q>=-1&&q<=1&&(b=2*q*q*q-3*q*q+1)>0){var z=_[(B=4*(U+N*g))+3];x+=b*z,C+=b,z<255&&(b=b*z/250),P+=b*_[B],L+=b*_[B+1],D+=b*_[B+2],M+=b}}I[S]=P/M,I[S+1]=L/M,I[S+2]=D/M,I[S+3]=x/C,d&&n(S,I,d)}return{data:I,width:E,height:v}},filter:o},t=function(t,n){var i=t.transforms,r=null;if(i.forEach((function(e){"filter"===e.type&&(r=e)})),r){var o=null;i.forEach((function(e){"resize"===e.type&&(o=e)})),o&&(o.data.matrix=r.data,i=i.filter((function(e){return"filter"!==e.type})))}n(function(t,n){return t.forEach((function(t){n=e[t.type](n,t.data)})),n}(i,t.imageData))};self.onmessage=function(e){t(e.data.message,(function(t){self.postMessage({id:e.data.id,message:t},[t.data.buffer])}))};function n(e,t,n){var i=t[e]/255,r=t[e+1]/255,o=t[e+2]/255,a=t[e+3]/255,s=i*n[0]+r*n[1]+o*n[2]+a*n[3]+n[4],l=i*n[5]+r*n[6]+o*n[7]+a*n[8]+n[9],u=i*n[10]+r*n[11]+o*n[12]+a*n[13]+n[14],c=i*n[15]+r*n[16]+o*n[17]+a*n[18]+n[19],d=Math.max(0,s*c)+1*(1-c),f=Math.max(0,l*c)+1*(1-c),p=Math.max(0,u*c)+1*(1-c);t[e]=255*Math.max(0,Math.min(1,d)),t[e+1]=255*Math.max(0,Math.min(1,f)),t[e+2]=255*Math.max(0,Math.min(1,p))}var i=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function r(e){return self.JSON.stringify(e||[])===i}function o(e,t){if(!t||r(t))return e;for(var n=e.data,i=n.length,o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],d=t[6],f=t[7],p=t[8],h=t[9],g=t[10],m=t[11],E=t[12],v=t[13],_=t[14],I=t[15],y=t[16],T=t[17],w=t[18],A=t[19],O=0,R=0,S=0,b=0,M=0,C=0,P=0,L=0,D=0,x=0,G=0,N=0;O<i;O+=4)C=(R=n[O]/255)*o+(S=n[O+1]/255)*a+(b=n[O+2]/255)*s+(M=n[O+3]/255)*l+u,P=R*c+S*d+b*f+M*p+h,L=R*g+S*m+b*E+M*v+_,D=R*I+S*y+b*T+M*w+A,x=Math.max(0,C*D)+1*(1-D),G=Math.max(0,P*D)+1*(1-D),N=Math.max(0,L*D)+1*(1-D),n[O]=255*Math.max(0,Math.min(1,x)),n[O+1]=255*Math.max(0,Math.min(1,G)),n[O+2]=255*Math.max(0,Math.min(1,N));return e}},k=function(e,t){if(1165519206===e.getUint32(t+4,!1)){t+=4;var n=18761===e.getUint16(t+=6,!1);t+=e.getUint32(t+4,n);var i=e.getUint16(t,n);t+=2;for(var r=0;r<i;r++)if(274===e.getUint16(t+12*r,n))return e.setUint16(t+12*r+8,1,n),!0;return!1}},V=function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(){return t(function(e){var t=new DataView(e);if(65496!==t.getUint16(0))return null;for(var n,i,r=2,o=!1;r<t.byteLength&&(n=t.getUint16(r,!1),i=t.getUint16(r+2,!1)+2,n>=65504&&n<=65519||65534===n)&&(o||(o=k(t,r)),!(r+i>t.byteLength));)r+=i;return e.slice(0,r)}(n.result)||null)},n.readAsArrayBuffer(e.slice(0,262144))}))},U=function(e,t){var n=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(n){var i=new n;return i.append(e),i.getBlob(t)}return new Blob([e],{type:t})},B=function(e){var t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(t),i=new Worker(n),r=[];return{transfer:function(){},post:function(e,t,n){var o=Math.random().toString(36).substr(2,9);r[o]=t,i.onmessage=function(e){var t=r[e.data.id];t&&(t(e.data.message),delete r[e.data.id])},i.postMessage({id:o,message:e},n)},terminate:function(){i.terminate(),URL.revokeObjectURL(n)}}},q=function(e){return new Promise((function(t,n){var i=new Image;i.onload=function(){t(i)},i.onerror=function(e){n(e)},i.src=e}))},z=function(e,t){return new Promise((function(n){var i,r={width:e.width,height:e.height},o=e.getContext("2d"),a=t.sort(x).map((function(e){return function(){return new Promise((function(t){H[e[0]](o,r,e[1],t)&&t()}))}}));(i=a,i.reduce((function(e,t){return e.then((function(e){return t().then(Array.prototype.concat.bind(e))}))}),Promise.resolve([]))).then((function(){return n(e)}))}))},j=function(e,t){e.beginPath(),e.lineCap=t["stroke-linecap"],e.lineJoin=t["stroke-linejoin"],e.lineWidth=t["stroke-width"],t["stroke-dasharray"].length&&e.setLineDash(t["stroke-dasharray"].split(",")),e.fillStyle=t.fill,e.strokeStyle=t.stroke,e.globalAlpha=t.opacity||1},W=function(e){e.fill(),e.stroke(),e.globalAlpha=1},H={rect:function(e,t,n){var i=A(n,t),r=T(n,t);return j(e,r),e.rect(i.x,i.y,i.width,i.height),W(e),!0},ellipse:function(e,t,n){var i=A(n,t),r=T(n,t);j(e,r);var o=i.x,a=i.y,s=i.width,l=i.height,u=.5522848,c=s/2*u,d=l/2*u,f=o+s,p=a+l,h=o+s/2,g=a+l/2;return e.moveTo(o,g),e.bezierCurveTo(o,g-d,h-c,a,h,a),e.bezierCurveTo(h+c,a,f,g-d,f,g),e.bezierCurveTo(f,g+d,h+c,p,h,p),e.bezierCurveTo(h-c,p,o,g+d,o,g),W(e),!0},image:function(e,t,n,i){var r=A(n,t),o=T(n,t);j(e,o);var a=new Image;new URL(n.src,window.location.href).origin!==window.location.origin&&(a.crossOrigin=""),a.onload=function(){if("cover"===n.fit){var t=r.width/r.height,o=t>1?a.width:a.height*t,s=t>1?a.width/t:a.height,l=.5*a.width-.5*o,u=.5*a.height-.5*s;e.drawImage(a,l,u,o,s,r.x,r.y,r.width,r.height)}else if("contain"===n.fit){var c=Math.min(r.width/a.width,r.height/a.height),d=c*a.width,f=c*a.height,p=r.x+.5*r.width-.5*d,h=r.y+.5*r.height-.5*f;e.drawImage(a,0,0,a.width,a.height,p,h,d,f)}else e.drawImage(a,0,0,a.width,a.height,r.x,r.y,r.width,r.height);W(e),i()},a.src=n.src},text:function(e,t,n){var i=A(n,t),r=T(n,t);j(e,r);var o=y(n.fontSize,t),a=n.fontFamily||"sans-serif",s=n.fontWeight||"normal",l=n.textAlign||"left";return e.font="".concat(s," ").concat(o,"px ").concat(a),e.textAlign=l,e.fillText(n.text,i.x,i.y),W(e),!0},line:function(e,t,n){var i=A(n,t),r=T(n,t);j(e,r),e.beginPath();var o={x:i.x,y:i.y},a={x:i.x+i.width,y:i.y+i.height};e.moveTo(o.x,o.y),e.lineTo(a.x,a.y);var s=v({x:a.x-o.x,y:a.y-o.y}),l=.04*Math.min(t.width,t.height);if(-1!==n.lineDecoration.indexOf("arrow-begin")){var u=m(s,l),c=E(o,u),d=_(o,2,c),f=_(o,-2,c);e.moveTo(d.x,d.y),e.lineTo(o.x,o.y),e.lineTo(f.x,f.y)}if(-1!==n.lineDecoration.indexOf("arrow-end")){var p=m(s,-l),h=E(a,p),g=_(a,2,h),I=_(a,-2,h);e.moveTo(g.x,g.y),e.lineTo(a.x,a.y),e.lineTo(I.x,I.y)}return W(e),!0},path:function(e,t,n){var i=T(n,t);j(e,i),e.beginPath();var r=n.points.map((function(e){return{x:y(e.x,t,1,"width"),y:y(e.y,t,1,"height")}}));e.moveTo(r[0].x,r[0].y);for(var o=r.length,a=1;a<o;a++)e.lineTo(r[a].x,r[a].y);return W(e),!0}},Y=function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0),t};function X(e){this.wrapped=e}function Z(e){var t,n;function i(t,n){try{var o=e[t](n),a=o.value,s=a instanceof X;Promise.resolve(s?a.wrapped:a).then((function(e){s?i("next",e):r(o.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(Z.prototype[Symbol.asyncIterator]=function(){return this}),Z.prototype.next=function(e){return this._invoke("next",e)},Z.prototype.throw=function(e){return this._invoke("throw",e)},Z.prototype.return=function(e){return this._invoke("return",e)};function Q(e,t){return K(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||J()}function K(e){if(Array.isArray(e))return e}function J(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var $=["x","y","left","top","right","bottom","width","height"],ee=function(e){var t=Q(e,2),n=t[0],i=t[1],r=i.points?{}:$.reduce((function(e,t){var n;return e[t]="string"==typeof(n=i[t])&&/%/.test(n)?parseFloat(n)/100:n,e}),{});return[n,Object.assign({zIndex:0},i,r)]};"undefined"!=typeof window&&void 0!==window.document&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var i=this;setTimeout((function(){for(var r=i.toDataURL(t,n).split(",")[1],o=atob(r),a=o.length,s=new Uint8Array(a);a--;)s[a]=o.charCodeAt(a);e(new Blob([s],{type:t||"image/png"}))}))}}));var te="undefined"!=typeof window&&void 0!==window.document,ne=te&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,ie=function(n){var i=n.addFilter,r=n.utils,o=r.Type,a=r.forin,s=r.getFileFromBlob,l=r.isFile,u=["crop","resize","filter","markup","output"],c=function(e){return null===e.aspectRatio&&0===e.rotation&&1===e.zoom&&e.center&&.5===e.center.x&&.5===e.center.y&&e.flip&&!1===e.flip.horizontal&&!1===e.flip.vertical};i("SHOULD_PREPARE_OUTPUT",(function(e,t){var n=t.query;return new Promise((function(e){e(!n("IS_ASYNC"))}))}));var f=function(e,t,n){return new Promise((function(i){if(!e("GET_ALLOW_IMAGE_TRANSFORM")||n.archived||!l(t)||!function(e){return/^image/.test(e.type)}(t))return i(!1);(function(e){return new Promise((function(t,n){var i=new Image;i.src=URL.createObjectURL(e);var r=function(){var e=i.naturalWidth,n=i.naturalHeight;e&&n&&(URL.revokeObjectURL(i.src),clearInterval(o),t({width:e,height:n}))};i.onerror=function(e){URL.revokeObjectURL(i.src),clearInterval(o),n(e)};var o=setInterval(r,1);r()}))})(t).then((function(){var n=e("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(n){var r=n(t);if(null==r)return handleRevert(!0);if("boolean"==typeof r)return i(r);if("function"==typeof r.then)return r.then(i)}i(!0)})).catch((function(e){i(!1)}))}))};return i("PREPARE_OUTPUT",(function(n,i){var r=i.query,o=i.item;return new Promise((function(i){f(r,n,o).then((function(l){if(!l)return i(n);var f=[];r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")&&f.push((function(){return new Promise((function(e){e({name:r("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:n})}))})),r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")&&f.push((function(e,t,n){return new Promise((function(i){e(t,n).then((function(e){return i({name:r("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:e})}))}))}));var p=r("GET_IMAGE_TRANSFORM_VARIANTS")||{};a(p,(function(e,t){var n,i=(n=t,function(e,t,i){return e(t,n?n(i):i)});f.push((function(t,n,r){return new Promise((function(o){i(t,n,r).then((function(t){return o({name:e,file:t})}))}))}))}));var m=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY"),E=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE"),v=null===m?null:m/100,_=r("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE"),I=r("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||u;o.setMetadata("output",{type:_,quality:v,client:I},!0);var y=function(n,i){return new Promise((function(o,a){var l=Object.assign({},i);Object.keys(l).filter((function(e){return"exif"!==e})).forEach((function(e){-1===I.indexOf(e)&&delete l[e]}));var u=l.resize,f=l.exif,p=l.output,m=l.crop,v=l.filter,_=l.markup,y={image:{orientation:f?f.orientation:null},output:p&&(p.type||"number"==typeof p.quality||p.background)?{type:p.type,quality:"number"==typeof p.quality?100*p.quality:null,background:p.background||r("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||null}:void 0,size:u&&(u.size.width||u.size.height)?Object.assign({mode:u.mode,upscale:u.upscale},u.size):void 0,crop:m&&!c(m)?Object.assign({},m):void 0,markup:_&&_.length?_.map(ee):[],filter:v};if(y.output){var T=!!p.type&&p.type!==n.type,w=/\/jpe?g$/.test(n.type),A=null!==p.quality&&(w&&"always"===E);if(!!!(y.size||y.crop||y.filter||T||A))return o(n)}var O={beforeCreateBlob:r("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),afterCreateBlob:r("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),canvasMemoryLimit:r("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),stripImageHead:r("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")};(function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,o){if(!e||!t(e))return o({status:"not an image file",file:e});var a=i.stripImageHead,s=i.beforeCreateBlob,l=i.afterCreateBlob,u=i.canvasMemoryLimit,c=n.crop,f=n.size,p=n.filter,m=n.markup,E=n.output,v=n.image&&n.image.orientation?Math.max(1,Math.min(8,n.image.orientation)):null,_=E&&E.quality,I=null===_?null:_/100,y=E&&E.type||null,T=E&&E.background||null,w=[];!f||"number"!=typeof f.width&&"number"!=typeof f.height||w.push({type:"resize",data:f}),p&&20===p.length&&w.push({type:"filter",data:p});var A=function(e){var t=l?l(e):e;Promise.resolve(t).then(r)},O=function(t,n){var i=Y(t),r=m.length?z(i,m):i;Promise.resolve(r).then((function(t){g(t,n,s).then((function(n){if(d(t),a)return A(n);V(e).then((function(e){null!==e&&(n=new Blob([e,n.slice(20)],{type:n.type})),A(n)}))})).catch(o)}))};if(/svg/.test(e.type)&&null===y)return G(e,c,m,{background:T}).then((function(e){r(U(e,"image/svg+xml"))}));var R=URL.createObjectURL(e);q(R).then((function(t){URL.revokeObjectURL(R);var n=h(t,v,c,{canvasMemoryLimit:u,background:T}),i={quality:I,type:y||e.type};if(!w.length)return O(n,i);var r=B(F);r.post({transforms:w,imageData:n},(function(e){O(N(e),i),r.terminate()}),[n.data.buffer])})).catch(o)}))})(n,y,O).then((function(t){var i=s(t,function(t,n){var i=function(e){return e.substr(0,e.lastIndexOf("."))||e}(t),r=n.split("/")[1],o=e[r]||r;return"".concat(i,".").concat(o)}(n.name,function(e){return/jpeg|png|svg\+xml/.test(e)?e:"image/jpeg"}(t.type)));o(i)})).catch(a)}))},T=f.map((function(e){return e(y,n,o.getMetadata())}));Promise.all(T).then((function(e){i(1===e.length&&null===e[0].name?e[0].file:e)}))}))}))})),{options:{allowImageTransform:[!0,o.BOOLEAN],imageTransformImageFilter:[null,o.FUNCTION],imageTransformOutputMimeType:[null,o.STRING],imageTransformOutputQuality:[null,o.INT],imageTransformOutputStripImageHead:[!0,o.BOOLEAN],imageTransformClientTransforms:[null,o.ARRAY],imageTransformOutputQualityMode:["always",o.STRING],imageTransformVariants:[null,o.OBJECT],imageTransformVariantsIncludeDefault:[!0,o.BOOLEAN],imageTransformVariantsDefaultName:[null,o.STRING],imageTransformVariantsIncludeOriginal:[!1,o.BOOLEAN],imageTransformVariantsOriginalName:["original_",o.STRING],imageTransformBeforeCreateBlob:[null,o.FUNCTION],imageTransformAfterCreateBlob:[null,o.FUNCTION],imageTransformCanvasMemoryLimit:[te&&ne?16777216:null,o.INT],imageTransformCanvasBackgroundColor:[null,o.STRING]}}};return te&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:ie})),ie}));var ve=function(e){return new Promise((function(t,n){var i=document.createElement("img");i.src=URL.createObjectURL(e),i.onerror=function(e){clearInterval(r),n(e)};var r=setInterval((function(){i.naturalWidth&&i.naturalHeight&&(clearInterval(r),URL.revokeObjectURL(i.src),t({width:i.naturalWidth,height:i.naturalHeight}))}),1)}))},_e=function(e){return/^image/.test(e.type)},Ie=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.replaceInString,o=n.isFile,a=n.createRoute,s=function(e,t,n){var i={minWidth:t("GET_IMAGE_VALIDATE_SIZE_MIN_WIDTH"),minHeight:t("GET_IMAGE_VALIDATE_SIZE_MIN_HEIGHT"),maxWidth:t("GET_IMAGE_VALIDATE_SIZE_MAX_WIDTH"),maxHeight:t("GET_IMAGE_VALIDATE_SIZE_MAX_HEIGHT"),minResolution:t("GET_IMAGE_VALIDATE_SIZE_MIN_RESOLUTION"),maxResolution:t("GET_IMAGE_VALIDATE_SIZE_MAX_RESOLUTION")};return function(e,t,n){return new Promise((function(i,r){var o=function(e){var n=e.width,o=e.height,a=t.minWidth,s=t.minHeight,l=t.maxWidth,u=t.maxHeight,c=t.minResolution,d=t.maxResolution,f=n*o;n<a||o<s?r("TOO_SMALL"):n>l||o>u?r("TOO_BIG"):null!==c&&f<c?r("TOO_LOW_RES"):null!==d&&f>d&&r("TOO_HIGH_RES"),i()};n&&n.width&&n.height?o(n):ve(e).then(o).catch((function(){r()}))}))}(e,i,n).catch((function(n){var o=n?{TOO_SMALL:{label:t("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_SIZE_TOO_SMALL"),details:t("GET_IMAGE_VALIDATE_SIZE_LABEL_EXPECTED_MIN_SIZE")},TOO_BIG:{label:t("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_SIZE_TOO_BIG"),details:t("GET_IMAGE_VALIDATE_SIZE_LABEL_EXPECTED_MAX_SIZE")},TOO_LOW_RES:{label:t("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_RESOLUTION_TOO_LOW"),details:t("GET_IMAGE_VALIDATE_SIZE_LABEL_EXPECTED_MIN_RESOLUTION")},TOO_HIGH_RES:{label:t("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_RESOLUTION_TOO_HIGH"),details:t("GET_IMAGE_VALIDATE_SIZE_LABEL_EXPECTED_MAX_RESOLUTION")}}[n]:{label:t("GET_IMAGE_VALIDATE_SIZE_LABEL_FORMAT_ERROR"),details:e.type};throw{status:{main:o.label,sub:n?r(o.details,i):o.details}}}))},l=function(e){if(null==e||""===e)return null;if("number"==typeof e)return e;if(-1!==e.indexOf(":")){var t=e.split(":");if(t.length>1)return parseFloat(t[0])/parseFloat(t[1])}else{var n=parseFloat(e);if(!isNaN(n))return n}return null},u=!1;return t("CREATE_VIEW",(function(e){e.is;var t=e.view,n=e.query,i=function(e){var t=e.root,i=e.props.id,a=n("GET_ITEM",i);if(a&&!a.archived&&a.getMetadata("imageValidate")){a.setMetadata("imageValidate",!1,!0);var c=a.file;if(!n("GET_IMAGE_VALIDATE_SUPPORT_IMAGE")(c))return;var d=a.serverId,f=a.getMetadata("imageSize"),p=n("GET_IMAGE_VALIDATE_COMPLETE_RESULT");if(!o(c)&&!f)return void t.dispatch("REMOVE_ITEM",{id:a.id});var h=function(){var e=t.element.querySelector(".filepond--image-preview-overlay-failure");null!=e&&(e.style.opacity="0"),p(d,!0)},g=function(e){t.dispatch("DID_THROW_ITEM_INVALID",{id:i,error:e.status,status:e.status}),p(d,!1)};s(c,n,f).then((function(){var e=n("GET_IMAGE_VALIDATE_CROP_RATIOS");if(null!=e&&Array.isArray(e)&&e.length>0){var i=f.width/f.height;i=Math.round(1e3*i)/1e3;for(var s=!1,d="",p=0;p<e.length;p++){var m=e[p];if(!m.value){s=!0;break}var E=l(m.value);if(i===(E=Math.round(1e3*E)/1e3)){s=!0;break}d=m.label}if(!s){var v={label:n("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_RATIO_INVALID"),details:n("GET_IMAGE_VALIDATE_SIZE_LABEL_IMAGE_RATIO_EXPECTED")},_={status:{main:v.label,sub:v&&d?r(v.details,{ratio:d}):""}},I=n("GET_IMAGE_EDIT_EDITOR")||n("GET_IMAGE_EDITOR");if(!u&&o(c)&&I)return u=!0,I.editorOptions&&a.setMetadata("imageState",void 0,!0),void t.dispatch("EDIT_ITEM",{id:a.id,handleEditorResponse:function(e){u=!1,e?h():g(_)}});throw _}}h()})).catch((function(e){g(e)}))}};t.registerWriter(a({DID_COMPLETE_ITEM_PROCESSING:i,DID_LOAD_ITEM:i},(function(e){e.root,e.props})))})),t("DID_CREATE_ITEM",(function(e,t){var n=t.query,i=t.dispatch;e.extend("validate",(function(){var t=n("GET_ALLOW_IMAGE_VALIDATE_SIZE");e.setMetadata("imageValidate",t,!0),i("DID_COMPLETE_ITEM_PROCESSING",{id:e.id,error:null,serverFileReference:e.serverId})}))})),t("PREPARE_OUTPUT",(function(e,t){var n=t.query,i=t.item;return new Promise((function(t,r){e&&Array.isArray(e)&&0!==e.length||t(e);for(var a=n("GET_IMAGE_VALIDATE_COMPLETE_OUTPUT_NAME"),s=null,l=0;l<e.length;l++){var u=e[l];if(u.name&&u.name===a){s=u.file;break}}if(!s||!o(s)||!n("GET_IMAGE_VALIDATE_SUPPORT_IMAGE")(s))return t(e);ve(s).then((function(n){i.setMetadata("imageSize",{width:n.width,height:n.height},!0),t(e)})).catch((function(){t(e)}))}))})),t("LOAD_FILE",(function(e,t){var n=t.query;return new Promise((function(t,i){var r=n("GET_IMAGE_VALIDATE_SUPPORT_IMAGE");if(o(e)&&null!=r&&r(e)){var a=n("GET_ALLOW_IMAGE_VALIDATE_SIZE"),l=n("GET_ALLOW_IMAGE_VALIDATE_IMAGE");a||l?ve(e).then((function(r){a?s(e,n,r).then((function(){t(e)})).catch((function(e){i(e)})):t(e)})).catch((function(t){i({status:{main:n("GET_IMAGE_VALIDATE_SIZE_LABEL_FORMAT_ERROR"),sub:e.type}})})):t(e)}else t(e)}))})),{options:{imageValidateCompleteResult:[function(e,t){return null},i.FUNCTION],imageValidateSupportImage:[_e,i.FUNCTION],imageValidateCompleteOutputName:["original",i.STRING],imageValidateCropRatios:[null,i.ARRAY],allowImageValidateImage:[!1,i.BOOLEAN],allowImageValidateSize:[!0,i.BOOLEAN],imageValidateSizeLabelFormatError:["Image type not supported",i.STRING],imageValidateSizeMeasure:[null,i.FUNCTION],imageValidateSizeMinResolution:[null,i.INT],imageValidateSizeMaxResolution:[null,i.INT],imageValidateSizeLabelImageResolutionTooLow:["Resolution is too low",i.STRING],imageValidateSizeLabelImageResolutionTooHigh:["Resolution is too high",i.STRING],imageValidateSizeLabelExpectedMinResolution:["Minimum resolution is {minResolution}",i.STRING],imageValidateSizeLabelExpectedMaxResolution:["Maximum resolution is {maxResolution}",i.STRING],imageValidateSizeMinWidth:[1,i.INT],imageValidateSizeMinHeight:[1,i.INT],imageValidateSizeMaxWidth:[65535,i.INT],imageValidateSizeMaxHeight:[65535,i.INT],imageValidateSizeLabelImageSizeTooSmall:["Image is too small",i.STRING],imageValidateSizeLabelImageSizeTooBig:["Image is too big",i.STRING],imageValidateSizeLabelExpectedMinSize:["Minimum size is {minWidth} × {minHeight}",i.STRING],imageValidateSizeLabelExpectedMaxSize:["Maximum size is {maxWidth} × {maxHeight}",i.STRING],imageValidateSizeLabelImageRatioInvalid:["Image ratio does not match",i.STRING],imageValidateSizeLabelImageRatioExpected:["Expected image ratio {ratio}",i.STRING]}}};"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Ie}));var ye=Ie,Te={type:"spring",stiffness:.5,damping:.45,mass:10},we=function(e){return-.5*(Math.cos(Math.PI*e)-1)},Ae=function(e,t,n,i,r){e.width=t,e.height=n;var o=e.getContext("2d"),a=.5*t,s=o.createRadialGradient(a,n+110,n-100,a,n+110,n+100);!function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:we,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=1-o,s=t.join(","),l=0;l<=r;l++){var u=l/r,c=o+a*u;e.addColorStop(c,"rgba(".concat(s,", ").concat(i(u)*n,")"))}}(s,i,r,void 0,8,.4),o.save(),o.translate(.5*-t,0),o.scale(2,1),o.fillStyle=s,o.fillRect(0,0,t,n),o.restore()},Oe="undefined"!=typeof navigator,Re=500,Se=200,be=Oe&&document.createElement("canvas"),Me=Oe&&document.createElement("canvas"),Ce=Oe&&document.createElement("canvas");Oe&&(Ae(be,Re,Se,[40,40,40],.85),Ae(Me,Re,Se,[196,78,71],1),Ae(Ce,Re,Se,[54,151,99],0));var Pe=function(e){var t=e.utils.createView({name:"file-poster-overlay",tag:"canvas",ignoreRect:!0,create:function(e){var t,n,i=e.root;t=e.props.template,(n=i.element).width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),n=function(e){e.root.ref.overlayError.opacity=0},i=function(e){e.root.ref.overlayError.opacity=1};return e.utils.createView({name:"file-poster-wrapper",create:function(n){var i=n.root,r=n.props,o=function(e){return e.utils.createView({name:"file-poster appcloud",tag:"div",ignoreRect:!0,create:function(e){var t=e.root;t.ref.image=document.createElement("img"),t.element.appendChild(t.ref.image)},write:e.utils.createRoute({DID_FILE_POSTER_LOAD:function(e){var t=e.root,n=e.props,i=n.id,r=t.query("GET_ITEM",{id:n.id});if(r)if(t.query("GET_ALLOW_FILE_GRID_PREVIEW")){var o=r.getMetadata("poster");o?t.ref.image.src=o:r.status!==A.FileStatus.PROCESSING_COMPLETE&&r.status!==A.FileStatus.PROCESSING_ERROR?t.ref.image.src="data:image/svg+xml;base64,PCEtLSBCeSBTYW0gSGVyYmVydCAoQHNoZXJiKSwgZm9yIGV2ZXJ5b25lLiBNb3JlIEAgaHR0cDovL2dvby5nbC83QUp6YkwgLS0+Cjxzdmcgd2lkdGg9IjQ0IiBoZWlnaHQ9IjQ0IiB2aWV3Qm94PSIwIDAgNDQgNDQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLXdpZHRoPSIyIj4KICAgICAgICA8Y2lyY2xlIGN4PSIyMiIgY3k9IjIyIiByPSIxIj4KICAgICAgICAgICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIKICAgICAgICAgICAgICAgIGJlZ2luPSIwcyIgZHVyPSIxLjhzIgogICAgICAgICAgICAgICAgdmFsdWVzPSIxOyAyMCIKICAgICAgICAgICAgICAgIGNhbGNNb2RlPSJzcGxpbmUiCiAgICAgICAgICAgICAgICBrZXlUaW1lcz0iMDsgMSIKICAgICAgICAgICAgICAgIGtleVNwbGluZXM9IjAuMTY1LCAwLjg0LCAwLjQ0LCAxIgogICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIC8+CiAgICAgICAgICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1vcGFjaXR5IgogICAgICAgICAgICAgICAgYmVnaW49IjBzIiBkdXI9IjEuOHMiCiAgICAgICAgICAgICAgICB2YWx1ZXM9IjE7IDAiCiAgICAgICAgICAgICAgICBjYWxjTW9kZT0ic3BsaW5lIgogICAgICAgICAgICAgICAga2V5VGltZXM9IjA7IDEiCiAgICAgICAgICAgICAgICBrZXlTcGxpbmVzPSIwLjMsIDAuNjEsIDAuMzU1LCAxIgogICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIC8+CiAgICAgICAgPC9jaXJjbGU+CiAgICAgICAgPGNpcmNsZSBjeD0iMjIiIGN5PSIyMiIgcj0iMSI+CiAgICAgICAgICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiCiAgICAgICAgICAgICAgICBiZWdpbj0iLTAuOXMiIGR1cj0iMS44cyIKICAgICAgICAgICAgICAgIHZhbHVlcz0iMTsgMjAiCiAgICAgICAgICAgICAgICBjYWxjTW9kZT0ic3BsaW5lIgogICAgICAgICAgICAgICAga2V5VGltZXM9IjA7IDEiCiAgICAgICAgICAgICAgICBrZXlTcGxpbmVzPSIwLjE2NSwgMC44NCwgMC40NCwgMSIKICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiAvPgogICAgICAgICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJzdHJva2Utb3BhY2l0eSIKICAgICAgICAgICAgICAgIGJlZ2luPSItMC45cyIgZHVyPSIxLjhzIgogICAgICAgICAgICAgICAgdmFsdWVzPSIxOyAwIgogICAgICAgICAgICAgICAgY2FsY01vZGU9InNwbGluZSIKICAgICAgICAgICAgICAgIGtleVRpbWVzPSIwOyAxIgogICAgICAgICAgICAgICAga2V5U3BsaW5lcz0iMC4zLCAwLjYxLCAwLjM1NSwgMSIKICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiAvPgogICAgICAgIDwvY2lyY2xlPgogICAgPC9nPgo8L3N2Zz4=":t.ref.image.src="",t.dispatch("DID_FILE_POSTER_DRAW",{id:i}),o&&t.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:i})}else r.status===A.FileStatus.PROCESSING_COMPLETE&&t.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:i})}}),mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:Te,scaleY:Te,opacity:{type:"tween",duration:750}}}})}(e);i.ref.image=i.appendChildView(i.createChildView(o,{id:r.id,scaleX:1.25,scaleY:1.25,opacity:0})),i.ref.overlayError=i.appendChildView(i.createChildView(t,{template:Me,opacity:0}))},write:e.utils.createRoute({DID_FILE_POSTER_LOAD:function(e){e.root},DID_FILE_POSTER_DRAW:function(e){var t=e.root.ref.image;t.scaleX=1,t.scaleY=1,t.opacity=1},DID_FILE_POSTER_CONTAINER_CREATE:function(e){var t=e.root,n=e.props.id,i=t.query("GET_ITEM",n);if(i){var r,o,a,s=i.getMetadata("poster"),l=function(e){t.dispatch("DID_FILE_POSTER_LOAD",{id:n,data:e})};s?(r=s,o=function(e,n){var i,r;(i=s,r=t.query("GET_FILE_POSTER_CROSS_ORIGIN_ATTRIBUTE_VALUE"),new Promise((function(e,t){var n=new Image;"string"==typeof crossOrigin&&(n.crossOrigin=r),n.onload=function(){e(n)},n.onerror=function(e){t(e)},n.src=i}))).then(l)},(a=new Image).onload=function(){var e=a.naturalWidth,t=a.naturalHeight;a=null,o(e,t)},a.src=r,t.dispatch("DID_FILE_POSTER_CALCULATE_SIZE",{id:n,width:Re,height:Se})):(t.dispatch("DID_FILE_POSTER_CALCULATE_SIZE",{id:n}),i.origin===A.FileOrigin.INPUT&&t.dispatch("DID_FILE_POSTER_LOAD",{id:n}))}},DID_THROW_ITEM_LOAD_ERROR:i,DID_THROW_ITEM_PROCESSING_ERROR:i,DID_THROW_ITEM_INVALID:i,DID_COMPLETE_ITEM_PROCESSING:function(e){e.root},DID_START_ITEM_PROCESSING:n,DID_REVERT_ITEM_PROCESSING:n})})},Le=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.createRoute,o=Pe(e);return t("CREATE_VIEW",(function(e){var t=e.is,n=e.view,i=e.query;if(t("file")&&i("GET_ALLOW_FILE_GRID")){var a=function(e){var t=e.serverId,n=i("GET_FILE_GRID_FILE_VARIANT")(t,"thumbnail");null!=n&&e.setMetadata("poster",n.url,!0)},s=function(e){var t=e.root,n=t.query("GET_FILE_POSTER_HEIGHT");if(n)return n;var i=t.query("GET_FILE_POSTER_MIN_HEIGHT"),r=t.query("GET_FILE_POSTER_MAX_HEIGHT");if(i&&t.ref.imageHeight<i)return i;var o=t.rect.element.width*(t.ref.imageHeight/t.ref.imageWidth);return i&&o<i?i:r&&o>r?r:o};n.registerWriter(r({DID_THROW_ITEM_INVALID:function(e){var t=e.root,n=e.props;t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:n.id,height:s({root:t})})},DID_THROW_ITEM_PROCESSING_ERROR:function(e){var t=e.root,n=e.props.id;t.dispatch("DID_FILE_POSTER_LOAD",{id:n})},DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root,n=e.props.id,r=i("GET_ITEM",n);r&&!r.archived&&(a(r),t.dispatch("DID_FILE_POSTER_LOAD",{id:n}))},DID_LOAD_ITEM:function(e){var t=e.root,r=e.props.id,s=i("GET_ITEM",r);s&&!s.archived&&i("GET_FILE_POSTER_FILTER_ITEM")(s)&&(a(s),s.origin===A.FileOrigin.LOCAL&&t.element.classList.add("server"),t.ref.filePoster=n.appendChildView(n.createChildView(o,{id:r})),t.dispatch("DID_FILE_POSTER_CONTAINER_CREATE",{id:r}))},DID_FILE_POSTER_CALCULATE_SIZE:function(e){var t=e.root,n=e.action;t.ref.filePoster&&(t.ref.imageWidth=n.width,t.ref.imageHeight=n.height,t.ref.shouldUpdatePanelHeight=!0,t.dispatch("KICK"))}},(function(e){var t=e.root,n=e.props;t.ref.filePoster&&(t.rect.element.hidden||t.ref.shouldUpdatePanelHeight&&(t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:n.id,height:s({root:t})}),t.ref.shouldUpdatePanelHeight=!1))})))}})),{options:{allowImagePreview:[!0,i.BOOLEAN],allowFileGrid:[!0,i.BOOLEAN],allowFileGridPreview:[!0,i.BOOLEAN],fileGridFileVariant:[function(){return null},i.FUNCTION],filePosterHeight:[null,i.INT],filePosterMinHeight:[null,i.INT],filePosterMaxHeight:[null,i.INT],filePosterFilterItem:[function(){return!0},i.FUNCTION],filePosterCalculateAverageImageColor:[!1,i.BOOLEAN],filePosterCrossOriginAttributeValue:["Anonymous",i.STRING]}}};"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Le}));var De=Le,xe=function(){"use strict";function t(e){i(this,t);var n={api:"http://api.cloudlift.local:8080",queryParams:{},selector:".cl-upload--files",provider:"google",field:"upload",text:void 0,required:!1,metaData:{},fileMimeTypes:[],fileMimeTypesValidate:!0,fileSizeValidate:!0,fileSizeMax:null,fileMultiple:!0,fileCountMin:null,fileCountMax:null,fileFetch:!0,fileFetchConfig:void 0,imagePreview:!1,imagePreviewAppCloud:!1,imagePreviewHeight:100,imageOriginal:!0,imageTransforms:{},imageTransformFormat:null,imageResize:!1,imageSizeValidate:!0,imageWidthMin:1,imageWidthMax:65535,imageHeightMin:1,imageHeightMax:65535,imageResolutionMin:null,imageResolutionMax:null,convert:!1,convertMimeTypes:[],convertInfo:!1,convertInfoMimeTypes:["application/pdf","audio/mpeg","audio/wav","audio/x-wav","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],convertInfoPagesQuantity:!1,convertInfoLengthQuantity:!1,convertInfoPagesMin:null,convertInfoPagesMax:null,imageCrop:!1,imageEditor:!1,imageEditorOpen:!0,imageEditorUtils:["crop"],imageEditorCropRatio:null,imageEditorCropRatios:[{label:"Free",value:null},{label:"Portrait",value:1.25},{label:"Square",value:1},{label:"Landscape",value:.75}],imageEditorPintura:!1,imageEditorPinturaConfig:{utils:["annotate","crop","filter","finetune"],cropRotate:!0,cropZoom:!0,cropFlip:!0,cropShape:!1,cropShapes:[],cropSave:!1,annotateText:!0,annotateDraw:!0,annotateShapes:!0,options:{}},imageProcessCanvas:null,imageProcessBlob:null,imageEditable:"function"==typeof window.clUploadEditable?window.clUploadEditable:function(e){return/^image/.test(e)},translatePrefix:"upload."};this.files={},this.settings=p.extend(n,e||{}),p.isElement(this.settings.selector)?this.element=this.settings.selector:this.element=document.querySelector(this.settings.selector),null!=this.element?this._init():_.warn("no elements with selector found: ",this.settings.selector)}return o(t,[{key:"destroy",value:function(){this._pond.destroy()}},{key:"getElement",value:function(){return this._pond.element}},{key:"getStatus",value:function(){return this._pond.status}},{key:"isReady",value:function(){var e=this.getStatus();return 0===e||4===e}},{key:"updateOptions",value:function(e){for(var t in this.settings=p.extend(this.settings,e),e)e.hasOwnProperty(t)&&"[object Object]"===Object.prototype.toString.call(e[t])&&(this.settings[t]=e[t]);var n=this._mapOptions();this._pond.setOptions(n)}},{key:"upload",value:function(e){var t=this;return this._pond.setOptions({instantUpload:!1}),this._pond.addFile(e).then((function(e){var n=t;return t._pond.processFile(e).then((function(e){return n.updateOptions({instantUpload:!1}),n.files[e.serverId]}))})).catch((function(e){throw _.error("failed to upload file",e),t._pond.setOptions({instantUpload:!0}),e}))}},{key:"validateFiles",value:function(){for(var e=this._pond.getFiles(),t=0;t<e.length;t++){var n=e[t];n.validate&&n.validate()}}},{key:"countFiles",value:function(){var e=0;for(var t in this.files)if(this.files.hasOwnProperty(t)){var n=this.files[t];n.parent||n.error||(n.meta&&n.meta.pages&&this.settings.convert&&this.settings.convertInfoPagesQuantity?e+=n.meta.pages:n.meta&&n.meta.length&&this.settings.convert&&this.settings.convertInfoLengthQuantity?e+=Math.ceil(n.meta.length/(window.clQuantityLength||60)):e++)}return e}},{key:"restoreFiles",value:function(e){var t=this;this._fileMeta.restoreFiles(e).then((function(e){t._storeFiles(e),t._addStoreFiles()}))}},{key:"removeFiles",value:function(){this._pond.removeFiles({revert:!0})}},{key:"_init",value:function(){var n=p.extend(this.settings.queryParams,{config:this.settings.fileFetchConfig}),i={api:this.settings.api,queryParams:n};if(this.settings.fileFetch&&(i.storage=!0,i.storageKey=v.storageKey+"_"+this.settings.fileFetchConfig),this.settings.queryParams.orderId&&(i.storage=!1,i.serverDelete=!0),this._fileMeta=new v(i),this._provider=t.providers[this.settings.provider],!this._provider)throw"upload plugin "+this.settings.provider+" not found";A.registerPlugin(e(ue),e(le)),this.settings.imageEditorPintura?this.settings.imageEditor&&A.registerPlugin(ae):(A.registerPlugin(e(Ee),e(ce)),this.settings.imageResize&&A.registerPlugin(e(me)),(this.settings.imageCrop||this.settings.imageEditor)&&A.registerPlugin(e(ge)),this.settings.imageEditor&&A.registerPlugin(he)),this.settings.imagePreviewAppCloud?A.registerPlugin(De):this.settings.imagePreview&&(this.settings.imageEditorPintura?A.registerPlugin(e(se)):A.registerPlugin(e(de))),(this.settings.imageSizeValidate||this.settings.imageEditor)&&A.registerPlugin(ye);var r=this._mapOptions();if(this._pond=A.create(this.element,r),this._pond){var o=this;this._pond.setOptions({server:this._getFilePondServerImpl()}),this._pond.on("addfilestart",(function(e){e.file&&o._triggerEvent("upload:select",o._fileMeta.fromNative(e.file))})),this._pond.on("addfile",(function(e,t){null==e&&t.file&&o._triggerEvent("upload:add",o._fileMeta.fromNative(t.file))})),this._pond.on("error",(function(e,t){if(t.file){var n=o._fileMeta.fromNative(t.file);e.main?(n.meta.error=e.main,n.meta.msg=e.sub,o._triggerEvent("upload:invalid",n)):o._triggerEvent("upload:error",n)}})),this._pond.on("warning",(function(e,t){e.body&&"Max files"===e.body&&(o._triggerEvent("upload:select",{}),o._triggerEvent("upload:errors",[w.get(o.settings.translatePrefix+"error.fileCountMax",{max:o.settings.fileCountMax})]))})),this._pond.on("reorderfiles",(function(e,t,n){var i=e.map((function(e){return e.serverId}));o._triggerEvent("upload:sort",{fileIds:i,origin:t,target:n})})),this.settings.fileFetch&&(this._fileMeta.settings.queryParams.token||this._fileMeta.settings.queryParams.orderId)&&this._fileMeta.fetchFiles().then((function(e){o._storeFiles(e),o._addStoreFiles()}))}else _.error('Upload-Lift not supported - condition:\n\n !("[object OperaMini]" === Object.prototype.toString.call(window.operamini)) && "visibilityState" in document && "Promise" in window && "slice" in Blob.prototype && "URL" in window && "createObjectURL" in window.URL'),alert("Upload-Lift not supported")}},{key:"_mapOptions",value:function(){var e=this,t=this.settings.translatePrefix;return this._mapEditorOptions(),{checkValidity:!1,instantUpload:!0,credits:!1,name:this.settings.field,required:this.settings.required,allowFileTypeValidation:this.settings.fileMimeTypesValidate,acceptedFileTypes:this.settings.fileMimeTypesValidate?this.settings.fileMimeTypes:[],fileValidateTypeDetectType:function(e,t){return new Promise((function(n,i){if(""===t&&e&&e.name){var r=e.name.split(".").pop();"aml"===r?t="application/aml":"ampkg"===r?t="application/ampkg":"cdr"===r?t="application/x-cdr":"stl"===r&&(t="application/sla")}n(t)}))},allowFileSizeValidation:this.settings.fileSizeValidate,maxFileSize:this.settings.fileSizeMax,allowMultiple:this.settings.fileMultiple,allowBrowse:!0,allowDrop:!0,allowReorder:!0===window.clUploadReorder,allowPaste:!1,maxFiles:this.settings.fileCountMax,allowFileGrid:this.settings.imagePreviewAppCloud,allowFileGridPreview:this.settings.imagePreview,fileGridFileVariant:function(t,n){if(e.files.hasOwnProperty(t)){var i=e.files[t];if(i.meta&&i.meta.variant===n)return i;if(i.childs)for(var r in i.childs){var o=i.childs[r];if(o.meta&&o.meta.variant===n)return o}}return null},allowFilePoster:!this.settings.imagePreviewAppCloud&&this.settings.imageEditor&&this.settings.imageEditorPintura,filePosterMaxHeight:!this.settings.imagePreviewAppCloud&&this.settings.imageEditor&&this.settings.imageEditorPintura?256:null,filePosterHeight:this.settings.imagePreviewAppCloud?this.settings.imagePreview?this.settings.imagePreviewHeight+42:85:null,allowImageValidateSize:this.settings.imageSizeValidate,allowImageValidateImage:this.settings.imageEditor,imageValidateSupportImage:function(t){return e._fileEditable(t)},imageValidateCompleteResult:function(t,n){if(e.files.hasOwnProperty(t)){var i=e.files[t];n?i.error&&(delete i.error,e._storeFile(i)):(i.error=!0,e._removeFile(i),e.files[t]=i)}},imageValidateCropRatios:this.settings.imageEditorCropRatios,imageValidateSizeMinWidth:this.settings.imageWidthMin,imageValidateSizeMaxWidth:this.settings.imageWidthMax,imageValidateSizeMinHeight:this.settings.imageHeightMin,imageValidateSizeMaxHeight:this.settings.imageHeightMax,imageValidateSizeMinResolution:this.settings.imageResolutionMin?this.settings.imageResolutionMin:null,imageValidateSizeMaxResolution:this.settings.imageResolutionMax?this.settings.imageResolutionMax:null,allowImageExifOrientation:!0,allowImagePreview:this.settings.imagePreview||this.settings.imageEditor&&this.settings.imagePreviewAppCloud,allowImageResize:this.settings.imageResize,allowImageTransform:!0,allowImageEdit:this.settings.imageEditor,imageEditIconEdit:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" style="padding:5px;" viewBox="0 0 24 24" focusable="false"><path d="M24 18h-4v-14h-14v-4h-2v4h-4v2h4v14h14v4h2v-4h4v-2zm-18 0v-12h12v12h-12z" fill="currentColor" fill-rule="nonzero"/></svg>',allowImageCrop:this.settings.imageCrop,imageTransformBeforeCreateBlob:this.settings.imageProcessCanvas,imageTransformAfterCreateBlob:this.settings.imageProcessBlob,imageResizeMode:"cover",imagePreviewMaxHeight:window.clUploadImagePreviewMax||265,imagePreviewMaxFileSize:"20MB",imageCropAspectRatio:this.settings.imageEditorCropRatio,imageTransformVariantsIncludeOriginal:this.settings.imageOriginal,imageTransformVariantsOriginalName:this.settings.imageEditor&&this.settings.imageOriginal||window.clUploadTransformOriginal?"_original":"original",imageTransformVariantsIncludeDefault:window.clUploadTransformOriginal||!1,imageTransformVariantsDefaultName:"original",imageTransformOutputMimeType:window.clUploadOutputType||(null==this.settings.imageTransformFormat?null:"png"===this.settings.imageTransformFormat?"image/png":"image/jpeg"),imageTransformOutputStripImageHead:window.clStripImageHead||!1,imageTransformOutputQuality:window.clUploadOutputQuality||90,imageTransformVariants:this.settings.imageTransforms,imageEditInstantEdit:this.settings.imageEditorOpen,imageEditAllowEdit:!this.settings.imageEditorOpen,imageEditSupportImage:function(t){return e._fileEditable(t)},imageEditEditor:this._doka,allowImageEditor:this.settings.imageEditor,imageEditorSupportImage:function(t){return e._fileEditable(t)},imageEditor:this._pintura,imageEditorInstantEdit:this.settings.imageEditorOpen,imageEditorAllowEdit:!this.settings.imageEditorOpen,imageEditorAfterWriteImage:this._pintura?this._pintura.afterWriteImage:void 0,imageEditorIconEdit:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" style="padding:5px;" viewBox="0 0 24 24" focusable="false"><path d="M24 18h-4v-14h-14v-4h-2v4h-4v2h4v14h14v4h2v-4h4v-2zm-18 0v-12h12v12h-12z" fill="currentColor" fill-rule="nonzero"/></svg>',labelIdle:this.settings.text?this.settings.text:w.get(t+"dragdrop"),labelFileWaitingForSize:w.get(t+"file.size.waiting"),labelFileSizeNotAvailable:w.get(t+"file.size.notavailable"),labelFileLoading:w.get(t+"file.loading"),labelFileLoadError:w.get(t+"file.load.error"),labelFileProcessing:w.get(t+"file.uploading"),labelFileProcessingComplete:w.get(t+"file.upload.complete"),labelFileProcessingAborted:w.get(t+"file.upload.canceled"),labelFileProcessingError:w.get(t+"file.upload.error"),labelFileProcessingRevertError:w.get(t+"file.upload.error.revert"),labelFileRemoveError:w.get(t+"file.upload.error.remove"),labelTapToCancel:w.get(t+"file.upload.cancel"),labelTapToRetry:w.get(t+"file.upload.retry"),labelTapToUndo:w.get(t+"file.upload.undo"),labelButtonRemoveItem:w.get(t+"file.button.remove"),labelButtonAbortItemLoad:w.get(t+"file.button.remove"),labelButtonRetryItemLoad:w.get(t+"file.button.retry"),labelButtonAbortItemProcessing:w.get(t+"file.button.cancel"),labelButtonUndoItemProcessing:w.get(t+"file.button.undo"),labelButtonRetryItemProcessing:w.get(t+"file.button.retry"),labelButtonProcessItem:w.get(t+"file.button.upload"),labelMaxFileSizeExceeded:w.get(t+"file.size.tobig"),labelMaxFileSize:w.get(t+"file.size.max"),labelFileTypeNotAllowed:w.get(t+"file.type.notallowed"),fileValidateTypeLabelExpectedTypes:w.get(t+"file.type.expected"),imageValidateSizeLabelFormatError:w.get(t+"image.type.notsupported"),imageValidateSizeLabelImageSizeTooSmall:w.get(t+"image.size.tosmall"),imageValidateSizeLabelExpectedMinSize:w.get(t+"image.size.expected.min"),imageValidateSizeLabelExpectedMaxSize:w.get(t+"image.size.expected.max"),imageValidateSizeLabelImageResolutionTooLow:w.get(t+"image.resolution.min"),imageValidateSizeLabelImageResolutionTooHigh:w.get(t+"image.resolution.max"),imageValidateSizeLabelExpectedMinResolution:w.get(t+"image.resolution.expected.min"),imageValidateSizeLabelExpectedMaxResolution:w.get(t+"image.resolution.expected.max"),imageValidateSizeLabelImageRatioInvalid:w.get(t+"image.ratio.invalid"),imageValidateSizeLabelImageRatioExpected:w.get(t+"image.ratio.expected")}}},{key:"_mapEditorOptions",value:function(){var e=this.settings.translatePrefix;if(this.settings.imageEditorCropRatios&&this.settings.imageEditorCropRatios.length>0)for(var t=0;t<this.settings.imageEditorCropRatios.length;t++){var n=this.settings.imageEditorCropRatios[t];""===n.value&&(n.value=null)}if(this.settings.imageEditor)if(this.settings.imageEditorPintura){var i=this,r={utils:this.settings.imageEditorPinturaConfig.utils};if(this._pinturaEditorImageWriterOptions=this._pinturaEditorImageWriterOptions||{},window.clUploadOutputQuality&&(this._pinturaEditorImageWriterOptions.quality=window.clUploadOutputQuality/100),-1!==this.settings.imageEditorPinturaConfig.utils.indexOf("crop")&&(r.imageCropMinSize=this.settings.imageSizeValidate?{width:this.settings.imageWidthMin?this.settings.imageWidthMin:1,height:this.settings.imageHeightMin?this.settings.imageHeightMin:1}:{width:1,height:1},r.cropSelectPresetOptions=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=void 0;if(i.value)if("string"==typeof i.value&&-1!==i.value.indexOf(":")){var o=i.value.split(":");o.length>1&&(r=Math.round(parseFloat(o[0])/parseFloat(o[1])*1e3)/1e3)}else r=i.value;t.push([r,i.label])}return t}(this.settings.imageEditorCropRatios),r.imageCropAspectRatio=r.cropSelectPresetOptions.length?r.cropSelectPresetOptions[0][0]:void 0,r.cropEnableRotationInput=this.settings.imageEditorPinturaConfig.cropRotate,r.cropEnableButtonRotateLeft=this.settings.imageEditorPinturaConfig.cropRotate,r.cropEnableButtonRotateRight=!1,r.cropEnableZoomInput=this.settings.imageEditorPinturaConfig.cropZoom,r.cropEnableZoom=this.settings.imageEditorPinturaConfig.cropZoom,r.cropEnableCenterImageSelection=!this.settings.imageEditorPinturaConfig.cropZoom,r.cropEnableButtonFlipHorizontal=this.settings.imageEditorPinturaConfig.cropFlip,r.cropEnableButtonFlipVertical=this.settings.imageEditorPinturaConfig.cropFlip,this.settings.imageEditorPinturaConfig.cropShape&&this.settings.imageEditorPinturaConfig.cropShapes&&this.settings.imageEditorPinturaConfig.cropShapes.length?this._editorCropShapes(r):this._pintura&&this._pintura.editorOptions.cropWillRenderTools&&this._editorCropShapesReset(r)),-1!==this.settings.imageEditorPinturaConfig.utils.indexOf("annotate")){var o=[];this.settings.imageEditorPinturaConfig.annotateText&&o.push("text"),this.settings.imageEditorPinturaConfig.annotateDraw&&o.push("sharpie"),this.settings.imageEditorPinturaConfig.annotateShapes&&o.push("line","arrow","rectangle","ellipse"),r.markupEditorToolbar=pintura.createMarkupEditorToolbar(o),r.annotateActiveTool=o.length?o[0]:void 0,r.markupEditorToolStyles=pintura.createMarkupEditorToolStyles({text:pintura.createMarkupEditorToolStyle("text",{fontSize:"10%"})}),r.markupEditorShapeStyleControls=pintura.createMarkupEditorShapeStyleControls({lineHeightOptions:!1})}window.pinturaLocale||(window.pinturaLocale=s({},pintura.locale_en_gb,pintura.markup_editor_locale_en_gb,pintura.plugin_crop_locale_en_gb,pintura.plugin_filter_locale_en_gb,pintura.plugin_finetune_locale_en_gb,pintura.plugin_annotate_locale_en_gb)),r.locale=s({},window.pinturaLocale,{labelReset:w.get(e+"image.editor.button.reset"),labelClose:w.get(e+"image.editor.button.cancel"),labelButtonCancel:w.get(e+"image.editor.button.cancel"),labelButtonExport:w.get(e+"image.editor.button.confirm"),statusLabelLoadImage:function(t){return t&&t.task?t.error?"IMAGE_TOO_SMALL"===t.error.code?w.get(e+"image.size.expected.min"):w.get(e+"image.editor.status.error"):(t.task,w.get(e+"image.editor.status.loading")):w.get(e+"image.editor.status.waiting")},statusLabelProcessImage:function(t){if(t&&t.task)return"store"===t.task?t.error?w.get(e+"image.editor.status.error"):"Uploading image…":t.error?"Error processing image":w.get(e+"image.editor.status.processing")},cropLabel:w.get(e+"image.editor.util.crop"),cropLabelTabZoom:w.get(e+"image.editor.crop.zoom"),cropLabelButtonRotateLeft:w.get(e+"image.editor.crop.rotate.left"),cropLabelButtonRotateRight:w.get(e+"image.editor.crop.rotate.right"),cropLabelButtonFlipHorizontal:w.get(e+"image.editor.crop.flip.horizontal"),cropLabelButtonFlipVertical:w.get(e+"image.editor.crop.flip.vertical"),cropLabelSelectPreset:w.get(e+"image.editor.crop.aspect.ratio"),filterLabel:w.get(e+"image.editor.util.filter")}),r.locale.cropLabelTabRotation=w.translations[e+"image.editor.crop.rotation"]?w.translations[e+"image.editor.crop.rotation"]:r.locale.cropLabelTabRotation,r.locale.filterLabel=w.translations[e+"image.editor.util.finetune"]?w.translations[e+"image.editor.util.finetune"]:r.locale.filterLabel,r.locale.annotateLabel=w.translations[e+"image.editor.util.annotate"]?w.translations[e+"image.editor.util.annotate"]:r.locale.annotateLabel,this.settings.imageEditorPinturaConfig.options&&Object.assign(r,this.settings.imageEditorPinturaConfig.options),this._pintura?Object.assign(this._pintura.editorOptions,r):this._pintura={createEditor:function(e,t){var n=i;return i._pintura.editor=pintura.openEditor(e,t),i._pintura.editor.on("load",(function(e){if(_.debug("pintura image loaded:",e),n._pintura.editor.cropSelectPresetOptions&&n._pintura.editor.cropSelectPresetOptions.length>0&&e.size.width&&e.size.height){for(var t=e.size.width/e.size.height,i=null,r=-1,o=0;o<n._pintura.editor.cropSelectPresetOptions.length;o++){var a=n._pintura.editor.cropSelectPresetOptions[o][0];if(null==a)break;var s=Math.abs(a-t);_.debug("aspect ratio check : "+a+" diff: "+s),(-1===r||s<r)&&(r=s,i=a)}if(null!=i){if(n.settings.imageSizeValidate&&n.settings.imageResolutionMin){var l=Math.sqrt(n.settings.imageResolutionMin),u=l*i,c=l/i;_.debug("min resolution crop box in ratio width: "+u+" height: "+c),n._pintura.editor.imageCropMinSize={width:Math.min(u,e.size.width),height:Math.min(c,e.size.height)}}_.debug("aspect ratio select : "+i),n._pintura.editor.imageCropAspectRatio=i}}})),i._pintura.editor.on("processerror",(function(e){_.error("pintura processerror",e)})),i._pintura.editor.on("loaderror",(function(e){_.error("pintura loaderror",e)})),i._pintura.editor},afterWriteImage:function(e){var t=e.src,n=e.dest,r=e.imageState,o=i;return new Promise((function(e,i){var a=function(e){if(o.settings.imageTransforms.hasOwnProperty(e)){var i=o.settings.imageTransforms[e]({}),a=null;if(i.resize&&((a=s({},o._pinturaEditorImageWriterOptions)).targetSize={width:i.resize.size.width,height:i.resize.size.height,fit:"cover"}),null!=a)u.push(pintura.processImage(t,{imageReader:pintura.createDefaultImageReader(),imageWriter:pintura.createDefaultImageWriter(a),imageState:r}).then((function(t){return{name:e,file:t.dest}})));else{var l={name:e,file:n};o.settings.imageEditorPinturaConfig.cropSave&&(l.meta={crop:JSON.stringify(s({},r.crop,{rotation:0!==r.rotation?r.rotation:void 0,flipX:r.flipX?r.flipX:void 0,flipY:r.flipY?r.flipY:void 0}))}),u.push(Promise.resolve(l))}}},l=o,u=[];for(var c in o.settings.imageTransforms)a(c);Promise.all(u).then((function(n){l.settings.imageOriginal&&n.push({name:"_original",file:t}),e(n)})).catch(i)}))},imageReader:[pintura.createDefaultImageReader],imageWriter:[pintura.createDefaultImageWriter,this._pinturaEditorImageWriterOptions],imageProcessor:pintura.processImage,editorOptions:s({},pintura.getEditorDefaults(),r,{handleEvent:function(e,t){console.debug(e,t)}})}}else{var a=this,l={utils:["crop"],cropMinImageWidth:this.settings.imageSizeValidate&&this.settings.imageWidthMin?this.settings.imageWidthMin:1,cropMinImageHeight:this.settings.imageSizeValidate&&this.settings.imageHeightMin?this.settings.imageHeightMin:1,cropShowSize:!1,cropAllowInstructionZoom:!1,cropAllowResizeRect:!0,cropAspectRatio:null,cropAspectRatioOptions:this.settings.imageEditorCropRatios,outputCorrectImageExifOrientation:!0,onload:function(e){if(_.debug("doka image loaded:",e),a.settings.imageEditorCropRatios&&a.settings.imageEditorCropRatios.length>0&&e.width&&e.height){for(var t=e.height/e.width,n=null,i=-1,r=0;r<a.settings.imageEditorCropRatios.length;r++){var o=a.settings.imageEditorCropRatios[r];if(null==o.value)break;if(-1!==o.value.indexOf(":")){var s=o.value.split(":");if(s.length>1){var l=parseFloat(s[1])/parseFloat(s[0]),u=Math.abs(l-t);_.debug("aspect ratio check : "+o.value+" diff: "+u),(-1===i||u<i)&&(i=u,n=l)}}}if(null!=n){if(a.settings.imageSizeValidate&&a.settings.imageResolutionMin){var c=Math.sqrt(a.settings.imageResolutionMin),d=c/n,f=c*n;_.debug("min resolution crop box in ratio width: "+d+" height: "+f),a._doka.setOptions({cropMinImageWidth:d,cropMinImageHeight:f})}_.debug("aspect ratio select : "+n),a._doka.setData({crop:{aspectRatio:n}})}}},oncancel:function(){a.settings.imageSizeValidate&&a.settings.imageResolutionMin&&a._doka.setOptions({cropMinImageWidth:a.settings.imageSizeValidate&&a.settings.imageWidthMin?a.settings.imageWidthMin:1,cropMinImageHeight:a.settings.imageSizeValidate&&a.settings.imageHeightMin?a.settings.imageHeightMin:1})},onconfirm:function(){a._doka.setOptions({cropMinImageWidth:a.settings.imageSizeValidate&&a.settings.imageWidthMin?a.settings.imageWidthMin:1,cropMinImageHeight:a.settings.imageSizeValidate&&a.settings.imageHeightMin?a.settings.imageHeightMin:1})},onloaderror:function(e){_.error("doka load error",e)},labelButtonReset:w.get(e+"image.editor.button.reset"),labelButtonCancel:w.get(e+"image.editor.button.cancel"),labelButtonConfirm:w.get(e+"image.editor.button.confirm"),labelStatusAwaitingImage:w.get(e+"image.editor.status.waiting"),labelStatusLoadingImage:w.get(e+"image.editor.status.loading"),labelStatusLoadImageError:w.get(e+"image.editor.status.error"),labelStatusProcessingImage:w.get(e+"image.editor.status.processing"),labelColorBrightness:w.get(e+"image.editor.color.brightness"),labelColorContrast:w.get(e+"image.editor.color.contrast"),labelColorExposure:w.get(e+"image.editor.color.exposure"),labelColorSaturation:w.get(e+"image.editor.color.saturation"),labelResizeWidth:w.get(e+"image.editor.resize.width"),labelResizeHeight:w.get(e+"image.editor.resize.height"),labelResizeApplyChanges:w.get(e+"image.editor.resize.apply"),labelButtonCropZoom:w.get(e+"image.editor.crop.zoom"),labelButtonCropRotateLeft:w.get(e+"image.editor.crop.rotate.left"),labelButtonCropRotateRight:w.get(e+"image.editor.crop.rotate.right"),labelButtonCropFlipHorizontal:w.get(e+"image.editor.crop.flip.horizontal"),labelButtonCropFlipVertical:w.get(e+"image.editor.crop.flip.vertical"),labelButtonCropAspectRatio:w.get(e+"image.editor.crop.aspect.ratio"),labelButtonUtilCrop:w.get(e+"image.editor.util.crop"),labelButtonUtilFilter:w.get(e+"image.editor.util.filter"),labelButtonUtilColor:w.get(e+"image.editor.util.color"),labelButtonUtilResize:w.get(e+"image.editor.util.resize"),labelButtonUtilMarkup:w.get(e+"image.editor.util.markup"),labelMarkupTypeEllipse:w.get(e+"image.editor.util.markup.circle"),labelMarkupTypeText:w.get(e+"image.editor.util.markup.text"),labelMarkupTypeLine:w.get(e+"image.editor.util.markup.arrow"),labelMarkupRemoveShape:w.get(e+"image.editor.util.markup.remove"),labelMarkupToolSelect:w.get(e+"image.editor.util.markup.select"),labelMarkupToolDraw:w.get(e+"image.editor.util.markup.draw"),labelMarkupToolLine:w.get(e+"image.editor.util.markup.arrow"),labelMarkupToolRect:w.get(e+"image.editor.util.markup.square"),labelMarkupToolEllipse:w.get(e+"image.editor.util.markup.circle"),labelMarkupSelectFontSize:w.get(e+"image.editor.util.markup.size")};this._doka?this._doka.setOptions(l):this._doka=Doka.create(l)}else this._doka?(this._doka.destroy(),delete this._doka):this._pintura&&(this._pintura.instance&&this._pintura.instance.destroy(),delete this._pintura)}},{key:"_editorCropShapes",value:function(e){var t=this,n=function(e){var n=t.settings.imageEditorPinturaConfig.cropShapes[e];if(r.push([n.label,n.label]),o[n.label]=a(n.value,20,24),n.value){var i=t,s=document.createElement("img");s.onload=function(){return i._cropShapeImg[n.label]=s};try{s.src=URL.createObjectURL(new Blob([n.value],{type:"image/svg+xml"}))}catch(e){_.error("failed to parse svg crop shape",n,e)}}},i=this;e.imageCropShape=this.settings.imageEditorPinturaConfig.cropShapes[0].label,this._cropShapeImg=this._cropShapeImg||{},this._cropShapeCanvas=this._cropShapeCanvas||{};for(var r=[],o={},a=function(e,t,n){if(e)try{var i=document.createElement("div"),r=document.createRange().createContextualFragment(e),o=r.firstElementChild;return o.getAttribute("viewbox")||o.setAttribute("viewbox","0 0 "+o.getAttribute("width")+" "+o.getAttribute("height")),o.setAttribute("width",t),o.setAttribute("height",n),o.firstElementChild&&o.firstElementChild.setAttribute("fill","currentColor"),i.appendChild(r),i.innerHTML}catch(t){_.error("failed to parse svg crop shape",e,t)}return'<rect fill="transparent" x="0" y="0" width="'.concat(t,'" height="').concat(n,'" />')},l=0;l<this.settings.imageEditorPinturaConfig.cropShapes.length;l++)n(l);var d=function(e,t){if(i._cropShapeCanvas.hasOwnProperty(e)&&i._cropShapeBgRatio===t){var n=i._cropShapeCanvas[e];if(n.width>1&&n.height>1)return n}var r=i._cropShapeImg[e];if(r){var o=document.createElement("canvas");o.width=1e3,o.height=o.width/t;var a,s,l,c,d=o.getContext("2d");d.fillStyle="#505050",d.globalAlpha=.5,d.fillRect(0,0,o.width,o.height),d.globalAlpha=1;var f,p,h=r.naturalWidth/r.naturalHeight;return a=(f=u(t<=h?[o.width,o.width/h]:[o.height*h,o.height]))[0],s=f[1],l=(p=[(o.height-s)/2,(o.width-a)/2])[0],c=p[1],d.globalCompositeOperation="destination-out",d.drawImage(r,c,l,a,s),i._cropShapeCanvas[e]=o,i._cropShapeBgRatio=t,o}return""};if(r.length>1){var f=this,p=this.settings.translatePrefix+"image.editor.crop.shapes",h={icon:this.settings.imageEditorPinturaConfig.cropShapes[0].value?o[r[0][0]]:o[r[1][0]],label:w.translations[p]?w.get(p):"Shapes",labelClass:"PinturaToolbarContentWide",options:r,selectedIndex:0,onchange:function(e){h.selectedIndex=e.index,h.icon=o[e.label],f._pintura.editor.imageCropShape=e.value,f._pinturaRedraw&&f._pinturaRedraw()},optionMapper:function(e){return e.icon=o[e.label],s({},e,{disabled:!1})}},g=["Dropdown","select-shape",h];e.cropWillRenderTools=function(e,t,n){return f._pintura.editor.imageCropShape&&h.selectedIndex>0&&(h.selectedIndex<r.length?f._pintura.editor.imageCropShape!==r[h.selectedIndex][0]&&(h.selectedIndex=0):h.selectedIndex=0),f._pinturaRedraw=n,c(e).concat([g])}}else e.cropWillRenderTools=function(e){return e};e.willRenderCanvas=function(e,t){var n=t.utilVisibility,r=t.selectionRect;t.lineColor,t.backgroundColor;return n.crop<=0?e:i._pintura.editor.imageCropShape&&i._cropShapeImg[i._pintura.editor.imageCropShape]?(void 0===i._pintura.editor.imageCropAspectRatio&&(i._pintura.editor.imageCropAspectRatio=1),s({},e,{interfaceShapes:[{x:r.x,y:r.y,width:r.width,height:r.height,opacity:n.crop,backgroundImage:d(i._pintura.editor.imageCropShape,i._pintura.editor.imageCropAspectRatio),backgroundSize:"force"}].concat(c(e.interfaceShapes))})):e},this._pinturaEditorImageWriterOptions.mimeType="image/png",this._pinturaEditorImageWriterOptions.postprocessImageData=function(e){return new Promise((function(t){if(i._pintura.editor.imageCropShape){var n=i._cropShapeImg[i._pintura.editor.imageCropShape];if(n){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var o,a,s,l,c,d,f=r.getContext("2d"),p=n.naturalWidth/n.naturalHeight,h=r.width/r.height;f.putImageData(e,0,0),f.globalCompositeOperation="destination-in",o=(c=u(h<=p?[r.width,r.width/p]:[r.height*p,r.height]))[0],a=c[1],s=(d=[(r.height-a)/2,(r.width-o)/2])[0],l=d[1],f.drawImage(n,l,s,o,a),t(f.getImageData(0,0,r.width,r.height))}else t(e)}else t(e)}))}}},{key:"_editorCropShapesReset",value:function(e){e.imageCropShape="",e.cropWillRenderTools=function(e){return e},e.willRenderCanvas=function(e){return e},delete this._pinturaEditorImageWriterOptions.mimeType,delete this._pinturaEditorImageWriterOptions.postprocessImageData}},{key:"_triggerEvent",value:function(e,t){var n=new CustomEvent(e,{detail:t,cancelable:!0,bubbles:!0});this._pond.element.dispatchEvent(n)}},{key:"_storeFile",value:function(e){this.files[e.uuid]=e,e.parent&&this.files.hasOwnProperty(e.parent)&&(this.files[e.parent].childs||(this.files[e.parent].childs={}),this.files[e.parent].childs[e.uuid]=e),this._triggerEvent("upload:added",e),e.childs&&this._storeFiles(e.childs)}},{key:"_storeFiles",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];this._storeFile(n)}}},{key:"_removeFile",value:function(e){if(delete this.files[e.uuid],this._triggerEvent("upload:removed",e),e.childs)for(var t in e.childs){var n=this.files[t];delete this.files[t],this._triggerEvent("upload:removed",n)}}},{key:"_addStoreFiles",value:function(){for(var e in this.files)if(this.files.hasOwnProperty(e)){var t=this.files[e];if(!t.parent){var n={type:"local",file:{serverId:e,name:t.name,size:t.size,type:t.mimeType},metadata:{imageSize:t.meta.width?{height:t.meta.height,width:t.meta.width}:void 0,imageValidate:this.settings.imageSizeValidate}};this._pond.addFile(e,n)}}}},{key:"_download",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"upload.jpg",i=new h(e,{method:"GET",responseType:"blob",onProgress:t}).then((function(e){return new File([e.data],n,{type:e.data.type})}));return i}},{key:"_upload",value:function(e,t){try{var n=this,i=this._provider.upload(e,t),r=new Promise((function(e,t){var r=n;i.then((function(n){for(var i=r,o=0;o<n.length;o++)delete n[o]._file;var a=n[0],s=Promise.resolve();r.settings.convert&&r.settings.convertInfo&&-1!==r.settings.convertInfoMimeTypes.indexOf(a.mimeType)&&(s=r._infoAsync(a)),s.then((function(){var r=i;i._fileMeta.saveFile(a).then((function(t){var i=[],o=r._editAsync(t);if(o)i.push(o);else{r._storeFile(t),r._storeAsyncFile(t);for(var a=1;a<n.length;a++){var s=r,l=n[a];l.parent=t.uuid,i.push(r._fileMeta.saveFile(l).then((function(e){return s._storeFile(e),e})))}}Promise.all(i).then((function(n){n.unshift(t),e(n)}))})).catch((function(e){t(e)}))})).catch((function(t){e([])}))})),i.catch((function(e){t(e)}))}));return r.cancel=function(){i.cancel()},r}catch(e){return Promise.reject(e)}}},{key:"_remove",value:function(e){var t=this;return this._fileMeta.removeFile(e).then((function(){t._removeFile(e)})).catch((function(e){throw e}))}},{key:"_fileEditable",value:function(e){return(!this.settings.convert||-1===this.settings.convertMimeTypes.indexOf(e.type))&&this.settings.imageEditable(e.type)}},{key:"_editAsync",value:function(e){if(this.settings.convert&&-1!==this.settings.convertMimeTypes.indexOf(e.mimeType)){var t=this;e.meta.variant="convert";var n=".jpg",i=this.settings.api.replace("api","convert").replace("local","dev")+"/convert/"+e.path,r=[];"application/pdf"===e.mimeType?(this.settings.pdfDpi&&r.push("dpi="+this.settings.pdfDpi),this.settings.pdfImageWidth&&r.push("width="+this.settings.pdfImageWidth),this.settings.pdfImageHeight&&r.push("height="+this.settings.pdfImageHeight),this.settings.pdfMultiPage||r.push("page=0"),this.settings.pdfTransparent&&(n=".png",r.push("output=png"))):"image/svg+xml"!==e.mimeType&&"application/postscript"!==e.mimeType||(n=".png",r.push("output=png"),r.push("width=2000")),r.length&&(i+="?"+r.join("&"));var o=e.name;return this._asyncOriginalExtension=n,this._download(i,null,o).then((function(n){var i=t;return t._pond.removeFile(),t._remove(e),t._pond.addFile(n).then((function(t){i._asyncOriginal=e})),{}})).catch((function(n){var i=t;return _.error("file conversion error",n),t._pond.removeFile(),t._remove(e).then((function(){i._triggerEvent("upload:errors",[w.get(i.settings.translatePrefix+"error.fileConvert")])})),delete t._asyncOriginalExtension,{}}))}return!1}},{key:"_infoAsync",value:function(e){var t=this,n=this.settings.api.replace("api","convert").replace("local","dev")+"/info/"+e.path;return new h(n,{method:"GET",responseType:"json",queryParams:this.settings.queryParams}).then((function(n){var i=n.data;e.meta=p.extend(e.meta,i);var r=[];if(i.hasOwnProperty("pages")&&(t.settings.convertInfoPagesMin&&i.pages<t.settings.convertInfoPagesMin&&r.push(w.get(t.settings.translatePrefix+"error.filePagesMin",{min:t.settings.convertInfoPagesMin})),t.settings.convertInfoPagesMax&&i.pages>t.settings.convertInfoPagesMax&&r.push(w.get(t.settings.translatePrefix+"error.filePagesMax",{max:t.settings.convertInfoPagesMax}))),r.length){var o=new Error("info validate error");throw o.errors=r,o}return e})).catch((function(e){throw _.warn("file info error",e),t._pond.removeFile(),e.errors&&t._triggerEvent("upload:errors",e.errors),e}))}},{key:"_storeAsyncFile",value:function(e){this._asyncOriginal&&(delete this._asyncOriginal.childs,this._asyncOriginal.parent=e.uuid,this._storeFile(this._asyncOriginal),delete this._asyncOriginal)}},{key:"_getFilePondServerImpl",value:function(){var e=this;return{process:function(t,n,i,r,o,a,s){Array.isArray(n)||(n=[{file:n}]);for(var l=[],u=0;u<n.length;u++)if(n[u].file){var c=e._fileMeta.fromNative(n[u].file),d=n[u].name;d||(d="original"),c.meta.variant=d,"original"===c.meta.variant&&i.imageSize&&(c.meta.width=i.imageSize.width,c.meta.height=i.imageSize.height);var f=c.name.lastIndexOf("."),h="";-1!==f&&(h=c.name.substring(f)),"original"!==c.meta.variant?("_original"===c.meta.variant&&e._asyncOriginalExtension&&(c.name=c.name.replace(h,""),h=e._asyncOriginalExtension,delete e._asyncOriginalExtension),c.name=c.name.replace(h,"")+("_"===c.meta.variant.charAt(0)?"":"_")+c.meta.variant+h):e._asyncOriginalExtension&&(-1===c.name.indexOf(e._asyncOriginalExtension)&&(c.name=c.name.replace(h,e._asyncOriginalExtension)),delete e._asyncOriginalExtension),e._asyncOriginalMeta&&"original"===c.meta.variant&&(c.meta=p.extend(c.meta,e._asyncOriginalMeta),delete e._asyncOriginalMeta),c.meta=p.extend(c.meta,e.settings.metaData),n[u].meta&&(c.meta=p.extend(c.meta,n[u].meta)),"original"===c.meta.variant?l.unshift(c):l.push(c)}var g=e._upload(l,(function(e){a(e.lengthComputable,e.loaded,e.total)}));return g.then((function(e){e&&e.length&&r(e[0].uuid)})),g.catch((function(e){o(e)})),{abort:function(){g.cancel(),s()}}},revert:function(t,n,i){var r=e.files[t];r?e._remove(r).then((function(){return n()})).catch((function(e){return i(e)})):(_.warn("no file found for: "+t),n())},remove:function(t,n,i){var r=e.files[t];r?e._remove(r).then((function(){return n()})).catch((function(e){return i(e)})):(_.warn("no file found for source: "+t),n())},restore:function(t,n,i,r,o,a){var s=e.files[t];if(s){var l=s.url,u=e._download(l,(function(e){r(e.lengthComputable,e.loaded,e.total)}));return u.then((function(e){n(e)})).catch((function(e){i(e)})),{abort:function(){u.cancel(),o()}}}i("no file found for source: "+t)},load:function(t,n,i,r,o,a){var s=e.files[t];if(s){var l=s.url,u=e._download(l,(function(e){r(e.lengthComputable,e.loaded,e.total)}));return u.then((function(e){n(e)})).catch((function(e){i(e)})),{abort:function(){u.cancel(),o()}}}i("no file found for source: "+t)},fetch:function(t,n,i,r,o,a){var s=e._download(t,(function(e){r(e.lengthComputable,e.loaded,e.total)}));return s.then((function(e){n(e)})).catch((function(e){i(e)})),{abort:function(){s.cancel(),o()}}}}}}]),t}();xe.providers=[];var Ge=xe,Ne={};!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof Ne?Ne=t():e.loadjs=t()}(Ne,(function(){var e=function(){},t={},n={},i={};function r(e,t){if(e){var r=i[e];if(n[e]=t,r)for(;r.length;)r[0](e,t),r.splice(0,1)}}function o(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function a(t,n,i,r){var o,s,l=document,u=i.async,c=(i.numRetries||0)+1,d=i.before||e,f=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(f)?((s=l.createElement("link")).rel="stylesheet",s.href=p,(o="hideFocus"in s)&&s.relList&&(o=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(f)?(s=l.createElement("img")).src=p:((s=l.createElement("script")).src=t,s.async=void 0===u||u),s.onload=s.onerror=s.onbeforeload=function(e){var l=e.type[0];if(o)try{s.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((r+=1)<c)return a(t,n,i,r)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(t,l,e.defaultPrevented)},!1!==d(t,s)&&l.head.appendChild(s)}function s(e,n,i){var s,l;if(n&&n.trim&&(s=n),l=(s?i:n)||{},s){if(s in t)throw"LoadJS";t[s]=!0}function u(t,n){!function(e,t,n){var i,r,o=(e=e.push?e:[e]).length,s=o,l=[];for(i=function(e,n,i){if("e"==n&&l.push(e),"b"==n){if(!i)return;l.push(e)}--o||t(l)},r=0;r<s;r++)a(e[r],i,n)}(e,(function(e){o(l,e),t&&o({success:t,error:n},e),r(s,e)}),l)}if(l.returnPromise)return new Promise(u);u()}return s.ready=function(e,t){return function(e,t){e=e.push?e:[e];var r,o,a,s=[],l=e.length,u=l;for(r=function(e,n){n.length&&s.push(e),--u||t(s)};l--;)o=e[l],(a=n[o])?r(o,a):(i[o]=i[o]||[]).push(r)}(e,(function(e){o(t,e)})),s},s.done=function(e){r(e,[])},s.reset=function(){t={},n={},i={}},s.isDefined=function(e){return e in t},s}));var Fe=function(){"use strict";function t(){i(this,t)}return o(t,null,[{key:"load",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{async:!0};return i.returnPromise=!0,e(Ne)(t,n,i)}},{key:"isReady",value:function(t){return Array.isArray(t)||(t=[t]),new Promise((function(n,i){e(Ne).ready(t,(function(){n(t)}))}))}},{key:"isDefined",value:function(t){return e(Ne).isDefined(t)}}]),t}(),ke=Fe,Ve=function(){"use strict";function e(t){i(this,e);this.settings=p.extend({api:"",path:{products:"/products/{handle}.{view}"}},t||{})}return o(e,[{key:"fakeProduct",value:function(e){this.isProduct=function(){return!0},this.getHandleFromUrl=function(){return e}}},{key:"isAdmin",value:function(){return null!=document.getElementById("admin_bar_iframe")}},{key:"isProduct",value:function(){return-1!==window.location.pathname.indexOf("/products/")||this.isProductPreview()}},{key:"isProductPreview",value:function(){return-1!==window.location.pathname.indexOf("/products_preview")}},{key:"getHandleFromUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.pathname;window.Shopify&&window.Shopify.routes&&window.Shopify.routes.root&&"/"!==window.Shopify.routes.root&&(e=e.replace(window.Shopify.routes.root,"/"));var t=e.replace(/\/$/,"").split("/"),n=("products"==t[t.length-2]||"products_preview"===t.pop())&&t[t.length-1].replace(/(.*)?\?.*$/,"$1");return decodeURIComponent(n)}},{key:"tryGetProduct",value:function(){return this.isProduct()?this.getProduct():new Promise((function(e,t){e(null)}))}},{key:"tryGetProductMap",value:function(){return this.isProduct()?this.getProduct().then((function(t){return e.products})):new Promise((function(t,n){t(e.products)}))}},{key:"parseProductJsonElements",value:function(){var t=document.querySelectorAll('[id^="ProductJson-"]');if(0===t.length&&(t=document.querySelectorAll('[data-product-json], [data-section-type="dynamic-featured-product"]')),t.length>0)for(var n=0;n<t.length;n++){var i=t[n];try{var r=JSON.parse(i.innerHTML);"object"==typeof r.product&&(r=r.product),r.handle&&(e.products[r.handle+".js"]=r)}catch(e){_.debug("error parsing ProductJson: ",i,e)}}}},{key:"getProduct",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"js";if(!t){var i=function(t){if(e.products.hasOwnProperty(t))return{v:new Promise((function(n,i){n(e.products[t])}))}};if(!(t=this.getHandleFromUrl())&&this.isProductPreview())for(var r in e.products){var o=i(r);if("object"===d(o))return o.v}}var a,s=t+"."+n;if(e.products[s])return new Promise((function(t,n){t(e.products[s])}));t?a=this.settings.api+this.settings.path.products.replace("{handle}",t).replace("{view}",n):this.isProductPreview()&&(a=window.location.href.replace("products_preview","products_preview."+n));var l=new h(a,{method:"GET",responseType:"json"});return l.then((function(t){var i=t.data;return"json"===n&&(i=t.data.product),e.products[s]=i,i})).catch((function(e){throw e}))}},{key:"isTheme",value:function(e){if(window.Shopify&&window.Shopify.theme){var t=window.Shopify.theme.theme_store_id;if("Dawn"===e&&(887===t||1368===t||1363===t||1356===t||1431===t||1434===t||1499===t||1500===t||1567===t))return!0;if(window.Shopify.theme.name&&-1!==window.Shopify.theme.name.toLowerCase().indexOf(e.toLowerCase()))return!0}return!1}},{key:"isThemeEditor",value:function(){return window.Shopify&&window.Shopify.designMode}},{key:"onThemeSectionEvent",value:function(e,t){return document.addEventListener("shopify:section:"+e,t)}},{key:"findProductForms",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.querySelectorAll('form[action*="/cart/add"]')}},{key:"findProductFormBestMatch",value:function(e,t){var n="#product_form_"+e,i=document.querySelector(n);if(i&&null!=i.querySelector("shopify-payment-terms")&&(i=null),!i){var r=null;if(t&&t.srcEl)for(var o=t.srcEl.parentNode;o;){if((r=this.findProductForms(o)).length){t.parentEl=o;break}o=o.parentNode}if(null!=r&&0!==r.length||(r=this.findProductForms()),1===r.length)return r[0];if(r.length>1)for(var a=0;a<r.length;a++){var s=r[a].getAttribute("id");if((!s||-1===s.indexOf("installment")&&-1===s.indexOf("instalment"))&&null==r[a].querySelector("shopify-payment-terms")&&(i=r[a]).dataset.productForm===e.toString())return i}}return i}},{key:"findProductFormVariantId",value:function(e){if(null!=e){var t=e.querySelector('[name=id], [name="id[]"]');if(null!=t&&t.value)return t.value}return null}},{key:"findProductFormQuantity",value:function(e,t){if(null!=e){var n=e.querySelector("[name=quantity]")||(t?t.querySelector("[name=quantity]"):null);if(null!=n)return parseInt(n.value)}return 1}},{key:"getFormProperties",value:function(e){var t=new FormData(e);return Array.from(t.keys()).reduce((function(e,n){if(-1!==n.indexOf("properties")){var i=n.indexOf("["),r=n.indexOf("]");if(-1!==i&&-1!==r){var o=n.substring(i+1,r);if(e.hasOwnProperty(o)){var a=t.getAll(n);e[o]=a[a.length-1]}else e[o]=t.get(n)}}return e}),{})}},{key:"findExpressPaymentButtons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.querySelectorAll('.shopify-payment-button, [data-shopify="payment-button"]')}},{key:"findExpressDynamicCheckoutCart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.querySelectorAll('#dynamic-checkout-cart, [data-shopify="dynamic-checkout-cart"]')}},{key:"isExpressPaymentButton",value:function(e){var t='.shopify-payment-button, [data-shopify="payment-button"]';return!!(e&&p.matches(e,t)||null!=p.findParent(e,t))}}],[{key:"getInstance",value:function(t){return e._instance||(e._instance=new e(t)),e._instance}}]),e}();Ve.products={},Ve.collections={};var Ue=Ve,Be=function(){"use strict";function e(t,n){i(this,e);this.config=t,this.settings=p.extend({api:"https://api.cloudlift.app",assets:"https://assets.cloudlift.app",queryParams:{},provider:"google",selector:".upload-container",selectorForm:'form[action*="/cart/add"]',classNamePrefix:"cl-upload",product:{},link:!0},n||{}),this.shopifyStore=Ue.getInstance(),p.isElement(this.settings.selector)?this.element=this.settings.selector:this.element=document.querySelector(this.settings.selector),_.info("--\x3e new upload-field: ",this.element),null!=this.element?this._init():_.warn("no elements with selector found: ",this.settings.selector)}return o(e,[{key:"uploadFile",value:function(e){return this._upload?this._upload.upload(e):Promise.reject("upload not ready")}},{key:"fileCount",value:function(){return this._upload.countFiles()}},{key:"updateConfig",value:function(e){_.debug("uploadField.updateConfig: ",e);var t=this.config.fileMultiple,n=this.config.hidden,i=this.config.imageSizeValidate;this.config=p.extend(this.config,e);var r=this._mapOptions();this._upload.updateOptions(r),this._displayUpload(),this._displayCounter(),this._syncQuantity(),this._removeErrors(),t===this.config.fileMultiple&&n==this.config.hidden||this._rebuildInputs(),(i||e.imageSizeValidate)&&this._upload.validateFiles()}},{key:"updateText",value:function(e){this._upload&&(e=w.translate(e),this.updateConfig({text:e}))}},{key:"updateLabel",value:function(e){e=w.translate(e),this._label?e?this._label.innerHTML=e:(this._label.parentNode.removeChild(this._label),delete this._label):e&&(this._label=document.createElement("label"),this._label.className=this.settings.classNamePrefix+"--label",this._label.innerHTML=e,this._wrapper.insertBefore(this._label,this._uploadDiv))}},{key:"updateCss",value:function(e){this.removeCss(),this._style=p.addStyleElement(e,this.settings.styleSelector)}},{key:"updateInputFields",value:function(e){if(!this._inputFields||e&&0!==e.length||(this._inputFields.parentNode.removeChild(this._inputFields),delete this._inputFields),e&&e.length>0){if(this._inputFields)for(;this._inputFields.firstChild;)this._inputFields.removeChild(this._inputFields.lastChild);else this._inputFields=document.createElement("div"),this._inputFields.className=this.settings.classNamePrefix+"--input-fields",this._wrapper.insertBefore(this._inputFields,this._wrapper.firstChild);for(var t=0;t<e.length;t++){var n=this,i=e[t];i.field||(i.field="input_"+t);var r=document.createElement("div");r.className=this.settings.classNamePrefix+"--input-field";var o=this.config.uuid+"-field-"+t;if(i.label){var a=document.createElement("label");a.className=this.settings.classNamePrefix+"--label",a.setAttribute("for",o),a.innerHTML=w.translate(i.label),r.appendChild(a)}var s=function(){var e=document.createElement("input");return e.type=i.type,e.required=!0===i.required,i.className?e.className=i.className:e.className=n.settings.classNamePrefix+"--input",i.min&&(e.minLength=i.min),i.max&&(e.maxLength=i.max),n.config.fieldProperty?e.name=n.config.fieldProperty+"["+i.field+"]":e.name=i.field,e.setAttribute("id",o),n._linkProductForm(e),e};if("select"===i.type){var l=document.createElement("select");if(l.required=!0===i.required,i.className?l.className=i.className:l.className=this.settings.classNamePrefix+"--input",this.config.fieldProperty?l.name=this.config.fieldProperty+"["+i.field+"]":l.name=i.field,l.setAttribute("id",o),this._linkProductForm(l),i.value)for(var u=i.value.split(","),c=0;c<u.length;c++){var d=u[c],f=document.createElement("option");f.value=d,f.innerText=d,l.appendChild(f)}r.appendChild(l)}else if("textarea"===i.type){var p=document.createElement("textarea");p.required=!0===i.required,i.className?p.className=i.className:p.className=this.settings.classNamePrefix+"--input",i.min&&(p.minLength=i.min),i.max&&(p.maxLength=i.max),this.config.fieldProperty?p.name=this.config.fieldProperty+"["+i.field+"]":p.name=i.field,i.value&&(p.placeholder=i.value),p.setAttribute("id",o),this._linkProductForm(p),r.appendChild(p)}else if("radio"===i.type){if(i.value)for(var h=i.value.split(","),g=0;g<h.length;g++){var m=h[g],E=document.createElement("label");E.style.display="block",E.style.cursor="pointer",E.innerText=m;var v=s();v.value=m,E.insertBefore(v,E.firstChild),r.appendChild(E)}}else if("color"===i.type){var _=!1;if(i.value){var I=i.value.split(",");if(I.length>1){_=!0,i.type="radio";for(var y=0;y<I.length;y++){var T=I[y],A=document.createElement("label");A.style.display="inline-block",A.style.cursor="pointer",A.innerHTML='<div class="cl-upload-color-rect" style="background-color:'+T+';">';var O=s();O.value=T,O.style.display="none",0===y&&(O.checked=!0),A.insertBefore(O,A.firstChild),r.appendChild(A)}i.type="color"}}if(!_){var R=null;try{(R=s()).value="!","color"===R.type&&"!"!==R.value?i.value&&(R.value=i.value):R=null}catch(e){R=null}null==R&&(i.type="text",(R=s()).pattern="#[0-9A-Fa-f]{6}",R.placeholder="#000000",i.value&&(R.value=i.value)),r.appendChild(R)}}else{var S=s();"checkbox"===i.type&&(S.value="✔"),i.value&&"text"===i.type&&(S.placeholder=i.value),r.appendChild(S)}this._inputFields.appendChild(r)}}}},{key:"removeCss",value:function(){this._style&&this._style.parentNode.removeChild(this._style)}},{key:"validate",value:function(){var e=[],t="upload.config.error.",n=this._upload.countFiles();if(this.config.required&&n<=0&&e.push(w.get(t+"required")),0===e.length&&(n<this.config.fileCountMin&&e.push(w.get(t+"fileCountMin",{min:this.config.fileCountMin})),this.config.fileMultiple&&n>this.config.fileCountMax&&e.push(w.get(t+"fileCountMax",{max:this.config.fileCountMax}))),this._upload.isReady()||e.push(w.get(t+"ready")),this._inputFields){for(var i=!0,r=this._inputFields.querySelectorAll("[required]"),o=0;o<r.length;o++){var a=r[o];a.checkValidity()||(a.classList.add(this.settings.classNamePrefix+"--invalid"),i=!1)}if(!i){var s=this;e.push(w.get(t+"inputs"));var l=function(){s._removeErrors(),s._inputFields.removeEventListener("change",l)};this._inputFields.addEventListener("change",l)}}return _.debug("validated upload-config: ",this.config,e),this._displayErrors(e),0===e.length}},{key:"clearValidations",value:function(){this._removeErrors()}},{key:"clearFiles",value:function(){this._upload.removeFiles()}},{key:"restore",value:function(e){this._upload.restoreFiles(e)}},{key:"send",value:function(e,t){return this._upload._fileMeta.sendTemplate(e,t)}},{key:"tag",value:function(e,t){return this._upload._fileMeta.tagOrder(e,t)}},{key:"onSubmit",value:function(){var e=this;this.config.fileSubmitRemove&&p.removeCookie("token"),this.config.fileSubmitClear&&setTimeout((function(){e.clearFiles()}),1e3)}},{key:"destroy",value:function(){this._upload&&this._upload.destroy(),this.removeCss(),this.element.removeChild(this._wrapper),this._styleGrid&&this._styleGrid.parentNode.removeChild(this._styleGrid)}},{key:"_init",value:function(){var e=this;this.config.css&&this.updateCss(this.config.css),this._wrapper=document.createElement("div"),this._wrapper.className=this.settings.classNamePrefix+"--wrapper "+this.config.className,this._wrapper.setAttribute("id",this.config.uuid),this._uploadDiv=document.createElement("div"),this._uploadDiv.className=this.settings.classNamePrefix+"--area",this._wrapper.appendChild(this._uploadDiv),this.element.appendChild(this._wrapper),this._findProductForm(),this.config.text&&(this.config.text=w.translate(this.config.text)),this.config.label&&this.updateLabel(this.config.label),this.config.inputFields&&this.updateInputFields(this.config.inputFields),this._loadResources().then((function(){e._checkImageValidateVariants();var t=e._mapOptions();e._upload=new Ge(t),e._uploadDiv=e._upload.getElement(),e._displayFileGrid(),e._displayImageEditor(),e._displayUpload(),e._subscribeEvents(),e._upload._triggerEvent("upload:ready",e),e._hasVariantConfigs()&&(e.settings.product&&e.settings.product.id?e._watchVariantChanges():_.warn("variantConfigs not supported - no product is set for config: "+e.config.uuid));var n=e._getAgent();!1!==window.clInApp&&e._isInApp(n)&&e._checkInAppFilePicker(n)}))}},{key:"_mapOptions",value:function(){var e=this,t=this.config.fieldId;t+="[]";var n={};if(this.settings.product&&this.settings.product.id&&(n.productId=this.settings.product.id,n.productHandle=this.settings.product.handle,n.productTitle=this.settings.product.title),this.element.dataset)for(var i in this.element.dataset)if(this.element.dataset.hasOwnProperty(i)){var r=this.element.dataset[i];if("config"===i){try{var o=JSON.parse(r);this.config=p.extend(this.config,o)}catch(e){_.warn("failed to parse data-config: "+r,e)}continue}n[i]=isNaN(Number(r))?r:Number(r),"orderId"!==i&&"itemId"!==i||(this.settings.queryParams[i]=r)}var a={};return this.config.imageThumbnail&&!this.config.serverTransform&&(a.thumbnail=function(t){return t.resize={size:{width:e.config.imageThumbnailWidth,height:e.config.imageThumbnailHeight}},t}),this.config.imageEditor&&(a.original=function(e){return e}),this.config.imageTransforms&&(a=this.config.imageTransforms),this.config.fileMultiple||(this.config.fileCountMin=0,this.config.fileCountMax=1),{selector:this._uploadDiv,provider:this.settings.provider,api:this.settings.api,queryParams:this.settings.queryParams,field:t,text:this.config.text,required:!1,metaData:n,fileMimeTypesValidate:this.config.fileMimeTypesValidate,fileMimeTypes:this.config.fileMimeTypes,fileSizeMax:(this.config.fileSizeMax&&this.config.fileSizeMax<this.config.fileSizeMaxPlan?this.config.fileSizeMax:this.config.fileSizeMaxPlan)+"MB",fileMultiple:this.config.fileMultiple,fileCountMin:this.config.fileCountMin,fileCountMax:this.config.fileCountMax,fileFetch:this.config.fileFetch,fileFetchConfig:this.config.uuid,convert:this.config.convert,convertMimeTypes:this.config.convertMimeTypes,convertInfo:this.config.convertInfo,convertInfoMimeTypes:this.config.convertInfoMimeTypes,convertInfoPagesQuantity:this.config.convertInfoPagesQuantity,convertInfoLengthQuantity:this.config.convertInfoLengthQuantity,convertInfoPagesMin:this.config.convertInfoPagesMin,convertInfoPagesMax:this.config.convertInfoPagesMax,pdfDpi:this.config.pdfDpi,pdfImageWidth:this.config.pdfImageWidth,pdfImageHeight:this.config.pdfImageHeight,pdfMultiPage:this.config.pdfMultiPage,pdfTransparent:this.config.pdfTransparent,imageTransforms:a,imageOriginal:this.config.imageOriginal||!this.config.imageEditor,imageResize:this.config.imageThumbnail,imageCrop:this.config.imageEditor,imageEditor:this.config.imageEditor,imageEditorOpen:this.config.imageEditorOpen,imageEditorUtils:this.config.imageEditorUtils,imageEditorCropRatio:this.config.imageEditorCropRestrict&&this.config.imageEditorCropRatios.length>0?this.config.imageEditorCropRatios[0].value:null,imageEditorCropRatios:this.config.imageEditorCropRestrict?this.config.imageEditorCropRatios:[],imagePreview:this.config.imagePreview,imagePreviewAppCloud:this.config.fileGrid,imageSizeValidate:this.config.imageSizeValidate,imageWidthMin:this.config.imageWidthMin,imageWidthMax:this.config.imageWidthMax,imageHeightMin:this.config.imageHeightMin,imageHeightMax:this.config.imageHeightMax,imageResolutionMin:this.config.imageResolutionMin,imageResolutionMax:this.config.imageResolutionMax,imageEditorPintura:this.config.imageEditorPintura,imageEditorPinturaConfig:this.config.imageEditorPinturaConfig,imageProcessCanvas:this.config.imageProcessCanvas,imageProcessBlob:this.config.imageProcessBlob,translatePrefix:"upload.config."}}},{key:"_loadResources",value:function(){var e="upload-lib",t=[];return this.config.imageEditor&&("fetch"in window||t.push(this.settings.assets+"/static/lib/fetch/fetch.min.js"),"log10"in Math&&"sign"in Math&&"assign"in Object&&"from"in Array&&["find","findIndex","includes"].reduce((function(e,t){return t in Array.prototype&&e}),!0)||t.push(this.settings.assets+"/static/lib/doka/doka.polyfill.min.js"),this.config.imageEditorPintura?(e+="-pintura",t.push(this.settings.assets+"/static/lib/pintura/pintura-iife.js"),t.push(this.settings.assets+"/static/lib/pintura/pintura.css"),"en"!==w.locale&&-1!==["de","es","fr","ru","it"].indexOf(w.locale)&&t.push(this.settings.assets+"/static/lib/pintura/locale/"+w.locale+".js")):(t.push(this.settings.assets+"/static/lib/doka/doka.min.js"),t.push(this.settings.assets+"/static/lib/doka/doka.min.css"))),t.length>0?ke.isDefined(e)?ke.isReady(e).then((function(){_.info("upload resources ready")})):ke.load(t,e,{async:!1}).then((function(){_.info("upload resources loaded")})).catch((function(e){_.error("failed to load resources: ",e)})):Promise.resolve()}},{key:"_subscribeEvents",value:function(){var e=this;this._inputs={},this.fileCounter=0,this._displayCounter(),this._syncQuantity(),this._uploadDiv.addEventListener("upload:added",(function(t){var n=t.detail;if(e.settings.link){var i=document.createElement("input");i.type="hidden",e._buildInputElement(i,n),e._inputs[n.uuid]=i,e._wrapper.appendChild(i)}e._removeErrors(),e._displayCounter(),e._syncQuantity()})),this._uploadDiv.addEventListener("upload:removed",(function(t){var n=t.detail;if(e.settings.link&&n&&e._inputs[n.uuid]){if(e._wrapper.removeChild(e._inputs[n.uuid]),delete e._inputs[n.uuid],e._inputsX&&e._inputsX[n.uuid]){for(var i in e._inputsX[n.uuid])e._inputsX[n.uuid].hasOwnProperty(i)&&(e._wrapper.removeChild(e._inputsX[n.uuid][i]),delete e._inputsX[n.uuid][i]);delete e._inputsX[n.uuid]}e.config.fileMultiple&&null==n.parent&&e._rebuildInputs()}e._removeErrors(),e._displayCounter(),e._syncQuantity()})),this._uploadDiv.addEventListener("upload:errors",(function(t){var n=t.detail;e._displayErrors(n)})),this._uploadDiv.addEventListener("upload:sort",(function(t){e._fileSort=t.detail.fileIds.reverse(),e._rebuildInputs()}))}},{key:"_linkProductForm",value:function(e){this._productFormLink&&e.setAttribute("form",this._productFormLink)}},{key:"_buildInputElement",value:function(e,t){var n;if(n="thumbnail"===t.meta.variant?this.config.fieldThumbnail?this.config.fieldThumbnail:"_thumbnail":"_original"===t.meta.variant?this.config.fieldOriginal?this.config.fieldOriginal:"original":"convert"===t.meta.variant?this.config.fieldConvert?this.config.fieldConvert:"source":this.config.field?this.config.field:"upload",this.config.fileMultiple){var i;if(null==t.parent){if(this.fileCounter++,i=this.fileCounter,this._fileSort){var r=this._fileSort.indexOf(t.uuid);_.trace("=> index of "+t.uuid+":",r),-1!==r&&(i=r+1)}_.debug("=> count: of "+t.uuid+":",i),t.meta.count=i}else t.parent&&this._upload.files[t.parent]&&(i=this._upload.files[t.parent].meta.count);i&&(n+="_"+i)}this.config.fieldProperty?e.name=this.config.fieldProperty+"["+n+"]":e.name=n,this.config.hidden&&(e.name=""),e.value=t.url,this._linkProductForm(e),this.config.fileName&&"original"===t.meta.variant&&this._buildInputElementExtend("name",t,this.config.fieldProperty+"[_"+n+"_name]",t.name),t.meta.crop&&this._buildInputElementExtend("crop",t,this.config.fieldProperty+"[_"+n+"_crop]",t.meta.crop)}},{key:"_buildInputElementExtend",value:function(e,t,n,i){var r;this._inputsX=this._inputsX||{},this._inputsX[t.uuid]=this._inputsX[t.uuid]||{},this._inputsX[t.uuid][e]?r=this._inputsX[t.uuid][e]:((r=document.createElement("input")).type="hidden",this._inputsX[t.uuid][e]=r,this._wrapper.appendChild(r),this._linkProductForm(r)),r.name=n,r.value=i}},{key:"_rebuildInputs",value:function(){for(var e in this.fileCounter=0,this._inputs)if(this._inputs.hasOwnProperty(e)){var t=this._upload.files[e],n=this._inputs[e];this._buildInputElement(n,t)}}},{key:"_removeErrors",value:function(){if(this._errors&&(this._wrapper.removeChild(this._errors),delete this._errors,this._inputFields))for(var e=this._inputFields.querySelectorAll("."+this.settings.classNamePrefix+"--invalid"),t=0;t<e.length;t++){e[t].classList.remove(this.settings.classNamePrefix+"--invalid")}}},{key:"_displayErrors",value:function(e){var t=this;this._removeErrors(),this._errors=document.createElement("div"),this._errors.className=this.settings.classNamePrefix+"--errors",this._wrapper.appendChild(this._errors);for(var n=0;n<e.length;n++){var i=this,r=e[n],o=document.createElement("div");o.className=this.settings.classNamePrefix+"--error",o.textContent=r,o.addEventListener("click",(function(e){var t=i;o.className+=" dismissed",setTimeout((function(){return t._errors.removeChild(o)}),500)})),this._errors.appendChild(o)}setTimeout((function(){return t._errors.className+=" open"}),100)}},{key:"_displayUpload",value:function(){!0===this.config.hidden?(this._uploadDiv.classList.add("cl-hide"),this._label&&this._label.classList.add("cl-hide")):(this._uploadDiv.classList.remove("cl-hide"),this._label&&this._label.classList.remove("cl-hide"))}},{key:"_displayCounter",value:function(){this.config.fileCounter&&(this.config.fileMultiple||this._counter)?(this._counter||(this._counter=document.createElement("div"),this._counter.className=this.settings.classNamePrefix+"--counter",this._wrapper.querySelector(".filepond--root").appendChild(this._counter)),this._counter.innerHTML=this._upload.countFiles()+"/"+this.config.fileCountMax):this._counter&&(this._counter.parentElement.removeChild(this._counter),delete this._counter)}},{key:"_syncQuantity",value:function(){if(this.config.fileQuantity&&this.config.fileMultiple||(this.config.convertInfoPagesQuantity||this.config.convertInfoLengthQuantity)&&this.config.convertInfo&&this.config.convert){var e=this;if(this.config.hidden)return;var t=function(){var t=e._upload.countFiles();return Math.max("number"==typeof window.clQuantityMin?window.clQuantityMin:1,t)};if((!this._quantityEl||!p.isInPage(this._quantityEl))&&(this._quantityEl=document.querySelector("input[name=quantity]"),this._quantityEl&&(this._quantityEl.readOnly="boolean"!=typeof window.clQuantityReadonly||window.clQuantityReadonly,this._quantityEl.readOnly))){var n=this;this._quantityEl.style.background="#eeeeee",this._quantityEl.addEventListener("change",(function(){var e=t();n._quantityEl.value==e||n.config.hidden||(n._quantityEl.value=e)}))}if(this._quantityEl){var i=t();this._quantityEl.value!=i&&(this._quantityEl.value=i,this._quantityEl.dispatchEvent(new Event("change")))}else _.warn("fileQuantity sync - no quantity el found")}}},{key:"_displayFileGrid",value:function(){if(this.config.fileGrid){var e=this;this._uploadDiv.classList.add(this.settings.classNamePrefix+"--grid");var t=-1;this._styleGrid=null;var n=function(){var n=Math.min(e._uploadDiv.offsetWidth,window.screen.width);if(n!==t&&0!==n){t=n,null!=e._styleGrid&&e._styleGrid.parentNode.removeChild(e._styleGrid);var i=n/120;i=i>=2?2*Math.floor(i/2):1,_.debug("calculated fileGrid grid columns:",i);var r=100/i;e._styleGrid=p.addStyleElement("#"+e.config.uuid+" .filepond--item {\n      width: calc("+r+"% - .5em);\n}")}};n(),window.addEventListener("resize",p.debounced(300,(function(){n()}))),window.addEventListener("orientationchange",(function(e){return window.dispatchEvent(new Event("resize"))}))}}},{key:"_displayImageEditor",value:function(){if(this.config.imageEditorPintura){var e=this.config.styles,t="\n                    .pintura-editor {\n                        --color-primary: ".concat(e["area-background-color"],";\n                        --color-primary-dark: ").concat(e["area-background-color"],";\n                        --color-primary-text: ").concat(e["label-color-drop"],";\n                        --border-radius: ").concat("0.0px"===e["area-border-radius"]?"0.1px":e["area-border-radius"],";\n                        --border-radius-round: ").concat("0.0px"===e["area-border-radius"]?"0.1px":e["area-border-radius"],";\n                     }\n                     .PinturaButtonExport {\n                         min-width: 100px;\n                     }\n                     @media only screen and (max-width: 425px) {\n                        .PinturaNavTools > .PinturaNavGroup.PinturaNavGroupFloat {\n                            display:none;\n                        }\n                     }\n                    ");p.addStyleElement(t)}}},{key:"_hasVariantConfigs",value:function(){return this.config.variantConfig&&this.config.variantConfigs&&this.config.variantConfigs.length>0}},{key:"_findProductForm",value:function(){if(this.settings.product&&"properties"===this.config.fieldProperty){if(this._productForm=p.findParent(this.element,this.settings.selectorForm),this._productForm||(this._productForm=this.shopifyStore.findProductFormBestMatch(this.settings.product.id,{srcEl:this.element})),this._productForm){if(this._productFormParent=this._productForm.contains(this._wrapper),!this._productFormParent){var e=this._productForm.getAttribute("id");e&&(this._productFormLink=e),this.shopifyStore.findExpressPaymentButtons().length&&(this._buyNowCapture=!0)}this._buyNowCapture=!0!==window.clBuyNow}}else if("attributes"===this.config.fieldProperty){var t=document.querySelectorAll('button[name="checkout"][form], input[name="checkout"][form]');if(t.length){var n=t[0];this._productFormLink=n.getAttribute("form")}}return null!==this._productForm}},{key:"_watchVariantChanges",value:function(){if(this._productForm=this._productForm||this.shopifyStore.findProductFormBestMatch(this.settings.product.id),this._productForm){var e=this;this._variantConfig={required:this.config.required,fileMultiple:this.config.fileMultiple,fileCountMin:this.config.fileCountMin,fileCountMax:this.config.fileCountMax,hidden:void 0!==this.config.hidden&&this.config.hidden,imageSizeValidate:this.config.imageSizeValidate,imageWidthMin:void 0!==this.config.imageWidthMin?this.config.imageWidthMin:null,imageHeightMin:void 0!==this.config.imageHeightMin?this.config.imageHeightMin:null,imageResolutionMin:void 0!==this.config.imageResolutionMin?this.config.imageResolutionMin:null,imageEditorCropRestrict:this.config.imageEditorCropRestrict,imageEditorCropRatios:this.config.imageEditorCropRatios};for(var t=0;t<this.config.variantConfigs.length;t++){var n=this.config.variantConfigs[t];for(var i in n)n.hasOwnProperty(i)&&this._variantConfig.hasOwnProperty(i)&&(!n.imageSettings&&i.startsWith("image")&&(n[i]=this._variantConfig[i]),!n.imageSizeValidate&&"imageEditorCropRestrict"===i&&n[i]&&this._enableImageValidate(n))}this._onVariantChange(null,!0),this._productForm.addEventListener("change",(function(t){return e._onVariantChange(t)}))}else _.warn("variantConfig no productForm found for config: "+this.config.uuid)}},{key:"_checkImageValidateVariants",value:function(){if(!this.config.imageSizeValidate&&this._hasVariantConfigs())for(var e=0;e<this.config.variantConfigs.length;e++){var t=this.config.variantConfigs[e];if(t.imageSettings&&(t.imageSizeValidate||t.imageEditorCropRestrict)){this._enableImageValidate(this.config);break}}}},{key:"_enableImageValidate",value:function(e){e.imageSizeValidate=!0,e.imageWidthMin=null,e.imageHeightMin=null,e.imageResolutionMin=null}},{key:"_onVariantChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.shopifyStore.findProductFormVariantId(this._productForm);if(n!==this._variantId){this._variantId=n,_.debug("---\x3e evaluating variant.id: "+this._variantId);for(var i=!1,r=0;r<this.config.variantConfigs.length;r++){for(var o=this.config.variantConfigs[r],a=0;a<o.variants.length;a++){var s=o.variants[a];if(s.id.toString()===this._variantId.toString()){var l={};for(var u in o)o.hasOwnProperty(u)&&this._variantConfig.hasOwnProperty(u)&&(l[u]=o[u]);this.updateConfig(l),i=!0;break}}if(i)break}i||t||this.updateConfig(this._variantConfig)}}},{key:"_getAgent",value:function(){return navigator.userAgent||navigator.vendor||window.opera}},{key:"_isInApp",value:function(e){return this._isInstagram(e)||this._isFacebook(e)||this._isTiktok(e)}},{key:"_isFacebook",value:function(e){return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1}},{key:"_isInstagram",value:function(e){return e.indexOf("Instagram")>-1}},{key:"_isTiktok",value:function(e){return e.indexOf("Bytedance")>-1}},{key:"_isIOS",value:function(e){return(e=e.toLowerCase()).indexOf("iphone")>-1||e.indexOf("ipad")>-1}},{key:"_isAndroid",value:function(e){return(e=e.toLowerCase()).indexOf("android")>-1}},{key:"_checkInAppFilePicker",value:function(e){var t=this,n="inapp",i=-1,r=function(n,i){var r=document.createElement("div");r.className="cl-inapp--fail";var a,s,l="upload.config.error.",u=t._isInstagram(e)?"instagram":t._isTiktok(e)?"tiktok":"facebook",c=t._isAndroid(e)?"android":"ios";r.innerHTML=(a=u,s=c,"\n                <style>\n                .cl-inapp--fail {\n                    width:100%; box-sizing:border-box; border-radius:5px; background-color: #e6615a; text-align:center; padding:1em; font-family: -apple-system, BlinkMacSystemFont, Roboto, Helvetica, Arial, sans-serif;\n                }\n                .cl-inapp--fail label {\n                    font-size:24px; font-weight:bold; color:white !important;\n                }\n                .cl-inapp--fail p {\n                    font-weight:450; color:white !important;\n                }\n                </style>\n                <label>".concat(w.get(l+"inapp"),"</label>\n                <p>").concat(w.get(l+"inapp."+a),'</p>\n                <img src="').concat("https://assets.cloudlift.app/static/img/inapp/"+s+".png",'" style="max-width: 100%;height: auto;" />\n            ')),t.element.insertBefore(r,t._wrapper),t._upload._fileMeta.inAppFailed(n,i),t._uploadDiv.removeEventListener("click",o,{capture:!0})},o=function(e){if("INPUT"===e.target.nodeName){var i=t,o=null,a=function(){o&&(clearTimeout(o),o=null),i._uploadDiv.removeEventListener("upload:select",a)};t._uploadDiv.addEventListener("upload:select",a);var s=!1,l=function(){document.hidden?(s=!0,window.localStorage&&window.localStorage.setItem(n,(new Date).getTime().toString())):s&&(document.removeEventListener("visibilitychange",l),o=setTimeout((function(){r(!1,!1)}),4e3))};document.addEventListener("visibilitychange",l)}};if(window.localStorage){var a=window.localStorage.getItem(n);a&&(i=(new Date).getTime()-parseInt(a)),window.localStorage.removeItem(n)}this._isTiktok(e)||(-1!==i&&i<1e4?r(!0,!1):this._uploadDiv.addEventListener("click",o,{capture:!0})),this._uploadDiv.addEventListener("upload:added",(function(e){var n=e.detail;if(n&&void 0!==n.meta.contentLength&&n.size>0&&0===n.meta.contentLength){var i=t;r(!1,!0),setTimeout((function(){return i._upload._pond.removeFile({revert:!0})}),1e3)}}))}}]),e}(),qe=Be,ze=function(){"use strict";function e(t){i(this,e);this.cache=null,this.settings=p.extend({api:"",requestOptions:{responseType:"json",headers:{"Content-type":"application/json"}}},t||{})}return o(e,[{key:"addItem",value:function(e){return this._cartAdd(e)}},{key:"_cartAdd",value:function(e){return this._cartRequest("/cart/add.js",{method:"POST",data:e})}},{key:"_cartRequest",value:function(e,t){var n=p.extend(this.settings.requestOptions,t),i=this.settings.api+e;return new h(i,n).then((function(e){return _.debug("[shopify-cart] "+i+" response",e.data),e.data})).catch((function(e){throw _.error("[shopify-cart] "+i+" error",e),e.data}))}}],[{key:"getInstance",value:function(t){return e._instance||(e._instance=new e(t)),e._instance}}]),e}(),je=function(){"use strict";function e(t){i(this,e);this.settings=p.extend({api:"",path:"/api/storage",queryParams:{}},t||{})}return o(e,[{key:"upload",value:function(e,t){for(var n=this,i=function(i){var a=n,s=e[i];r.push(new Promise((function(e,n){a._getSignedUrl(s).then((function(r){var a={method:"PUT",headers:{"Content-type":s.mimeType},data:s._file};0===i&&(a.onProgress=t);var l=new h(r.upload,a);o.push(l),l.then((function(t){s.url=r.download,s.path=r.path;var n=parseInt(t.xhr.getResponseHeader("x-goog-stored-content-length"));isNaN(n)||s.meta&&(s.meta.contentLength=n),e(s)})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))})))},r=[],o=[],a=0;a<e.length;a++)i(a);var s=Promise.all(r).then((function(e){return _.info(e),e}));return s.cancel=function(){for(var e=0;e<o.length;e++){o[e].cancel()}},s}},{key:"_getSignedUrl",value:function(e){var t=this.settings.api+this.settings.path,n=p.extend(this.settings.queryParams,{name:encodeURIComponent(e.name),type:encodeURIComponent(e.mimeType),public:"1",cb:1e18*Math.random()+""});return new h(t,{method:"GET",queryParams:n}).then((function(e){return e.data}))}}]),e}(),We=function(){"use strict";function e(){i(this,e)}return o(e,null,[{key:"register",value:function(e){var t=this;return this.listeners.push(e),this.patched||this._patch(),function(){var n=t.listeners.indexOf(e);-1!==n&&t.listeners.splice(n,1),0===t.listeners.length&&t._unpatch()}}},{key:"_callListeners",value:function(t){for(var n=0;n<e.listeners.length;n++){(0,e.listeners[n])(t)}}},{key:"_patch",value:function(){e.originalOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(){var t=arguments[0],n=arguments[1];this.addEventListener("readystatechange",(function(){4==this.readyState&&200==this.status&&e._callListeners({method:t,url:n})}),!1),e.originalOpen.apply(this,arguments)},"function"==typeof window.fetch&&(e.originalFetch=window.fetch,window.fetch=function(){var t=arguments[0],n=void 0!==arguments[1]?arguments[1].method:"GET",i=e.originalFetch.apply(this,arguments);return i.then((function(){"object"==typeof t&&t.pathname&&(t=t.pathname+t.search),e._callListeners({method:n,url:t})})),i}),this.patched=!0}},{key:"_unpatch",value:function(){e.originalOpen&&(XMLHttpRequest.prototype.open=e.originalOpen),e.originalFetch&&(window.fetch=e.originalFetch),this.patched=!1}}]),e}();We.patched=!1,We.listeners=[];var He=We,Ye=function(){"use strict";function e(t,n){i(this,e),this.config=t,this.fields=[];var r={};if(window.Shopify&&window.Shopify.routes&&window.Shopify.routes.root&&"/"!==window.Shopify.routes.root){var o=window.Shopify.routes.root;r.api="/"===o[o.length-1]?o.substr(0,o.length-1):o}if(this.shopifyStore=Ue.getInstance({api:r.api}),this.shopifyCart=ze.getInstance(r),Ge.providers.google=new je({api:t.api,queryParams:{shop:t.shop}}),this.config.setup){var a=this;if(/complete|interactive|loaded/.test(document.readyState))this.setup();else{var s=this;_.debug("---\x3e document not ready ("+document.readyState+") => waiting for DOMContentLoaded"),document.addEventListener("DOMContentLoaded",(function(){return s.setup()}),!1)}this.shopifyStore.onThemeSectionEvent("load",(function(e){a.setup()}))}this._fixThemeStyles()}return o(e,[{key:"setup",value:function(){var e=this;if(this.destroy(),this.shopifyStore.parseProductJsonElements(),this.shopifyStore.tryGetProductMap().then((function(t){if(e.config.setup){for(var n=0;n<e.config.fields.length;n++){var i=e.config.fields[n];if(_.debug("-> evaluating upload-field:",i.uuid),0===i.conditionMode){var r=null;e.shopifyStore.isProduct()&&(r=t[e.shopifyStore.getHandleFromUrl()+".js"]);var o=e._createUploadField(i,r);_.debug("--\x3e evaluated upload-config:",i.uuid,r,o)}else if(i.conditions.length>0)for(var a in t)if(t.hasOwnProperty(a)){var s=t[a],l=e._evaluateConditions(i.conditions,i.conditionMode,s);if(l){var u="#product_form_"+s.id;(l=e._createUploadField(i,s,u))||(l=e._createUploadField(i,s))}_.debug("--\x3e evaluated upload-config:",i.uuid,s,l)}}0===e.fields.length&&e.shopifyStore.isThemeEditor()&&e._evaluateThemeEditor(t),e.fields.length>0&&e._validateFormSubmit(e.fields)}else _.debug("[setup] skipping upload fields setup=false")})),!1!==window.clProp){var t=this.config.fields.filter((function(e){return e.propertyTransform}));t.length>0&&this._watchCartProperties(t)}}},{key:"destroy",value:function(){for(;this.fields.length;){this.fields.pop().destroy()}}},{key:"_createUploadField",value:function(e,t,n){var i=null,r=null;t&&(r='[data-upload-lift="'+t.id+'"]'),e.fieldBlock&&(r||(r=""),r+='[data-upload-field="'+e.fieldBlock+'"]'),n||(n='form[action*="/cart/add"]',"contact"===e.fieldProperty?(n='form[action*="/contact"]',i="contact",r=null):"customer[note]"===e.fieldProperty?(n='form[action="/account"]',i="create_customer",r=null):"attributes"===e.fieldProperty?(n='form[action="/cart"], form[action$="/cart"], form[action*="/cart?"]',r=null):"order"===e.fieldProperty&&(n="",r=null));var o=this._findOrCreateContainer(e.selector,t,n,i,r);if(o){var a;a=Array.isArray(o)||p.isNodeList(o)?o:[o];for(var s=0;s<a.length;s++){var l=a[s];this.fields.push(new qe(e,{api:this.config.api,assets:this.config.assets,selector:l,link:this.config.link,queryParams:{shop:this.config.shop},product:t}))}return!0}return!1}},{key:"_findOrCreateContainer",value:function(e,t,n,i,r){var o,a,s=[];if(n&&(s=document.querySelectorAll(n)).length&&(a=s[0]),e){if(s.length){o=[];for(var l=0;l<s.length;l++){var u,d=s[l].querySelectorAll(e);d.length&&(u=o).push.apply(u,c(d))}if(o.length)return _.debug("using container in form with provided selector:",n,e,o),o}return(o=document.querySelectorAll(e)).length?(_.debug("using container with provided selector:",e,o),o):(_.debug("no container found with selector:",e),null)}if(r&&null!=(o=document.querySelector(r)))return _.debug("using container with default selector: ",r),o;if(i)if(a){for(var f=void 0,h=0;h<s.length;h++){var g=(a=s[h]).querySelector('form input[name="form_type"]');if(g&&g.value===i){f=a;break}}if(!f)return null;s=[a]}else{var m=document.querySelector('form input[name="form_type"]');m&&m.value===i&&(s=[a=p.findParent(m,"form")])}if(s.length){o=[];for(var E=0;E<s.length;E++){if(a=s[E],s.length>1){var v=a.getAttribute("id");if(v&&(-1!==v.indexOf("installment")||-1!==v.indexOf("instalment")))continue}var I=a.querySelector("[type=submit],[name=checkout],.add_to_cart,.btn.add-to-cart"),y=document.createElement("div");y.className="upload-container",y.style.width="100%",I?I.parentNode.insertBefore(y,I):a.action&&-1!==a.action.indexOf("/cart/add")?a.insertBefore(y,a.firstChild):a.appendChild(y),_.debug("injected container into form:",a),o.push(y)}if(o.length)return _.debug("using injected container:",o),o}return null}},{key:"_validateConfigs",value:function(e,t,n,i,r){var o=[];if(_.debug("validateConfigs:",n,i),0!==n.length){for(var a=0;a<n.length;a++){var s=n[a];if(r)if(p.findParent(s.element,"form")!==i)continue;o.push(s.validate(t))}if(-1!==o.indexOf(!1))e.preventDefault(),e.stopImmediatePropagation();else{for(var l=!1,u=0;u<n.length;u++){var c=n[u];c.onSubmit(),c._buyNowCapture&&(l=!0)}i&&"FORM"===i.tagName&&l&&this.shopifyStore.isExpressPaymentButton(e.target)&&this._manualFormSubmit(i,e,this.shopifyStore.settings.api+"/checkout")}}}},{key:"_manualFormSubmit",value:function(e,t,n){var i=this.shopifyStore.findProductFormVariantId(e);return i?(t&&(t.preventDefault(),t.stopImmediatePropagation()),this.shopifyCart.addItem({id:i,quantity:this.shopifyStore.findProductFormQuantity(e,document),properties:this.shopifyStore.getFormProperties(e)}).then((function(e){return n&&(window.location.href=n),e}))):(_.warn("[upload-lift] missing product variant for manualFormSubmit"),Promise.resolve(!1))}},{key:"_validateFormSubmit",value:function(e){for(var t=this,n=function(n){var r=e[n],o=p.findParent(r.element,"form");if(!o&&r.settings.product&&(o=t.shopifyStore.findProductFormBestMatch(r.settings.product.id,{srcEl:r.element})),o&&-1===i.indexOf(o)&&i.push(o),o&&!o.dataset.clValidate){var a=!1!==window.clUploadCartCapture,s=o.querySelector(".cl-cart-validate");if(null!=s&&(a=!1),a){var l=t,u='[type=submit],.add_to_cart,.add-to-cart,.product-addToCart,.addToCart,.addtocart-js,.shopify-payment-button, [data-shopify="payment-button"]';o.addEventListener("click",(function(t){t.target&&(p.matches(t.target,u)||null!=p.findParent(t.target,u))&&l._validateConfigs(t,"click",e,o,i.length>1)}),{capture:!0})}else{var c=t;o.addEventListener("submit",(function(t){return c._validateConfigs(t,"submit",e,o,i.length>1)}));for(var d=o.querySelectorAll("[type=submit],.add_to_cart,.btn.add-to-cart"),f=0;f<d.length;f++){var h=t;d[f].addEventListener("click",(function(t){return h._validateConfigs(t,"click",e,o,i.length>1)}))}for(var g=o.querySelectorAll(".shopify-payment-button"),m=0;m<g.length;m++){var E=t;g[m].addEventListener("click",(function(t){return E._validateConfigs(t,"click",e,o,i.length>1)}),{capture:!0})}null!=s&&s.addEventListener("click",(function(t){return c._validateConfigs(t,"click",e,o,i.length>1)}),{capture:!0})}o.dataset.clValidate=!0}},i=[],r=0;r<e.length;r++)n(r);var o=document.querySelector("[data-upload-lift-sticky]");null!=o&&o.addEventListener("click",(function(e){var t=document.querySelector(o.dataset.uploadLiftSticky);t?(e.preventDefault(),e.stopImmediatePropagation(),t.click()):_.warn("[upload-lift] sticky - no button found with selector:",o.dataset.uploadSticky)}),{capture:!0})}},{key:"_fixThemeStyles",value:function(){if(this.shopifyStore.isTheme("Dawn")||this.shopifyStore.isTheme("Ella")){p.addStyleElement("\n            .cl-upload--wrapper a:empty, .cl-upload--wrapper div:empty, .cl-upload--wrapper dl:empty, .cl-upload--wrapper pl:empty, .cl-upload--wrapper section:empty, .cl-upload--wrapper ul:empty, .cl-upload--wrapper canvas:empty {\n               display:block!important;\n             }\n             .doka--root a:empty, .doka--root div:empty, .doka--root dl:empty, .doka--rootpl:empty, .doka--root section:empty, .doka--root ul:empty, .doka--root canvas:empty {\n               display:block!important;\n             }\n             .pintura-editor a:empty, .pintura-editor div:empty, .pintura-editor dl:empty, .pintura-editorpl:empty, .pintura-editor section:empty, .pintura-editor ul:empty, .pintura-editor canvas:empty {\n               display:block!important;\n             }\n             .filepond--root {\n              z-index:1;\n             }\n            ")}}},{key:"_evaluateThemeEditor",value:function(e){var t="cl_upload_theme";if("0"!==p.readCookie(t))for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],r=this._findOrCreateContainer(null,i,'form[action*="/cart/add"]',null,'[data-upload-lift="'+i.id+'"]');if(r){var o=0===this.config.fields.length,a='<style>\n                            .cl-block { padding: 10px;border-radius: 3px;background-color: rgb(55, 167, 220, 1); border: 2px solid #000;margin-bottom: 10px;opacity: 0.75;position: relative; }\n                            .cl-block span { font-size:14px; display: block; margin-bottom:5px; }\n                            .cl-block a, .cl-block span { color:#fff; }\n                            .cl-block a.live { font-size:20px;font-weight:bold;line-height: 1;text-shadow: 1px 1px 1px black;text-decoration: none; }\n                            .cl-block a.link { font-weight:bold;text-shadow: 1px 1px 1px black; }\n                            .cl-block .live-close { position: absolute; right:7px; top:0px; font-size:20px; cursor:pointer; }\n                    </style>\n                    <span class="live-close">✅</span>\n                    <span><a class="live" href="/admin/apps/upload-lift">Upload Lift</a></span>\n                    <span>Upload field will appear here. '.concat(o?"":"<b>(only shown in editor)</b>","</span>");o&&(a+="<span><b>NEXT:</b> save the theme & continue with the setup in the app.</span>");var s=void 0;s=Array.isArray(r)||p.isNodeList(r)?r:[r];for(var l=0;l<s.length;l++){var u=s[l];u.classList.add("cl-block");var c=a,d=void 0!==u.dataset.uploadLift;o||d||(c+='<span>To change the location visit: <a class="link" href="https://docs.cloudlift.app/article/127-upload-field-block-in-theme-editor" target="_blank">Upload Field App Block</a></span>'),u.innerHTML=c,r.querySelector(".live-close").addEventListener("click",(function(e){r.parentElement.removeChild(r),p.writeCookie(t,"0",30,"/")}))}return}}}},{key:"_evaluateConditions",value:function(e,t,n){for(var i=!1,r=0;r<e.length;r++){var o=e[r];if(i=this._evaluateCondition(o,n),_.debug("evaluated condition: ",o,i),1==t){if(i)return _.debug("condition field "+o.field+" of the OR conditions matched"),!0}else if(!i)break}return i?(_.debug("all of the  "+e.length+" conditions matched in mode: "+t),i):(_.debug("not all of the "+e.length+" conditions matched in mode: "+t),i)}},{key:"_evaluateCondition",value:function(e,t){switch(e.field){case"product":for(var n=0;n<e.objects.length;n++)if(e.objects[n].id.toString()===t.id.toString())return!0;break;case"product_handle":if(this._evaluateOperation(e.operator,e.value,t.handle))return!0;break;case"product_title":if(this._evaluateOperation(e.operator,e.value,t.title))return!0;break;case"product_type":if(t.type&&this._evaluateOperation(e.operator,e.value,t.type))return!0;if(t.product_type&&this._evaluateOperation(e.operator,e.value,t.product_type))return!0;break;case"product_vendor":if(this._evaluateOperation(e.operator,e.value,t.vendor))return!0;break;case"product_tags":var i=void 0;if(Array.isArray(t.tags))i=t.tags;else{if(!t.tags)break;i=t.tags.indexOf(", ")>=0?t.tags.split(", "):[t.tags]}for(var r=0;r<e.tags.length;r++)for(var o=0;o<i.length;o++)if(e.tags[r].toString().toLowerCase().trim()===i[o].toString().toLowerCase().trim())return!0}return!1}},{key:"_evaluateOperation",value:function(e,t,n){if(n)return"equals"===e?n.toString().toLowerCase().trim()===t.toString().toLowerCase().trim():"contains"===e?n.toString().toLowerCase().trim().indexOf(t.toString().toLowerCase().trim())>-1:void 0}},{key:"_watchCartProperties",value:function(e){var t=this;this._processCartProperties(e);var n=p.debounced(1e3,(function(){return t._processCartProperties(e)}));He.register((function(e){e.url.length<100&&/.*cart.*/.test(e.url)&&n()}));setTimeout((function(){return n()}),2e3)}},{key:"_processCartProperties",value:function(e){for(var t=document.createNodeIterator(document.body,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return-1!==e.textContent.indexOf("cloudlift.app")&&"SCRIPT"!==e.parentNode.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),n=[],i=[],r=0;r<e.length;r++){var o=e[r];o.fieldThumbnailPreview&&(-1===i.indexOf(o.fieldThumbnail)?i.push(o.fieldThumbnail):n.push(o.fieldThumbnail)),-1===n.indexOf(o.field)&&n.push(o.field)}_.debug("--\x3e processing cart properties for upload fields: ",n),_.debug("--\x3e processing cart properties for thumbnail fields: ",i);for(var a=[],s=void 0;s=t.nextNode();)a.push(s);for(var l=0;l<a.length;l++){var u=(s=a[l]).textContent,c=u.match(/(https?:\/\/[^\s]+)/g);if(null!=c&&c.length>0){var d=c[0],f=document.createElement("span");f.className="cl-prop";for(var p="",h=s,g=0;g<3;g++){for(var m=h.textContent.replace(d,""),E=0;E<i.length;E++){var v=i[E];if(-1!==m.indexOf(v)){f.innerHTML='<img src="'+d+'" style="max-width:100px;max-height:100px;" />',3===h.nodeType?s.parentNode.replaceChild(f,s):(h.innerHTML="",h.appendChild(f)),p=v;break}}if(""===p)for(var I=0;I<n.length;I++){var y=n[I];if(-1!==m.indexOf(y)){f.innerHTML=u.replace(d,'<a href="'+d+'" target="_blank" style="cursor:pointer;border:0;">'+w.get("upload.config.file.link")+"</a>"),s.parentNode.replaceChild(f,s),p=y;break}}if(""!==p){_.debug('found field "'+p+'" on node: ',h);break}if(_.getLevel()<=_.levels.TRACE&&_.debug("no field found on node: ",h),h=h.parentNode,2===g&&(f.innerHTML=u.replace(d,'<a href="'+d+'" target="_blank" style="cursor:pointer;border:0;">'+w.get("upload.config.file.link")+"</a>"),s.parentNode.replaceChild(f,s)),!h)break}}}}}]),e}(),Xe=Ye,Ze=function(){var e=window.Cloudlift.upload.config;_.setDefaultLevel(_.levels.ERROR);var t=_.getLevel();_.setLevel(void 0!==e.log?e.log:t),_.debug("got config",e),window.addEventListener("cloudlift.upload.ready",(function(e){_.debug("resources loaded")}));var n=-1===e.api.indexOf("local")?e.api.replace("api.","assets."):e.api;w.translations=e.i18n||{},e.setup?window.clTranslate?w.translations=p.extend(w.translations,window.clTranslate):(w.api=n+"/api/assets/"+e.app+"/translate/{locale}?shop="+e.shop,w.event+="."+e.app,w.locale&&e.locale&&w.locale!=e.locale&&w.fetch(w.locale)):window.Translate=w,window.Cloudlift.upload.lib={Upload:Ge,UploadField:qe},w.ready.then((function(){window.Cloudlift.upload.App=new Xe(e)}))};"Promise"in window&&"assign"in Object&&String.prototype.startsWith&&Array.prototype.flat?Ze():e(Ne)(window.Cloudlift.upload.config.assets+"/static/lib/core-js/core-js.min.js",Ze)}();